{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React, { useState, useEffect } from 'react';\nimport AccountBox from '../account-box';\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faTachometerAlt } from \"@fortawesome/free-solid-svg-icons\";\nimport moment from 'moment';\nimport { formatNumber, formatMoney } from 'accounting';\n\nvar AccountMileage = function AccountMileage(props) {\n  var calcForm = React.useRef() || null;\n\n  var _useState = useState(),\n      currentContract = _useState[0],\n      setCurrentContract = _useState[1];\n\n  var _useState2 = useState(null),\n      odometer = _useState2[0],\n      setOdometer = _useState2[1];\n\n  var _useState3 = useState(),\n      projected = _useState3[0],\n      setProjected = _useState3[1];\n\n  var _useState4 = useState({\n    odometer: \"\"\n  }),\n      errors = _useState4[0],\n      setErrors = _useState4[1];\n\n  var _useState5 = useState(true),\n      validated = _useState5[0],\n      setValidated = _useState5[1];\n\n  var _useState6 = useState(false),\n      showProjected = _useState6[0],\n      setShowProjected = _useState6[1];\n\n  var _useState7 = useState(false),\n      showSuccess = _useState7[0],\n      setShowSuccess = _useState7[1];\n\n  var currentDate = new Date();\n  var currentDay = currentDate.getDate();\n  var currentMonth = currentDate.getMonth() + 1;\n  var currentYear = currentDate.getFullYear().toString().substr(-2);\n  var startDate = (currentContract === null || currentContract === void 0 ? void 0 : currentContract.actualDate.split('/')) || \"10/11/12\";\n  var startDay = startDate[0];\n  var startMonth = startDate[1];\n  var startYear = startDate[2];\n\n  var handleMileageError = function handleMileageError(event) {\n    var name = event.name,\n        value = event.value;\n\n    switch (name) {\n      case 'odometerReading':\n        errors.odometer = value === \"\" || isNaN(value) ? 'Odometer reading is required.' : '';\n        break;\n\n      default:\n        break;\n    }\n\n    setErrors(errors);\n  };\n\n  var handleMileageCalc = function handleMileageCalc(evt) {\n    evt.preventDefault(); // Loop over React.useRef form field elements\n\n    for (var i = 0, field; field = calcForm.current.elements[i++];) {\n      handleMileageError(field);\n    }\n\n    if (validateMileageCalc(errors)) {\n      setValidated(true);\n      submitvalidateMileageCalc();\n    } else {\n      setValidated(false);\n    }\n  };\n\n  var validateMileageCalc = function validateMileageCalc(errors) {\n    var valid = true;\n    Object.values(errors).forEach(function (key) {\n      if (key !== \"\") {\n        valid = false;\n      }\n    });\n    return valid;\n  };\n\n  var handleOdometerChange = function handleOdometerChange(evt) {\n    setOdometer(parseInt(evt.target.value));\n  };\n\n  var submitvalidateMileageCalc = function submitvalidateMileageCalc() {\n    var odometerReading = odometer;\n    var todaysDate = new Date();\n    var readingDate = moment(todaysDate.getDate() + \"/\" + (todaysDate.getMonth() + 1) + \"/\" + todaysDate.getFullYear(), \"DD/MM/YYYY\");\n    var startDate = moment(currentContract === null || currentContract === void 0 ? void 0 : currentContract.actualDate, \"DD/MM/YYYY\");\n    var renewalDate = moment(currentContract === null || currentContract === void 0 ? void 0 : currentContract.renewalDate, \"DD/MM/YYYY\");\n    var totalAllowance = (currentContract === null || currentContract === void 0 ? void 0 : currentContract.contractMileage) * ((currentContract === null || currentContract === void 0 ? void 0 : currentContract.contractTerm) / 12);\n    var elapsedDays = moment(readingDate).diff(startDate, 'days');\n    var totalDays = moment(renewalDate).diff(startDate, 'days');\n    var milesPerDay = elapsedDays > 0 ? odometerReading / elapsedDays : 0;\n    var projectedMiles = milesPerDay > 0 ? Math.round(milesPerDay * totalDays) : 0;\n    var projectedExcess = milesPerDay > 0 ? projectedMiles - totalAllowance : 0;\n    var projectedCharge = parseFloat(currentContract === null || currentContract === void 0 ? void 0 : currentContract.excessMileageCharge) * projectedExcess / 100;\n    var projectedResults = {\n      projectedMileage: projectedMiles,\n      projectedCharge: projectedCharge,\n      projectedExcess: projectedExcess,\n      totalAllowance: totalAllowance\n    };\n    setProjected(projectedResults);\n\n    if (projectedExcess > 0) {\n      setShowProjected(true);\n      setShowSuccess(false);\n    } else {\n      setShowProjected(false);\n      setShowSuccess(true);\n    }\n  };\n\n  useEffect(function () {\n    setCurrentContract(props.currentContract);\n  }, [props.currentContract]);\n  return /*#__PURE__*/_jsxs(AccountBox, {\n    icon: /*#__PURE__*/_jsx(FontAwesomeIcon, {\n      icon: faTachometerAlt\n    }),\n    title: \" MILEAGE CALCULATOR\",\n    border: true,\n    children: [/*#__PURE__*/_jsx(\"form\", {\n      ref: calcForm,\n      children: /*#__PURE__*/_jsxs(\"div\", {\n        className: \"w-100 p-3 bg-white\",\n        children: [/*#__PURE__*/_jsxs(\"div\", {\n          className: \"row mb-3\",\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: \"col-24 col-md-12 mb-3 mb-md-0 text-center\",\n            children: /*#__PURE__*/_jsx(\"div\", {\n              className: \"bg-acc-grey py-2\",\n              children: /*#__PURE__*/_jsx(\"strong\", {\n                children: \"Lease Start Date\"\n              })\n            })\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"col-8 col-md-4 text-center pr-0 pl-md-0 pr-md-3\",\n            children: /*#__PURE__*/_jsx(\"div\", {\n              className: \"bg-acc-grey py-2\",\n              children: startDay\n            })\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"col-8 col-md-4 text-center pl-md-0\",\n            children: /*#__PURE__*/_jsx(\"div\", {\n              className: \"bg-acc-grey py-2\",\n              children: startMonth\n            })\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"col-8 col-md-4 text-center pl-0 pl-md-0\",\n            children: /*#__PURE__*/_jsx(\"div\", {\n              className: \"bg-acc-grey py-2\",\n              children: startYear === null || startYear === void 0 ? void 0 : startYear.toString().substr(-2)\n            })\n          })]\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: \"row mb-3\",\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: \"col-24 col-md-12 mb-3 mb-md-0 text-center\",\n            children: /*#__PURE__*/_jsx(\"div\", {\n              className: \"bg-acc-grey py-2\",\n              children: /*#__PURE__*/_jsx(\"strong\", {\n                children: \"Length of Lease\"\n              })\n            })\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"col-24 col-md-12 text-center pl-md-0\",\n            children: /*#__PURE__*/_jsxs(\"div\", {\n              className: \"bg-acc-grey py-2\",\n              children: [currentContract === null || currentContract === void 0 ? void 0 : currentContract.contractTerm, \" Months\"]\n            })\n          })]\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: \"row mb-3\",\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: \"col-24 col-md-12 mb-3 mb-md-0 text-center\",\n            children: /*#__PURE__*/_jsx(\"div\", {\n              className: \"bg-acc-grey py-2\",\n              children: /*#__PURE__*/_jsx(\"strong\", {\n                children: \"Annual Mileage\"\n              })\n            })\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"col-24 col-md-12 text-center pl-md-0\",\n            children: /*#__PURE__*/_jsxs(\"div\", {\n              className: \"bg-acc-grey py-2\",\n              children: [formatNumber(currentContract === null || currentContract === void 0 ? void 0 : currentContract.contractMileage), \" miles\"]\n            })\n          })]\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: \"row mb-3\",\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: \"col-24 col-md-12 mb-3 mb-md-0 text-center\",\n            children: /*#__PURE__*/_jsx(\"div\", {\n              className: \"bg-acc-grey py-2\",\n              children: /*#__PURE__*/_jsx(\"strong\", {\n                children: \"Excess Miles Charge\"\n              })\n            })\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"col-24 col-md-12 text-center pl-md-0\",\n            children: /*#__PURE__*/_jsx(\"div\", {\n              className: \"bg-acc-grey py-2\",\n              children: currentContract === null || currentContract === void 0 ? void 0 : currentContract.excessMileageCharge\n            })\n          })]\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: \"row mb-3\",\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: \"col-24 col-md-12 mb-3 mb-md-0 text-center\",\n            children: /*#__PURE__*/_jsx(\"div\", {\n              className: \"bg-acc-grey py-2\",\n              children: /*#__PURE__*/_jsx(\"strong\", {\n                children: \"Odometer Reading\"\n              })\n            })\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: \"col-24 col-md-12 text-center pl-md-0\",\n            children: [/*#__PURE__*/_jsx(\"input\", {\n              type: \"number\",\n              className: \"form-control cal-control \".concat(validated ? \"\" : \"is-invalid\"),\n              name: \"odometerReading\",\n              placeholder: \"10, 000 miles\",\n              onChange: function onChange(evt) {\n                return handleOdometerChange(evt);\n              }\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \"invalid-feedback\",\n              children: errors.odometer\n            })]\n          })]\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: \"row mb-3\",\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: \"col-24 col-md-12 mb-3 mb-md-0 text-center\",\n            children: /*#__PURE__*/_jsx(\"div\", {\n              className: \"bg-acc-grey py-2\",\n              children: /*#__PURE__*/_jsx(\"strong\", {\n                children: \"Reading Date\"\n              })\n            })\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"col-8 col-md-4 text-center pr-0 pl-md-0 pr-md-3\",\n            children: /*#__PURE__*/_jsx(\"div\", {\n              className: \"bg-acc-grey py-2\",\n              children: currentDay\n            })\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"col-8 col-md-4 text-center pl-md-0\",\n            children: /*#__PURE__*/_jsx(\"div\", {\n              className: \"bg-acc-grey py-2\",\n              children: currentMonth\n            })\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"col-8 col-md-4 text-center pl-0 pl-md-0\",\n            children: /*#__PURE__*/_jsx(\"div\", {\n              className: \"bg-acc-grey py-2\",\n              children: currentYear\n            })\n          })]\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: \"row\",\n          children: /*#__PURE__*/_jsx(\"div\", {\n            className: \"col-24 text-center\",\n            children: /*#__PURE__*/_jsx(\"button\", {\n              className: \"btn btn-primary btn-lg\",\n              onClick: handleMileageCalc,\n              children: \"Calculate\"\n            })\n          })\n        })]\n      })\n    }), /*#__PURE__*/_jsx(\"hr\", {\n      className: showProjected && odometer !== null || showSuccess && odometer !== null ? \"\" : \"d-none\"\n    }), /*#__PURE__*/_jsx(\"div\", {\n      className: \"row \".concat(showSuccess && odometer !== null ? \"\" : \"d-none\"),\n      children: /*#__PURE__*/_jsx(\"div\", {\n        className: \"col-24 text-center\",\n        children: /*#__PURE__*/_jsx(\"div\", {\n          className: \"bg-acc-grey\",\n          children: \"You are within your mileage allowance\"\n        })\n      })\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      className: \"w-100 p-3 bg-white \".concat(showProjected && odometer !== null ? \"\" : \"d-none\"),\n      children: [/*#__PURE__*/_jsxs(\"div\", {\n        className: \"row mb-3\",\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: \"col-24 col-md-12 mb-3 mb-md-0 text-center\",\n          children: /*#__PURE__*/_jsx(\"div\", {\n            className: \"bg-acc-grey py-2\",\n            children: /*#__PURE__*/_jsx(\"strong\", {\n              children: \"Projected Mileage\"\n            })\n          })\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: \"col-24 col-md-12 text-center pl-md-0\",\n          children: /*#__PURE__*/_jsxs(\"div\", {\n            className: \"bg-acc-grey py-2\",\n            children: [formatNumber(projected === null || projected === void 0 ? void 0 : projected.projectedMileage), \" miles\"]\n          })\n        })]\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: \"row mb-3\",\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: \"col-24 col-md-12 mb-3 mb-md-0 text-center\",\n          children: /*#__PURE__*/_jsx(\"div\", {\n            className: \"bg-acc-grey py-2\",\n            children: /*#__PURE__*/_jsx(\"strong\", {\n              children: \"Total Allowance\"\n            })\n          })\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: \"col-24 col-md-12 text-center pl-md-0\",\n          children: /*#__PURE__*/_jsxs(\"div\", {\n            className: \"bg-acc-grey py-2\",\n            children: [formatNumber(projected === null || projected === void 0 ? void 0 : projected.totalAllowance), \" miles\"]\n          })\n        })]\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: \"row mb-3\",\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: \"col-24 col-md-12 mb-3 mb-md-0 text-center\",\n          children: /*#__PURE__*/_jsx(\"div\", {\n            className: \"bg-acc-grey py-2\",\n            children: /*#__PURE__*/_jsx(\"strong\", {\n              children: \"Projected Excess\"\n            })\n          })\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: \"col-24 col-md-12 text-center pl-md-0\",\n          children: /*#__PURE__*/_jsxs(\"div\", {\n            className: \"bg-acc-grey py-2\",\n            children: [formatNumber(projected === null || projected === void 0 ? void 0 : projected.projectedExcess), \" miles\"]\n          })\n        })]\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: \"row mb-3\",\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: \"col-24 col-md-12 d-flex mb-3 mb-md-0 text-center\",\n          children: /*#__PURE__*/_jsx(\"div\", {\n            className: \"w-100 d-flex justify-content-center align-items-center bg-acc-grey py-2\",\n            children: /*#__PURE__*/_jsxs(\"strong\", {\n              children: [\"Projected Lease\", /*#__PURE__*/_jsx(\"br\", {}), \"Mileage Charge\"]\n            })\n          })\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: \"col-24 col-md-12 d-flex text-center pl-md-0\",\n          children: /*#__PURE__*/_jsx(\"div\", {\n            className: \"w-100 d-flex justify-content-center align-items-center bg-acc-grey py-2 text-acc\",\n            children: /*#__PURE__*/_jsx(\"strong\", {\n              children: formatMoney(projected === null || projected === void 0 ? void 0 : projected.projectedCharge, \"£\")\n            })\n          })\n        })]\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: \"row mb-3\",\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: \"col-24 col-md-12 mb-3 mb-md-0\",\n          children: /*#__PURE__*/_jsx(\"button\", {\n            className: \"btn btn-success btn-lg btn-fluid btn-block\",\n            children: \"Save Calculation\"\n          })\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: \"col-24 col-md-12\",\n          children: /*#__PURE__*/_jsx(\"button\", {\n            className: \"btn btn-primary btn-lg btn-fluid btn-block\",\n            children: \"Discuss Account\"\n          })\n        })]\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: \"row\",\n        children: /*#__PURE__*/_jsx(\"div\", {\n          className: \"col-24\",\n          children: /*#__PURE__*/_jsx(\"p\", {\n            className: \"text-mid-grey text-center m-0\",\n            children: \"All calculators are made available as self-help tools for your Independent use with results based on information provided by the user. All examples are hypothetical and are for illustrative purposes only. Calculated results are believed to be accurate but results are not guaranteed. Leasing Options can not and do not accept responsibility for accuracy or outcomes.\"\n          })\n        })\n      })]\n    })]\n  });\n};\n\nexport default AccountMileage;","map":null,"metadata":{},"sourceType":"module"}