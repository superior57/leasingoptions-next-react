{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useEffect } from 'react';\nimport { useForm, FormContext } from \"react-hook-form\";\nimport GarageManager from 'components/garage/garage-manager';\nimport GarageEnquiryForm from 'components/garage/garage-enquiry-form/garage-enquiry-form';\nimport GarageSaveForm from 'components/garage/garage-save-form/garage-save-form';\nimport GarageShareForm from 'components/garage/garage-share-form/garage-share-form';\nimport { unformat } from 'helpers/currencyHelper';\n\n//TODO: consider integration with redux, keeping customOptions state on vehicle component level\nvar MyGarage = function MyGarage(_ref) {\n  var isInternal = _ref.isInternal;\n  var methods = useForm();\n  var register = methods.register,\n      handleSubmit = methods.handleSubmit,\n      errors = methods.errors;\n\n  var _useState = useState([]),\n      garage = _useState[0],\n      setGarage = _useState[1];\n\n  var _useState2 = useState(false),\n      formsEnabled = _useState2[0],\n      setFormsEnabled = _useState2[1];\n\n  useEffect(function () {\n    setFormsEnabled(garage.length > 0);\n  }, [garage]);\n\n  var onGarageStateChanged = function onGarageStateChanged(items) {\n    setGarage(items.filter(function (item) {\n      return item.vehicle;\n    }).map(function (item) {\n      return {\n        index: item.idx,\n        customOptions: item.vehicle.customOptions\n      };\n    }));\n  };\n\n  var getData = function getData(manualData, fees) {\n    var result = {\n      vehicles: garage\n    };\n\n    if (isInternal) {\n      if (manualData) {\n        for (var idx = 0; idx < result.vehicles.length; idx++) {\n          var garageItem = result.vehicles[idx];\n\n          if (garageItem) {\n            var manualDetailsItem = manualData[garageItem.index];\n\n            if (manualDetailsItem) {\n              garageItem[\"manualDetails\"] = {\n                monthlyPrice: unformat(manualDetailsItem.monthlyPrice),\n                monthlyMaintenancePrice: unformat(manualDetailsItem.monthlyMaintenancePrice),\n                initialRental: unformat(manualDetailsItem.initialRentalPrice),\n                dealerOption1: manualDetailsItem.dealerOption1,\n                dealerOption1Price: unformat(manualDetailsItem.dealerOption1Price) || null,\n                dealerOption2: manualDetailsItem.dealerOption2,\n                dealerOption2Price: unformat(manualDetailsItem.dealerOption2Price) || null,\n                dealerOption3: manualDetailsItem.dealerOption3,\n                dealerOption3Price: unformat(manualDetailsItem.dealerOption3Price) || null,\n                exteriorColor: unformat(manualDetailsItem.exteriorColor) || null,\n                exteriorColorManual: manualDetailsItem.exteriorColorManual,\n                interiorColor: unformat(manualDetailsItem.interiorColor) || null,\n                interiorColorManual: manualDetailsItem.interiorColorManual\n              };\n            }\n          }\n        }\n      }\n\n      var procFees = [];\n\n      if (fees) {\n        procFees.push({\n          maintenance: false,\n          leasingDealType: 1,\n          procFee: unformat(fees.notMaintained.business) || null\n        });\n        procFees.push({\n          maintenance: false,\n          leasingDealType: 2,\n          procFee: unformat(fees.notMaintained.personal) || null\n        });\n        procFees.push({\n          maintenance: false,\n          leasingDealType: 3,\n          procFee: unformat(fees.notMaintained.van) || null\n        });\n        procFees.push({\n          maintenance: true,\n          leasingDealType: 1,\n          procFee: unformat(fees.maintained.business) || null\n        });\n        procFees.push({\n          maintenance: true,\n          leasingDealType: 2,\n          procFee: unformat(fees.maintained.personal) || null\n        });\n        procFees.push({\n          maintenance: true,\n          leasingDealType: 3,\n          procFee: unformat(fees.maintained.van) || null\n        });\n      }\n\n      result[\"procFees\"] = procFees;\n    }\n\n    return result;\n  };\n\n  return /*#__PURE__*/_jsx(_Fragment, {\n    children: /*#__PURE__*/_jsxs(FormContext, _objectSpread(_objectSpread({}, methods), {}, {\n      children: [/*#__PURE__*/_jsxs(\"section\", {\n        className: \"container-fluid py-3 py-md-5\",\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: \"row\",\n          children: /*#__PURE__*/_jsxs(\"div\", {\n            className: \"col-24 mb-3\",\n            children: [/*#__PURE__*/_jsx(\"h1\", {\n              children: \"My Garage\"\n            }), /*#__PURE__*/_jsx(\"h4\", {\n              className: \"text-blue\",\n              children: \"Compare up to 4 car or van deals with our helpful comparison tool\"\n            })]\n          })\n        }), /*#__PURE__*/_jsx(GarageManager, {\n          settings: {\n            isInternal: isInternal,\n            onStateChanged: onGarageStateChanged\n          }\n        })]\n      }), /*#__PURE__*/_jsx(\"section\", {\n        className: \"container-fluid py-3 py-md-5 bg-light-grey\",\n        children: /*#__PURE__*/_jsxs(\"div\", {\n          className: \"row\",\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: \"col-24 col-lg-12 d-flex mb-3 mb-lg-0\",\n            children: /*#__PURE__*/_jsx(GarageEnquiryForm, {\n              settings: {\n                isInternal: isInternal,\n                isDisabled: !formsEnabled,\n                getData: getData,\n                salesPersons: null\n              }\n            })\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"col-24 col-md-12 col-lg-6 d-flex mb-3 mb-lg-0\",\n            children: /*#__PURE__*/_jsx(GarageSaveForm, {\n              settings: {\n                isDisabled: !formsEnabled,\n                getData: getData\n              }\n            })\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"col-24 col-md-12 col-lg-6 d-flex mb-3 mb-lg-0\",\n            children: /*#__PURE__*/_jsx(GarageShareForm, {\n              settings: {\n                isDisabled: !formsEnabled,\n                getData: getData\n              }\n            })\n          })]\n        })\n      })]\n    }))\n  });\n};\n\nexport default MyGarage;","map":null,"metadata":{},"sourceType":"module"}