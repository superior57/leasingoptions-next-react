{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React, { useState, useContext, useEffect } from 'react';\nimport { useRouter } from 'next/router';\nimport Link from 'next/link';\nimport style from './vehicle-eligible.module.scss';\nimport PopOver from '../../../components/layout/popover';\nimport ModalContext from '../../HOCs/modal/modalContext';\nimport Search from '../../search';\nimport { connect } from 'react-redux';\nimport { VehicleTypes } from 'enums/VehicleTypes';\nimport { PricingTypes } from 'enums/PricingTypes';\nimport { SearchPanels } from 'enums/SearchPanels';\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faInfoCircle, faChevronRight } from \"@fortawesome/pro-regular-svg-icons\";\nimport { GetSearchFiltersUrl } from '../../../helpers/urlHelper';\nimport { GetPhoneNumber, getSearchButton, FormatValidatePostcode, AddSpaceToPostcode } from 'helpers/helpers';\nimport { GetVehiclesFilterOptions } from 'business-logic/vehicleService';\n\nfunction mapStateToProps(state) {\n  return {\n    isInternal: state.isInternal,\n    dealToggle: state.dealSelector,\n    vehicleFilters: state.vehicleFilters,\n    userPostcode: state.userPostcode\n  };\n}\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    updateUserPostcode: userPostcode => {\n      dispatch({\n        type: 'UPDATE_POSTCODE',\n        userPostcode: userPostcode\n      });\n    }\n  };\n};\n\nconst VehicleEligible = ({\n  isInternal,\n  dealToggle,\n  vehicleFilters,\n  userPostcode,\n  updateUserPostcode\n}) => {\n  const router = useRouter();\n  const postcodeRef = React.useRef();\n  const modalContext = useContext(ModalContext);\n  const {\n    0: validationRequired,\n    1: setValidationRequired\n  } = useState(false);\n  const {\n    0: dealCount,\n    1: setDealCount\n  } = useState(1);\n  const {\n    0: postcodeSubmitted,\n    1: setPostcodeSubmitted\n  } = useState(userPostcode ? true : false);\n\n  const handleSearchClick = evt => {\n    modalContext.showModal(Search, {\n      show: true,\n      title: getSearchButton(router, vehicleFilters, dealToggle),\n      activePanel: SearchPanels.SearchDetailed\n    });\n  };\n\n  const handlePostcodeSubmit = evt => {\n    evt.preventDefault();\n    let enteredPostcode = postcodeRef.current.value.toLowerCase();\n    setPostcodeSubmitted(false);\n\n    if (FormatValidatePostcode(enteredPostcode)) {\n      updateUserPostcode(AddSpaceToPostcode(enteredPostcode));\n      setValidationRequired(true);\n      setPostcodeSubmitted(true);\n    } else {\n      setValidationRequired(true);\n    }\n  };\n\n  useEffect(() => {\n    GetVehiclesFilterOptions(dealToggle, VehicleTypes.Car, vehicleFilters.manufacturerUrl, vehicleFilters.modelUrl, vehicleFilters.shortDerTextUrl.id, vehicleFilters.term.id, vehicleFilters.initialRental.id, vehicleFilters.mileage.id, vehicleFilters.fuelType.id, vehicleFilters.transmission.id, vehicleFilters.co2.id, vehicleFilters.mpg.id, vehicleFilters.doors.id, vehicleFilters.seats.id, vehicleFilters.driveTrain.id, vehicleFilters.vehicleSize.id, vehicleFilters.vehicleStyle.id, vehicleFilters.engineSize.id, vehicleFilters.priceFrom.id, vehicleFilters.priceTo.id, vehicleFilters.isInStock, vehicleFilters.isSpecial, PricingTypes.Atc, userPostcode).then(function (data) {\n      setDealCount(data.data.count);\n    });\n  }, [dealToggle, userPostcode, vehicleFilters]);\n  useEffect(() => {\n    setPostcodeSubmitted(userPostcode ? true : false);\n  }, [router, userPostcode]);\n  return /*#__PURE__*/_jsxs(\"div\", {\n    className: `${style['vehicle-eligible']} ${style['vehicle-eligible--landing']}`,\n    children: [!postcodeSubmitted && /*#__PURE__*/_jsxs(\"div\", {\n      className: `${style['vehicle-eligible__block']} ${style['vehicle-eligible__form']}`,\n      children: [/*#__PURE__*/_jsxs(\"h3\", {\n        children: [\"Are You Eligible? \", /*#__PURE__*/_jsx(PopOver, {\n          id: \"what-does-it-mean\",\n          trigger: /*#__PURE__*/_jsxs(\"span\", {\n            children: [/*#__PURE__*/_jsx(FontAwesomeIcon, {\n              width: \"20\",\n              height: \"20\",\n              icon: faInfoCircle\n            }), \" \", /*#__PURE__*/_jsx(\"u\", {\n              children: \"What does this mean?\"\n            })]\n          }),\n          body: \"To get an insured lease there are certain criteria you have to meet i.e. age, address, occupation.\"\n        })]\n      }), /*#__PURE__*/_jsx(\"p\", {\n        children: validationRequired ? /*#__PURE__*/_jsxs(\"span\", {\n          className: \"invalid-feedback d-inline\",\n          children: [\"Sorry, we can't find that postcode please check and try again. If the postcode is correct, please call us on \", /*#__PURE__*/_jsx(\"a\", {\n            \"aria-label\": \"Phone number\",\n            className: \"text-red\",\n            href: `tel:${GetPhoneNumber(isInternal)}`,\n            children: /*#__PURE__*/_jsx(\"span\", {\n              className: \"phonenumber_call_now text-red\",\n              children: GetPhoneNumber(isInternal)\n            })\n          }), \" for a quote.\"]\n        }) : /*#__PURE__*/_jsx(\"strong\", {\n          children: \"Enter your postcode\"\n        })\n      }), /*#__PURE__*/_jsxs(\"form\", {\n        onSubmit: evt => handlePostcodeSubmit(evt),\n        children: [/*#__PURE__*/_jsx(\"input\", {\n          ref: postcodeRef,\n          type: \"text\",\n          className: validationRequired ? style['required'] : '',\n          defaultValue: userPostcode,\n          placeholder: \"AB12 3CD\"\n        }), /*#__PURE__*/_jsx(\"button\", {\n          type: \"submit\",\n          children: /*#__PURE__*/_jsx(FontAwesomeIcon, {\n            width: \"16\",\n            height: \"16\",\n            icon: faChevronRight\n          })\n        })]\n      })]\n    }), postcodeSubmitted && dealCount > 0 && /*#__PURE__*/_jsxs(\"div\", {\n      className: `${style['vehicle-eligible__block']} ${style['vehicle-eligible__success']} flex-wrap`,\n      children: [/*#__PURE__*/_jsx(\"h3\", {\n        children: \"Great News!\"\n      }), /*#__PURE__*/_jsx(\"p\", {\n        children: \"We have the best insured car leasing deals available for you!\"\n      }), /*#__PURE__*/_jsx(\"button\", {\n        className: `btn btn-primary ${style['btn-primary']} btn-lg flex-grow-1 mb-3 mr-md-3`,\n        children: /*#__PURE__*/_jsx(Link, {\n          passHref: true,\n          href: GetSearchFiltersUrl(dealToggle, userPostcode ? userPostcode.replace(/\\s/g, '-').toLowerCase() : '', vehicleFilters),\n          children: /*#__PURE__*/_jsxs(\"a\", {\n            className: \"text-decoration-none\",\n            children: [\"See \", dealCount, \" Insured Leasing Deals\"]\n          })\n        })\n      }), /*#__PURE__*/_jsx(\"button\", {\n        className: `btn btn-outline-secondary ${style['btn-outline-secondary']} btn-lg flex-grow-1 mb-md-3`,\n        onClick: evt => handleSearchClick(evt),\n        children: \"Refine Search\"\n      })]\n    }), postcodeSubmitted && dealCount === 0 && /*#__PURE__*/_jsxs(\"div\", {\n      className: `${style['vehicle-eligible__block']} ${style['vehicle-eligible__matches']} flex-wrap`,\n      children: [/*#__PURE__*/_jsx(\"h3\", {\n        children: \"Possible Matches..\"\n      }), /*#__PURE__*/_jsx(\"p\", {\n        children: \"We just need the check a few details to ensure we offer you the best prices.\"\n      }), /*#__PURE__*/_jsx(\"a\", {\n        className: `btn btn-primary ${style['btn-primary']} btn-lg flex-grow-1 mb-3 mr-md-3`,\n        \"aria-label\": \"Phone number\",\n        href: `tel:${GetPhoneNumber(isInternal)}`,\n        children: \"Call to Confirm Details\"\n      }), /*#__PURE__*/_jsx(Link, {\n        passHref: true,\n        href: \"/request-callback\",\n        children: /*#__PURE__*/_jsx(\"a\", {\n          className: `btn btn-outline-secondary ${style['btn-outline-secondary']} btn-lg flex-grow-1 mb-md-3`,\n          children: \"Not ready? Request a Callback\"\n        })\n      })]\n    })]\n  });\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(VehicleEligible);","map":null,"metadata":{},"sourceType":"module"}