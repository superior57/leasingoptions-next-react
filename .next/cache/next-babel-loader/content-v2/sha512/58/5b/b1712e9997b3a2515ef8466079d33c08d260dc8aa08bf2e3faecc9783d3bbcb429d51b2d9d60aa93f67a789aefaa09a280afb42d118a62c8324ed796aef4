{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _toConsumableArray from \"E:/current_project/PPH/tfs/Website/website/node_modules/next/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport React, { useEffect, useState } from 'react';\nimport MetaHead from \"components/seo/meta\";\nimport ExpandableText from \"components/expandable-text\";\nimport VehicleCarousel from \"components/vehicle-carousel\";\nimport CardVehicle from \"components/card/card-vehicle\";\nimport DealsFilters from \"components/deals-filters/deals-filters\";\nimport CardWithStickers from 'components/card/card-with-stickers';\nimport { VehicleTypes } from \"enums/VehicleTypes\";\nimport { getVehicleHeaderIcon } from \"helpers/helpers\";\n\n//TODO: slow rendering - investigate\nvar SpecialOffersPage = function SpecialOffersPage(_ref) {\n  var leasingDealType = _ref.leasingDealType,\n      vehicleType = _ref.vehicleType,\n      topSpecialOffers = _ref.topSpecialOffers,\n      specialOffersGrouped = _ref.specialOffersGrouped,\n      serviceSchema = _ref.serviceSchema;\n\n  var _useState = useState([]),\n      makes = _useState[0],\n      setMakes = _useState[1];\n\n  var _useState2 = useState([]),\n      categories = _useState2[0],\n      setCategories = _useState2[1];\n\n  var _useState3 = useState([]),\n      selectedCategories = _useState3[0],\n      setSelectedCategories = _useState3[1];\n\n  var _useState4 = useState(null),\n      selectedMake = _useState4[0],\n      setSelectedMake = _useState4[1];\n\n  var _useState5 = useState(\"price;asc\"),\n      sortOrder = _useState5[0],\n      setSortOrder = _useState5[1];\n\n  var _useState6 = useState(null),\n      specialOffersGroupedList = _useState6[0],\n      setSpecialOffersGroupedList = _useState6[1];\n\n  var _useState7 = useState(0),\n      totalItems = _useState7[0],\n      setTotalItems = _useState7[1];\n\n  var _useState8 = useState(0),\n      totalModels = _useState8[0],\n      setTotalModels = _useState8[1];\n\n  useEffect(function () {\n    var itemsToShow = JSON.parse(JSON.stringify(specialOffersGrouped)) || [];\n\n    for (var i = 0; i < itemsToShow.length; i++) {\n      var group = itemsToShow[i];\n      group.vehicles = group.vehicles.filter(function (item) {\n        return leasingDealType === 2 ? item.personalDeal !== null : item.businessDeal !== null;\n      });\n    }\n\n    itemsToShow = itemsToShow.filter(function (item) {\n      return item.vehicles && item.vehicles.length > 0;\n    });\n    var makesList = itemsToShow.flatMap(function (item) {\n      return item.vehicles;\n    }).map(function (item) {\n      return item.make;\n    }).filter(function (value, idx, self) {\n      return self.indexOf(value) === idx;\n    }).sort().map(function (item) {\n      return {\n        id: item,\n        name: item\n      };\n    });\n    var categoriesList = itemsToShow.map(function (item) {\n      return {\n        id: item.categoryId,\n        name: item.categoryName\n      };\n    });\n    setCategories(categoriesList);\n    setMakes(makesList);\n\n    if (selectedMake && !makesList.map(function (item) {\n      return item.id.toLowerCase();\n    }).includes(selectedMake.toLowerCase())) {\n      setSelectedMake(null);\n    }\n\n    if (selectedCategories && selectedCategories.length > 0) {\n      var availableCategoryIds = categoriesList.map(function (item) {\n        return item.id;\n      });\n      var updatedCategories = selectedCategories.filter(function (item) {\n        return availableCategoryIds.includes(item);\n      });\n\n      if (updatedCategories.length != selectedCategories.length) {\n        setSelectedCategories(updatedCategories);\n      }\n    }\n  }, [leasingDealType, specialOffersGrouped]);\n  useEffect(function () {\n    var itemsToShow = JSON.parse(JSON.stringify(specialOffersGrouped)) || [];\n\n    if (selectedCategories && selectedCategories.length > 0) {\n      itemsToShow = itemsToShow.filter(function (item) {\n        return selectedCategories.includes(item.categoryId);\n      });\n    }\n\n    for (var i = 0; i < itemsToShow.length; i++) {\n      var group = itemsToShow[i];\n\n      if (selectedMake) {\n        group.vehicles = group.vehicles.filter(function (item) {\n          return item.make.toLowerCase() === selectedMake.toLowerCase();\n        });\n      }\n\n      group.vehicles = group.vehicles.filter(function (item) {\n        return leasingDealType === 2 ? item.personalDeal !== null : item.businessDeal !== null;\n      });\n    }\n\n    itemsToShow = itemsToShow.filter(function (item) {\n      return item.vehicles && item.vehicles.length > 0;\n    });\n    var resultItems = itemsToShow.flatMap(function (item) {\n      return item.vehicles;\n    }).map(function (item) {\n      return {\n        make: item.make,\n        model: item.model\n      };\n    }); //TODO: Maybe worth sort setSpecialOffersGroupedList separatelly?\n\n    for (var _i = 0; _i < itemsToShow.length; _i++) {\n      var _group = itemsToShow[_i];\n      var sortDirection = sortOrder.split(\";\")[1];\n      _group.vehicles = _group.vehicles.sort(function (a, b) {\n        var aDeal = leasingDealType === 2 ? a.personalDeal : a.businessDeal;\n        var bDeal = leasingDealType === 2 ? b.personalDeal : b.businessDeal;\n\n        if (aDeal.monthlyPrice < bDeal.monthlyPrice) {\n          return -1;\n        } else if (aDeal.monthlyPrice > bDeal.monthlyPrice) {\n          return 1;\n        }\n\n        return 0;\n      });\n\n      if (sortDirection === \"desc\") {\n        _group.vehicles = _group.vehicles.reverse();\n      }\n    }\n\n    setTotalItems(resultItems.length);\n    setTotalModels(resultItems.map(function (item) {\n      return item.model;\n    }).filter(function (value, idx, self) {\n      return self.indexOf(value) === idx;\n    }).length);\n    setSpecialOffersGroupedList(itemsToShow);\n  }, [leasingDealType, selectedMake, selectedCategories, sortOrder]);\n\n  var handleCategoryChange = function handleCategoryChange(value) {\n    if (!value) {\n      setSelectedCategories([]);\n    } else {\n      if (selectedCategories.includes(value)) {\n        var updatedCategories = selectedCategories.filter(function (item) {\n          return item !== value;\n        });\n        setSelectedCategories(updatedCategories);\n      } else {\n        setSelectedCategories(function (prevSate) {\n          return [].concat(_toConsumableArray(prevSate), [value]);\n        });\n      }\n    }\n  };\n\n  var handleMakeChange = function handleMakeChange(value) {\n    setSelectedMake(value);\n  };\n\n  var handleSortOrderChange = function handleSortOrderChange(value) {\n    if (value && sortOrder !== value) {\n      setSortOrder(value);\n    }\n  };\n\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsx(MetaHead, {\n      children: /*#__PURE__*/_jsx(\"script\", {\n        type: \"application/ld+json\",\n        dangerouslySetInnerHTML: {\n          __html: serviceSchema\n        }\n      })\n    }), /*#__PURE__*/_jsxs(CardWithStickers, {\n      children: [(topSpecialOffers === null || topSpecialOffers === void 0 ? void 0 : topSpecialOffers.length) > 0 && /*#__PURE__*/_jsxs(\"div\", {\n        className: \"container-fluid py-5 bg-white\",\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: \"row\",\n          children: /*#__PURE__*/_jsx(\"div\", {\n            className: \"col-24\",\n            children: /*#__PURE__*/_jsxs(\"h1\", {\n              className: \"mb-5\",\n              children: [vehicleType == VehicleTypes.Car ? 'Car' : 'Van', \" Lease Deals & Special Offers\"]\n            })\n          })\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: \"row\",\n          children: /*#__PURE__*/_jsx(\"div\", {\n            className: \"col-24 px-md-0\",\n            children: /*#__PURE__*/_jsx(VehicleCarousel, {\n              tabletArrows: true,\n              desktopArrows: true,\n              infinite: topSpecialOffers.length > 3,\n              children: topSpecialOffers === null || topSpecialOffers === void 0 ? void 0 : topSpecialOffers.map(function (vehicle) {\n                return /*#__PURE__*/_jsx(CardVehicle, {\n                  id: \"featured-\".concat(vehicle.vehicleRef),\n                  header: true,\n                  headerColor: \"#980000\",\n                  headerIcon: getVehicleHeaderIcon(vehicle.optionsType),\n                  vehicle: vehicle,\n                  dealSelector: leasingDealType\n                }, \"featured-\".concat(vehicle.vehicleRef));\n              })\n            })\n          })\n        })]\n      }), /*#__PURE__*/_jsx(DealsFilters, {\n        categories: selectedCategories,\n        make: selectedMake,\n        totalItems: totalItems,\n        totalModels: totalModels,\n        settings: {\n          availableCategories: categories,\n          availableMakes: makes,\n          onCategoryChange: handleCategoryChange,\n          onMakeChange: handleMakeChange,\n          onSortOrderChange: handleSortOrderChange\n        }\n      }), specialOffersGroupedList === null || specialOffersGroupedList === void 0 ? void 0 : specialOffersGroupedList.map(function (category, index) {\n        var _category$vehicles;\n\n        return /*#__PURE__*/_jsxs(\"div\", {\n          className: \"container-fluid py-3 py-md-5 \".concat(index % 2 == 0 ? 'bg-white' : 'bg-light-grey'),\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: \"row\",\n            children: /*#__PURE__*/_jsx(\"div\", {\n              className: \"col-24\",\n              children: /*#__PURE__*/_jsxs(\"h3\", {\n                className: \"mb-3 mb-md-5\",\n                children: [/*#__PURE__*/_jsx(\"mark\", {\n                  className: \"mark-text\",\n                  children: category.vehicles.length\n                }), \" \", category.categoryName, \" Special Offers\"]\n              })\n            })\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"row\",\n            children: /*#__PURE__*/_jsx(\"div\", {\n              className: \"col-24\",\n              children: /*#__PURE__*/_jsx(VehicleCarousel, {\n                tabletArrows: true,\n                desktopArrows: true,\n                infinite: category.vehicles.length > 3,\n                children: (_category$vehicles = category.vehicles) === null || _category$vehicles === void 0 ? void 0 : _category$vehicles.map(function (vehicle) {\n                  return /*#__PURE__*/_jsx(CardVehicle, {\n                    id: \"category-1\",\n                    header: true,\n                    headerColor: \"#009892\",\n                    headerIcon: getVehicleHeaderIcon(vehicle.optionType),\n                    vehicle: vehicle,\n                    dealSelector: leasingDealType\n                  }, \"\".concat(category.categoryId, \"-\").concat(vehicle.vehicleRef));\n                })\n              })\n            })\n          })]\n        }, category.categoryId);\n      })]\n    }), /*#__PURE__*/_jsx(\"div\", {\n      className: \"container-fluid py-3 py-md-5\",\n      children: /*#__PURE__*/_jsx(\"div\", {\n        className: \"row\",\n        children: /*#__PURE__*/_jsxs(\"div\", {\n          className: \"col-24\",\n          children: [vehicleType == VehicleTypes.Car && /*#__PURE__*/_jsx(ExpandableText, {\n            theme: \"light\",\n            children: '<p>Browse our best car leasing deals and save money on your next vehicle today. Simply click the icons below to filter by body type or price and find top value on a huge choice of vehicles. Our handpicked special offers won’t be around forever. Check them out now and find the brand new car you want for the lowest price.</p>' + \"<p>With a wide range of special offers, it\\u2019s simple to find the best car lease deals around with Leasing Options. We have a fantastic selection of new vehicles with impressive savings available, guaranteeing you a great price on both <Link href=\\\"/car-leasing\\\"><a>personal</a></Link> and <a href=\\\"/business-car-leasing\\\">business</a> contracts.</p>\\n                                <p>From SUVs to convertibles to hybrids, we have an extensive selection of cars on offer for a limited time. Choose the body type or brand you\\u2019re looking to find the right car for your lifestyle and budget. What\\u2019s more, we have fantastic discounts on many leading manufacturers, with the likes of <a href=\\\"/car-leasing/mercedes-benz\\\">Mercedes-Benz</a>, <a href=\\\"/car-leasing/audi\\\">Audi</a> and <a href=\\\"/car-leasing/kia\\\">Kia</a> regularly on offer.</p>\\n                                <p>Our special offers are perfect if you\\u2019re looking for the lowest possible monthly bill, or if you have a specific type of car in mind but aren\\u2019t fussy about the model.</p>\\n                                <p>If you need your vehicle as soon as possible, check for the In Stock label, where you\\u2019ll find cars that are ready to be delivered to your door fast. Don\\u2019t forget to view our Mega Deals and Manager Specials for additional price cuts too.</p>\\n                                <p>Leasing already offers a flexible, affordable way to drive your chosen car for a fixed monthly rate. And with our latest discounts, you can take advantage of even lower prices and get brilliant savings on a brand-new vehicle today.</p>\\n                                <p>Find your perfect car leasing deal today with Leasing Options. If you can\\u2019t decide or have any questions, just <a href=\\\"/contact\\\">get in touch</a> with our expert team who\\u2019ll be happy to help. </p>\"\n          }), vehicleType == VehicleTypes.Commercial && /*#__PURE__*/_jsx(ExpandableText, {\n            theme: \"light\",\n            children: '<p>Buying a van can mean expensive up-front costs that can mean putting your plans on hold. With van leasing, you can get on the move as quickly as possible with affordable monthly payments. Enjoy access to the latest van models, with the benefits of better mileage and lower emissions – there are no depreciation costs to worry about, and you can even have maintenance included as part of your contract.</p>'\n          })]\n        })\n      })\n    })]\n  });\n};\n\nexport default SpecialOffersPage;","map":null,"metadata":{},"sourceType":"module"}