{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React, { useEffect, useState } from 'react';\nimport MainLayout from '../../components/layout/main-layout';\nimport PageBanner from '../../components/page-banner';\nimport CardGuides from '../../components/card/card-guides';\nimport AsideGuides from '../../components/layout/aside-guides';\nimport PageUpsell from '../../components/layout/page-upsell';\nimport PageFaqs from '../../components/layout/page-faqs';\nimport wrapper from 'redux/store.tsx/store';\nimport { ContentService } from 'business-logic/contentService';\nimport * as _ from 'underscore';\nimport { GetAdviceCategoryMeta } from 'helpers/seoHelper';\nimport PageBannerSearchGuides from 'components/page-banner/page-banner--searchGuides';\nexport const getServerSideProps = wrapper.getServerSideProps(async context => {\n  const pageLimit = 9;\n  const category = context.query.category;\n  const categoryList = await ContentService.GetContentCategories();\n\n  const categoryId = _.find(categoryList.data || [], function (item) {\n    return item.url === category;\n  });\n\n  const advicePromise = await ContentService.GetGuideItems(categoryId.id, 1, pageLimit);\n  const popularGuides = await ContentService.GetPopularContentItems();\n  const faqList = await ContentService.GetAdviceGuidesFaqs(0);\n  const metaData = GetAdviceCategoryMeta(categoryId.id, context.req.url);\n  return {\n    props: {\n      category: category,\n      categoryId: categoryId.id,\n      categoryList: categoryList.data,\n      advice: advicePromise.data,\n      popularGuides: popularGuides.data,\n      faqList: faqList.data,\n      metaData: metaData,\n      pageLimit: pageLimit\n    }\n  };\n});\nexport default function AdviceCategory({\n  categoryId,\n  categoryList,\n  advice,\n  popularGuides,\n  faqList,\n  pageLimit\n}) {\n  var _$find;\n\n  const categoryName = (_$find = _.find(categoryList || [], function (item) {\n    return item.id === categoryId;\n  })) === null || _$find === void 0 ? void 0 : _$find.name;\n  const {\n    0: pageResults,\n    1: setPageResults\n  } = useState(advice);\n  const {\n    0: pageIndex,\n    1: setPageIndex\n  } = useState(1);\n\n  const handleReadMore = () => setPageIndex(pageIndex + 1);\n\n  useEffect(() => {\n    Promise.resolve(getMoreArticles(pageIndex)).then(function (data) {\n      setPageResults(data.data);\n    });\n  }, [categoryId, pageIndex]);\n\n  async function getMoreArticles(pageIndex) {\n    return await ContentService.GetGuideItems(categoryId, 1, pageLimit * pageIndex);\n  }\n\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsx(PageBanner, {\n      className: \"page-banner--news\",\n      image: `${process.env.NEXT_PUBLIC_CDN}/website/news/page-banner--blog.png`,\n      trustPilot: true,\n      children: /*#__PURE__*/_jsx(\"div\", {\n        className: \"row\",\n        children: /*#__PURE__*/_jsxs(\"div\", {\n          className: \"col-24 py-md-5\",\n          children: [/*#__PURE__*/_jsx(\"h1\", {\n            className: \"text-white\",\n            children: /*#__PURE__*/_jsx(\"strong\", {\n              children: categoryName\n            })\n          }), /*#__PURE__*/_jsx(\"h2\", {\n            className: \"text-white mb-3 mb-md-5\",\n            children: \"Find out everything you need to know about vehicle leasing in our simple, hassle-free guides.\"\n          }), /*#__PURE__*/_jsx(PageBannerSearchGuides, {\n            categoryId: categoryId,\n            categoryList: categoryList\n          })]\n        })\n      })\n    }), /*#__PURE__*/_jsx(\"section\", {\n      className: \"container-fluid py-3 py-md-4 pb-md-5 bg-light-grey\",\n      children: /*#__PURE__*/_jsxs(\"div\", {\n        className: \"row mb-md-4\",\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: \"col-24 col-lg-6 d-flex\",\n          children: /*#__PURE__*/_jsx(AsideGuides, {\n            selectedCategory: categoryId,\n            categoryList: categoryList,\n            popular: true,\n            popularGuides: popularGuides\n          })\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: \"col-24 col-lg-18 py-5 py-md-0\",\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: \"row no-gutters\",\n            children: /*#__PURE__*/_jsx(\"div\", {\n              className: \"col-24 d-lg-none\",\n              children: /*#__PURE__*/_jsx(\"h2\", {\n                children: \"Latest Guides\"\n              })\n            })\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: \"row\",\n            children: [pageResults.dataItems.map((article, index) => {\n              let categoryName = _.find(categoryList || [], function (item) {\n                return item.url === article.categoryUrl;\n              });\n\n              return /*#__PURE__*/_jsx(\"div\", {\n                className: `col-24 ${index > 2 ? 'col-lg-12' : 'col-lg-8'}  d-flex mb-3`,\n                children: /*#__PURE__*/_jsx(CardGuides, {\n                  condensed: index > 2 ? true : false,\n                  id: `article-${article.id}`,\n                  image: article.imageUrl,\n                  tag: categoryName.name,\n                  link: article.url,\n                  title: article.pageTitle,\n                  date: article.publishDate,\n                  excerpt: article.pageSubtitle,\n                  category: article.categoryUrl\n                })\n              }, article.id);\n            }), pageIndex * pageLimit < pageResults.totalItemsCount && /*#__PURE__*/_jsx(\"div\", {\n              className: \"col-24 text-center\",\n              children: /*#__PURE__*/_jsx(\"button\", {\n                className: \"btn btn-primary btn-lg mt-3\",\n                onClick: () => handleReadMore(),\n                children: \"View More\"\n              })\n            })]\n          })]\n        })]\n      })\n    }), /*#__PURE__*/_jsx(PageFaqs, {\n      faqList: faqList\n    }), /*#__PURE__*/_jsx(PageUpsell, {})]\n  });\n}\n;\nAdviceCategory.layout = MainLayout;","map":null,"metadata":{},"sourceType":"module"}