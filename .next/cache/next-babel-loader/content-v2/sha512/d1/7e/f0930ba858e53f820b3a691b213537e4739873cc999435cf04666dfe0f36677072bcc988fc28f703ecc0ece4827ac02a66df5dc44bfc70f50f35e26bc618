{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"E:\\\\current_project\\\\PPH\\\\tfs\\\\Website\\\\website\\\\components\\\\layout\\\\header\\\\header-search.tsx\";\nimport React, { useState, useEffect } from 'react';\nimport Link from 'next/link';\nimport { connect } from 'react-redux';\nimport style from './header.module.scss';\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faSpinner, faSearch } from \"@fortawesome/free-solid-svg-icons\";\nimport { GetVehicleUrl } from \"helpers/urlHelper\";\nimport { LeasingDealTypes } from 'enums/LeasingDealTypes';\nimport { VehicleTypes } from 'enums/VehicleTypes';\nimport { GetSearchResults } from 'business-logic/vehicleService';\n\nconst HeaderSearch = ({\n  dealSelector,\n  isInternal\n}) => {\n  const {\n    0: leaseDealType,\n    1: setLeaseDealType\n  } = useState(dealSelector === LeasingDealTypes.Van ? LeasingDealTypes.Business : dealSelector);\n  const {\n    0: isLoading,\n    1: setIsLoading\n  } = useState(false);\n  const {\n    0: isActive,\n    1: setIsactive\n  } = useState(false);\n  const {\n    0: searchResults,\n    1: setSearchResults\n  } = useState([]);\n\n  const handleSearchInit = evt => {\n    let searchQuery = evt.target.value.toString();\n\n    if (searchQuery.length >= 2) {\n      setIsLoading(true);\n      Promise.resolve(getSearchResults(searchQuery)).then(function (data) {\n        setIsactive(true);\n        setSearchResults(data.data);\n        setIsLoading(false);\n      });\n    } else {\n      setIsactive(false);\n      setSearchResults([]);\n    }\n  };\n\n  const handleSearchBlur = () => {\n    document.body.removeEventListener('click', handleSearchClose);\n  };\n\n  const handleSearchClose = () => {\n    setIsactive(false);\n    setIsLoading(false);\n    setSearchResults([]);\n  };\n\n  async function getSearchResults(searchQuery) {\n    return await GetSearchResults(searchQuery, isInternal);\n  }\n\n  useEffect(() => {\n    setLeaseDealType(dealSelector === LeasingDealTypes.Van ? LeasingDealTypes.Personal : dealSelector);\n    setIsactive(false);\n    setSearchResults([]);\n    setIsLoading(false);\n  }, [dealSelector]);\n  useEffect(() => {\n    document.body.addEventListener('click', handleSearchClose);\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: style['input-wrapper'],\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: style['input-icon'],\n      children: /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n        width: \"16\",\n        height: \"16\",\n        icon: faSearch\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 50\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"search\",\n      placeholder: \"e.g. BMW 3 Series\",\n      onFocus: evt => {\n        handleSearchInit(evt);\n      },\n      onKeyUp: evt => {\n        handleSearchInit(evt);\n      },\n      onBlur: evt => handleSearchBlur\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 13\n    }, this), isLoading ? /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n      width: \"16\",\n      height: \"16\",\n      icon: faSpinner,\n      className: `fa-spin ${style['input-loading']}`\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 26\n    }, this) : \"\", /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `${style['input-list']} ${isActive ? style['is-active'] : \"\"}`,\n      children: /*#__PURE__*/_jsxDEV(\"ul\", {\n        children: searchResults.map(result => {\n          return /*#__PURE__*/_jsxDEV(\"li\", {\n            children: /*#__PURE__*/_jsxDEV(Link, {\n              passHref: true,\n              href: GetVehicleUrl(false, '', result.vehicleTypeId === VehicleTypes.Commercial ? LeasingDealTypes.Van : leaseDealType, result.manufacturer, result.shortModTextUrl, result.modelUrl, result.derivativeUrl, result.vehicleRef, null, null, null, null, isInternal),\n              children: /*#__PURE__*/_jsxDEV(\"a\", {\n                children: [result.manufacturer, \" \", result.model, \" \", result.derivative]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 70,\n                columnNumber: 348\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 70,\n              columnNumber: 73\n            }, this)\n          }, `result-${result.vehicleRef}`, false, {\n            fileName: _jsxFileName,\n            lineNumber: 70,\n            columnNumber: 33\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 63,\n    columnNumber: 9\n  }, this);\n};\n\nconst mapStateToProps = state => ({\n  isInternal: state.isInternal\n});\n\nexport default connect(mapStateToProps)(HeaderSearch);","map":{"version":3,"sources":["E:/current_project/PPH/tfs/Website/website/components/layout/header/header-search.tsx"],"names":["React","useState","useEffect","Link","connect","style","FontAwesomeIcon","faSpinner","faSearch","GetVehicleUrl","LeasingDealTypes","VehicleTypes","GetSearchResults","HeaderSearch","dealSelector","isInternal","leaseDealType","setLeaseDealType","Van","Business","isLoading","setIsLoading","isActive","setIsactive","searchResults","setSearchResults","handleSearchInit","evt","searchQuery","target","value","toString","length","Promise","resolve","getSearchResults","then","data","handleSearchBlur","document","body","removeEventListener","handleSearchClose","Personal","addEventListener","map","result","vehicleTypeId","Commercial","manufacturer","shortModTextUrl","modelUrl","derivativeUrl","vehicleRef","model","derivative","mapStateToProps","state"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport Link from 'next/link';\r\nimport { connect } from 'react-redux';\r\nimport style from './header.module.scss';\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faSpinner, faSearch } from \"@fortawesome/free-solid-svg-icons\";\r\nimport { GetVehicleUrl } from \"helpers/urlHelper\";\r\nimport { LeasingDealTypes } from 'enums/LeasingDealTypes';\r\nimport { VehicleTypes } from 'enums/VehicleTypes';\r\nimport { GetSearchResults } from 'business-logic/vehicleService';\r\n\r\ntype Props = {\r\n    dealSelector: LeasingDealTypes;\r\n    isInternal: boolean;\r\n}\r\n\r\nconst HeaderSearch: React.FC<Props> = ({ dealSelector, isInternal}) => {\r\n    const [leaseDealType, setLeaseDealType] = useState<LeasingDealTypes>(dealSelector === LeasingDealTypes.Van ? LeasingDealTypes.Business : dealSelector);\r\n    const [isLoading, setIsLoading] = useState<boolean>(false);\r\n    const [isActive, setIsactive] = useState<boolean>(false);\r\n    const [searchResults, setSearchResults] = useState([]);\r\n    const handleSearchInit = (evt) => {\r\n        let searchQuery = evt.target.value.toString();\r\n\r\n        if (searchQuery.length >=2) {\r\n            setIsLoading(true);\r\n\r\n            Promise.resolve(getSearchResults(searchQuery)).then(function(data) {\r\n                setIsactive(true);\r\n                setSearchResults(data.data);\r\n                setIsLoading(false);\r\n            })\r\n        } else {\r\n            setIsactive(false);\r\n            setSearchResults([]);\r\n        }\r\n    };\r\n    const handleSearchBlur = () => {\r\n        document.body.removeEventListener('click', handleSearchClose);\r\n    }\r\n    const handleSearchClose = () => {\r\n        setIsactive(false);\r\n        setIsLoading(false);\r\n        setSearchResults([]);\r\n    }\r\n\r\n    async function getSearchResults(searchQuery) {\r\n        return await GetSearchResults(searchQuery, isInternal);\r\n    } \r\n\r\n    useEffect(() => {\r\n        setLeaseDealType(dealSelector === LeasingDealTypes.Van ? LeasingDealTypes.Personal : dealSelector);\r\n        setIsactive(false);\r\n        setSearchResults([]);\r\n        setIsLoading(false);\r\n    }, [dealSelector]);\r\n\r\n    useEffect(() => {\r\n        document.body.addEventListener('click', handleSearchClose);\r\n    }, []);\r\n\r\n    return (\r\n        <div className={style['input-wrapper']}>\r\n            <div className={style['input-icon']}><FontAwesomeIcon width=\"16\" height=\"16\" icon={faSearch} /></div>\r\n            <input type=\"search\" placeholder=\"e.g. BMW 3 Series\" onFocus={(evt) => {handleSearchInit(evt)}} onKeyUp={(evt) => {handleSearchInit(evt)}} onBlur={(evt) => handleSearchBlur} />\r\n            {isLoading ? <FontAwesomeIcon width=\"16\" height=\"16\" icon={faSpinner} className={`fa-spin ${style['input-loading']}`} /> : \"\"}\r\n            <div className={`${style['input-list']} ${isActive ? style['is-active'] : \"\"}`}>\r\n                <ul>\r\n                    {searchResults.map(result => {\r\n                        return (<li key={`result-${result.vehicleRef}`}><Link passHref href={GetVehicleUrl(false, '', result.vehicleTypeId === VehicleTypes.Commercial ? LeasingDealTypes.Van : leaseDealType, result.manufacturer, result.shortModTextUrl, result.modelUrl, result.derivativeUrl, result.vehicleRef, null, null, null, null, isInternal)}><a>{result.manufacturer} {result.model} {result.derivative}</a></Link></li>);\r\n                    })}\r\n                </ul>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nconst mapStateToProps = (state) => ({\r\n    isInternal: state.isInternal\r\n});\r\n\r\nexport default connect(mapStateToProps)(HeaderSearch);"]},"metadata":{},"sourceType":"module"}