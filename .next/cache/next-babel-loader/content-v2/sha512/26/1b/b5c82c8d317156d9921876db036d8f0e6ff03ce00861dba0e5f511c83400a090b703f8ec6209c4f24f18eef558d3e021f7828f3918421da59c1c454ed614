{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React, { useState, useEffect } from 'react';\nimport { connect } from 'react-redux';\nimport Link from 'next/link';\nimport style from './card-model.module.scss';\nimport Sticker from '../../layout/sticker';\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faGasPump, faCog, faTachometerAltFast, faCloud, faExclamationTriangle, faInfoCircle, faEdit, faCheck } from \"@fortawesome/pro-regular-svg-icons\";\nimport { VehicleTypes } from 'enums/VehicleTypes';\nimport { LeasingDealTypes } from 'enums/LeasingDealTypes';\nimport { PricingTypes } from 'enums/PricingTypes';\nimport { formatMoney } from 'helpers/currencyHelper';\nimport { GetMonthlyVATText } from 'helpers/helpers';\nimport { GetDynamicVehicleUrl, GetVehicleUrl } from 'helpers/urlHelper';\nimport { GetDealData } from 'business-logic/vehicleService';\n\nconst CardModel = ({\n  isInternal,\n  pricingType,\n  userPostcode,\n  vehicle,\n  leasingDealType,\n  maintenance,\n  stickerList,\n  settings\n}) => {\n  const isAtc = pricingType && pricingType === PricingTypes.Atc;\n  const initialDeal = leasingDealType === LeasingDealTypes.Personal ? vehicle.personalDeal : vehicle.businessDeal;\n  const vehicleImage = vehicle !== null && vehicle !== void 0 && vehicle.imageUrl ? \"/fit-in/400x400/\" + vehicle.imageUrl : \"/fit-in/400x400/website/static/img-placeholder.jpg\";\n  const {\n    0: editToggle,\n    1: setEditToggle\n  } = useState(false);\n  const {\n    0: editDeal,\n    1: setEditDeal\n  } = useState(leasingDealType);\n  const {\n    0: editTerm,\n    1: setEditTerm\n  } = useState(initialDeal.term * 12);\n  const {\n    0: editMileage,\n    1: setEditMileage\n  } = useState(initialDeal.mileage);\n  const {\n    0: editInitial,\n    1: setEditInitial\n  } = useState(initialDeal.initialRentalMonths);\n  const {\n    0: displayedPrice,\n    1: setDisplayedPrice\n  } = useState(initialDeal.monthlyPrice);\n  useEffect(() => {\n    const deal = leasingDealType === LeasingDealTypes.Personal ? vehicle.personalDeal : vehicle.businessDeal;\n    setEditDeal(leasingDealType);\n    setEditTerm(deal.term * 12);\n    setEditMileage(deal.mileage);\n    setEditInitial(deal.initialRentalMonths);\n    setDisplayedPrice(deal.monthlyPrice);\n  }, [vehicle, leasingDealType]);\n\n  const handleEditClose = () => setEditToggle(false);\n\n  const handleEditOpen = () => setEditToggle(true);\n\n  const changeDealType = async evt => {\n    let selectedValue = parseInt(evt.target.value);\n    setEditDeal(selectedValue);\n    updatePrice(editTerm, editMileage, editInitial, selectedValue);\n  };\n\n  const changeTerm = async evt => {\n    let selectedValue = evt.target.value;\n    setEditTerm(selectedValue);\n    updatePrice(selectedValue, editMileage, editInitial, editDeal);\n  };\n\n  const changeMileage = async evt => {\n    let selectedValue = evt.target.value;\n    setEditMileage(selectedValue);\n    updatePrice(editTerm, selectedValue, editInitial, editDeal);\n  };\n\n  const changeInitialRentalMonths = async evt => {\n    let selectedValue = evt.target.value;\n    setEditInitial(selectedValue);\n    updatePrice(editTerm, editMileage, selectedValue, editDeal);\n  };\n\n  const updatePrice = async (term, milage, initialRentalMonths, dealType) => {\n    var _dealData$data;\n\n    const dealData = await GetDealData(vehicle.vehicleRef, term / 12, milage, initialRentalMonths, dealType, maintenance, pricingType, userPostcode);\n    setDisplayedPrice(dealData === null || dealData === void 0 ? void 0 : (_dealData$data = dealData.data) === null || _dealData$data === void 0 ? void 0 : _dealData$data.monthlyPrice);\n  };\n\n  return /*#__PURE__*/_jsxs(\"div\", {\n    className: `${style['card-model']} row d-flex flex-column flex-sm-row flex-wrap my-3 my-md-0`,\n    children: [/*#__PURE__*/_jsx(\"div\", {\n      className: `col-24 col-sm-6 col-lg-4 pr-md-3 py-md-3 ${style['image']}`,\n      children: /*#__PURE__*/_jsx(Link, {\n        passHref: true,\n        href: GetDynamicVehicleUrl(isAtc, userPostcode, editDeal),\n        as: GetVehicleUrl(isAtc, userPostcode, editDeal, vehicle.make, vehicle.shortModel, vehicle.model, vehicle.derivative, vehicle.vehicleRef, editMileage, editInitial, editTerm / 12),\n        children: /*#__PURE__*/_jsx(\"a\", {\n          className: \"w-100 d-block text-center text-decoration-none\",\n          children: /*#__PURE__*/_jsx(\"img\", {\n            alt: `${vehicle === null || vehicle === void 0 ? void 0 : vehicle.make} ${vehicle === null || vehicle === void 0 ? void 0 : vehicle.model} ${vehicle === null || vehicle === void 0 ? void 0 : vehicle.derivative}`,\n            className: \"img-fluid lazyload mb-3 mb-md-0\",\n            \"data-src\": process.env.NEXT_PUBLIC_CDN + vehicleImage\n          })\n        })\n      })\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      className: `col-24 col-sm-18 col-lg-12 px-md-3 py-3 pt-lg-1 pb-lg-0 ${style['summary']}`,\n      children: [/*#__PURE__*/_jsx(Link, {\n        passHref: true,\n        href: GetDynamicVehicleUrl(isAtc, userPostcode, editDeal),\n        as: GetVehicleUrl(isAtc, userPostcode, editDeal, vehicle.make, vehicle.shortModel, vehicle.model, vehicle.derivative, vehicle.vehicleRef, editMileage, editInitial, editTerm / 12),\n        children: /*#__PURE__*/_jsx(\"a\", {\n          className: \"text-decoration-none\",\n          children: /*#__PURE__*/_jsxs(\"h3\", {\n            children: [vehicle === null || vehicle === void 0 ? void 0 : vehicle.make, \" \", vehicle === null || vehicle === void 0 ? void 0 : vehicle.model]\n          })\n        })\n      }), /*#__PURE__*/_jsx(\"h4\", {\n        children: vehicle === null || vehicle === void 0 ? void 0 : vehicle.derivative\n      }), vehicle.stickers.length > 0 ? /*#__PURE__*/_jsx(\"div\", {\n        className: style['stickers'],\n        children: vehicle.stickers.map(id => {\n          let sticker = stickerList.find(function (item) {\n            return item && item.id === id;\n          });\n          return /*#__PURE__*/_jsx(Sticker, {\n            sticker: sticker\n          }, id);\n        })\n      }) : null, /*#__PURE__*/_jsxs(\"ul\", {\n        className: `list-inline ${style['options']}`,\n        children: [/*#__PURE__*/_jsxs(\"li\", {\n          className: \"list-inline-item\",\n          children: [/*#__PURE__*/_jsx(FontAwesomeIcon, {\n            width: \"25\",\n            height: \"25\",\n            icon: faGasPump\n          }), \" Fuel: \", vehicle === null || vehicle === void 0 ? void 0 : vehicle.fuelType]\n        }), /*#__PURE__*/_jsxs(\"li\", {\n          className: \"list-inline-item\",\n          children: [/*#__PURE__*/_jsx(FontAwesomeIcon, {\n            width: \"25\",\n            height: \"25\",\n            icon: faCog\n          }), \" Gearbox: \", vehicle === null || vehicle === void 0 ? void 0 : vehicle.gearbox]\n        }), /*#__PURE__*/_jsxs(\"li\", {\n          className: \"list-inline-item\",\n          children: [/*#__PURE__*/_jsx(FontAwesomeIcon, {\n            width: \"25\",\n            height: \"25\",\n            icon: faTachometerAltFast\n          }), \" MPG: \", vehicle === null || vehicle === void 0 ? void 0 : vehicle.mpg]\n        }), /*#__PURE__*/_jsxs(\"li\", {\n          className: \"list-inline-item\",\n          children: [/*#__PURE__*/_jsx(FontAwesomeIcon, {\n            width: \"25\",\n            height: \"25\",\n            icon: faCloud\n          }), \" CO2: \", vehicle === null || vehicle === void 0 ? void 0 : vehicle.co2]\n        })]\n      })]\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      className: `col-24 col-sm-12 col-lg-4 px-md-3 mt-3 mt-md-0 py-md-3 ${style['info']}`,\n      children: [/*#__PURE__*/_jsxs(\"p\", {\n        children: [vehicle.vehicleType === VehicleTypes.Commercial ? /*#__PURE__*/_jsxs(_Fragment, {\n          children: [/*#__PURE__*/_jsx(\"mark\", {\n            className: \"mark-text\",\n            children: \"Van\"\n          }), \"\\xA0Lease\"]\n        }) : null, vehicle.vehicleType !== VehicleTypes.Commercial ? /*#__PURE__*/_jsxs(_Fragment, {\n          children: [/*#__PURE__*/_jsx(\"mark\", {\n            className: `mark-text ${editToggle ? \"d-none\" : \"\"}`,\n            onClick: handleEditOpen,\n            children: editDeal === LeasingDealTypes.Business ? 'Business' : 'Personal'\n          }), /*#__PURE__*/_jsxs(\"select\", {\n            className: editToggle ? \"\" : \"d-none\",\n            value: editDeal,\n            onChange: evt => changeDealType(evt),\n            children: [/*#__PURE__*/_jsx(\"option\", {\n              value: LeasingDealTypes.Business,\n              children: \"Business\"\n            }), /*#__PURE__*/_jsx(\"option\", {\n              value: LeasingDealTypes.Personal,\n              children: \"Personal\"\n            })]\n          }), \"\\xA0Lease\"]\n        }) : null]\n      }), /*#__PURE__*/_jsxs(\"p\", {\n        children: [/*#__PURE__*/_jsx(\"mark\", {\n          className: `mark-text ${editToggle ? \"d-none\" : \"\"}`,\n          onClick: handleEditOpen,\n          children: editTerm\n        }), /*#__PURE__*/_jsxs(\"select\", {\n          className: editToggle ? \"\" : \"d-none\",\n          value: editTerm,\n          onChange: evt => changeTerm(evt),\n          children: [/*#__PURE__*/_jsx(\"option\", {\n            value: \"24\",\n            children: \"24\"\n          }), /*#__PURE__*/_jsx(\"option\", {\n            value: \"36\",\n            children: \"36\"\n          }), /*#__PURE__*/_jsx(\"option\", {\n            value: \"48\",\n            children: \"48\"\n          })]\n        }), \"\\xA0Months Lease\"]\n      }), /*#__PURE__*/_jsxs(\"p\", {\n        children: [/*#__PURE__*/_jsx(\"mark\", {\n          className: `mark-text ${editToggle ? \"d-none\" : \"\"}`,\n          onClick: handleEditOpen,\n          children: editMileage\n        }), /*#__PURE__*/_jsxs(\"select\", {\n          className: editToggle ? \"\" : \"d-none\",\n          value: editMileage,\n          onChange: evt => changeMileage(evt),\n          children: [/*#__PURE__*/_jsx(\"option\", {\n            value: \"5000\",\n            children: \"5,000\"\n          }), /*#__PURE__*/_jsx(\"option\", {\n            value: \"8000\",\n            children: \"8,000\"\n          }), /*#__PURE__*/_jsx(\"option\", {\n            value: \"10000\",\n            children: \"10,000\"\n          }), /*#__PURE__*/_jsx(\"option\", {\n            value: \"12000\",\n            children: \"12,000\"\n          }), /*#__PURE__*/_jsx(\"option\", {\n            value: \"15000\",\n            children: \"15,000\"\n          }), /*#__PURE__*/_jsx(\"option\", {\n            value: \"20000\",\n            children: \"20,000\"\n          }), /*#__PURE__*/_jsx(\"option\", {\n            value: \"30000\",\n            children: \"30,000\"\n          })]\n        }), \"\\xA0Miles Per Annum\"]\n      }), /*#__PURE__*/_jsxs(\"p\", {\n        children: [/*#__PURE__*/_jsx(\"mark\", {\n          className: `mark-text ${editToggle ? \"d-none\" : \"\"}`,\n          onClick: handleEditOpen,\n          children: formatMoney(editInitial * displayedPrice)\n        }), /*#__PURE__*/_jsxs(\"select\", {\n          className: editToggle ? \"\" : \"d-none\",\n          value: editInitial,\n          onChange: evt => changeInitialRentalMonths(evt),\n          children: [/*#__PURE__*/_jsx(\"option\", {\n            value: \"1\",\n            children: \"1 Month\"\n          }), /*#__PURE__*/_jsx(\"option\", {\n            value: \"3\",\n            children: \"3 Months\"\n          }), /*#__PURE__*/_jsx(\"option\", {\n            value: \"6\",\n            children: \"6 Months\"\n          }), /*#__PURE__*/_jsx(\"option\", {\n            value: \"9\",\n            children: \"9 Months\"\n          }), /*#__PURE__*/_jsx(\"option\", {\n            value: \"12\",\n            children: \"12 Months\"\n          })]\n        }), \"\\xA0Initial Rental\"]\n      }), /*#__PURE__*/_jsx(FontAwesomeIcon, {\n        width: \"25\",\n        height: \"25\",\n        icon: faEdit,\n        onClick: handleEditOpen,\n        className: editToggle ? \"d-none\" : \"\"\n      }), /*#__PURE__*/_jsx(FontAwesomeIcon, {\n        width: \"25\",\n        height: \"25\",\n        icon: faCheck,\n        onClick: handleEditClose,\n        className: editToggle ? \"\" : \"d-none\"\n      })]\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      className: `col-24 col-sm-12 col-lg-4 pl-md-3 py-md-3 ${style['price']}`,\n      children: [isInternal ? /*#__PURE__*/_jsxs(\"div\", {\n        className: style['internal'],\n        children: [/*#__PURE__*/_jsx(FontAwesomeIcon, {\n          width: \"20\",\n          height: \"20\",\n          icon: faExclamationTriangle,\n          title: \"Pricing Matrix\",\n          onClick: () => settings.onPricingMatrix(vehicle)\n        }), /*#__PURE__*/_jsx(FontAwesomeIcon, {\n          width: \"20\",\n          height: \"20\",\n          icon: faInfoCircle,\n          title: \"Report Mistake\",\n          onClick: () => settings.onErrorFeedback(vehicle)\n        })]\n      }) : null, /*#__PURE__*/_jsxs(\"p\", {\n        children: [/*#__PURE__*/_jsx(\"span\", {\n          children: formatMoney(displayedPrice)\n        }), \" \", /*#__PURE__*/_jsx(\"small\", {\n          children: GetMonthlyVATText(editDeal)\n        })]\n      }), /*#__PURE__*/_jsx(Link, {\n        passHref: true,\n        href: GetDynamicVehicleUrl(isAtc, userPostcode, editDeal),\n        as: GetVehicleUrl(isAtc, userPostcode, editDeal, vehicle.make, vehicle.shortModel, vehicle.model, vehicle.derivative, vehicle.vehicleRef, editMileage, editInitial, editTerm / 12),\n        children: /*#__PURE__*/_jsx(\"a\", {\n          className: \"text-decoration-none\",\n          children: /*#__PURE__*/_jsx(\"button\", {\n            className: \"btn btn-primary btn-block btn-lg mt-3 mb-3 mb-lg-0\",\n            children: \"Personalise Deal\"\n          })\n        })\n      })]\n    })]\n  });\n};\n\nfunction mapStateToProps(state) {\n  return {\n    stickerList: state.stickerList\n  };\n}\n\nexport default connect(mapStateToProps)(CardModel);","map":null,"metadata":{},"sourceType":"module"}