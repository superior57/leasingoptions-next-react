{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport React, { useState, useEffect } from 'react';\nimport Link from 'next/link';\nimport CardManufacturer from 'components/card/card-manufacturer';\nimport CardVehicle from 'components/card/card-vehicle';\nimport CardKey from 'components/card/card-key';\nimport VehicleCarousel from 'components/vehicle-carousel';\nimport DropDown from 'components/layout/drop-down';\nimport Pagination from 'components/layout/pagination';\nimport Pagesize from 'components/layout/pagesize';\nimport Faqs from 'components/layout/faqs';\nimport { PricingTypes } from 'enums/PricingTypes';\nimport { ContentService } from 'business-logic/contentService';\nimport CardWithStickers from 'components/card/card-with-stickers';\nimport { GetVehicleModelPreviews } from 'business-logic/vehicleService';\n\n//TODO: check logic\nvar SearchPage = function SearchPage(_ref) {\n  var _modelPreviewsData$da;\n\n  var leasingDealType = _ref.leasingDealType,\n      vehicleFilter = _ref.vehicleFilter,\n      modelPreviews = _ref.modelPreviews,\n      topPicks = _ref.topPicks,\n      pricingType = _ref.pricingType,\n      userPostcode = _ref.userPostcode;\n  var isATC = pricingType === PricingTypes.Atc;\n\n  var _useState = useState(0),\n      totalResults = _useState[0],\n      setTotalResults = _useState[1];\n\n  var _useState2 = useState(1),\n      pageCount = _useState2[0],\n      setPagecount = _useState2[1];\n\n  var _useState3 = useState(1),\n      currentPage = _useState3[0],\n      setCurrentPage = _useState3[1];\n\n  var _useState4 = useState(isATC ? 11 : 9999),\n      resultsPerPage = _useState4[0],\n      setResultsPerPage = _useState4[1];\n\n  var _useState5 = useState('OrderPrice'),\n      sortBy = _useState5[0],\n      setSortBy = _useState5[1];\n\n  var _useState6 = useState('ASC'),\n      sortDirection = _useState6[0],\n      setSortDirection = _useState6[1];\n\n  var _useState7 = useState(modelPreviews),\n      modelPreviewsData = _useState7[0],\n      setModelPreviewsData = _useState7[1];\n\n  var _useState8 = useState(),\n      pageFaqs = _useState8[0],\n      setPageFaqs = _useState8[1];\n\n  useEffect(function () {\n    Promise.resolve(getPageFaqs()).then(function (data) {\n      setPageFaqs(data.data);\n    });\n  }, []);\n  useEffect(function () {\n    Promise.resolve(filterModelPreviews(sortBy, sortDirection, currentPage, resultsPerPage)).then(function (data) {\n      setModelPreviewsData(data.data);\n      setTotalResults(data.data.totalItemsCount);\n      setPagecount(data.data.totalPagesCount + 1);\n    });\n  }, [userPostcode, leasingDealType, vehicleFilter, sortBy, sortDirection, currentPage, resultsPerPage]);\n\n  var handlePageSize = function handlePageSize(pagesize) {\n    return setResultsPerPage(pagesize);\n  };\n\n  var handlePageClick = function handlePageClick(evt, page) {\n    evt.preventDefault();\n    setCurrentPage(page);\n  };\n\n  var handleSortChange = function handleSortChange(sortBy, sortDirection) {\n    setSortBy(sortBy);\n    setSortDirection(sortDirection);\n    Promise.resolve(filterModelPreviews(sortBy, sortDirection, currentPage, resultsPerPage)).then(function (data) {\n      setModelPreviewsData(data.data);\n      setTotalResults(data.data.totalItemsCount);\n      setPagecount(data.data.totalPagesCount + 1);\n    });\n  };\n\n  var filterModelPreviews = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(sortBy, sortDirection, currentPage, resultsPerPage) {\n      var sortingCriteria, paginationCriteria;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              sortingCriteria = {\n                sortBy: sortBy,\n                sortDirection: sortDirection\n              };\n              paginationCriteria = {\n                pageSize: resultsPerPage,\n                pageIndex: currentPage\n              };\n              _context.next = 4;\n              return GetVehicleModelPreviews(vehicleFilter, paginationCriteria, sortingCriteria);\n\n            case 4:\n              return _context.abrupt(\"return\", _context.sent);\n\n            case 5:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function filterModelPreviews(_x, _x2, _x3, _x4) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var getPageFaqs = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return ContentService.GetFaqList(12);\n\n            case 2:\n              return _context2.abrupt(\"return\", _context2.sent);\n\n            case 3:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function getPageFaqs() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsxs(\"section\", {\n      className: isATC ? \"bt-atc--models\" : \"\",\n      children: [/*#__PURE__*/_jsx(\"div\", {\n        className: \"container-fluid pt-5 pb-3 \".concat(isATC ? \"pb-md-0\" : \"\"),\n        children: /*#__PURE__*/_jsxs(\"div\", {\n          className: \"row\",\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: \"col-24 \".concat(isATC ? \"col-12 col-md-18 col-lg-20\" : \"\", \" d-flex align-items-center mb-md-4\"),\n            children: /*#__PURE__*/_jsx(\"h1\", {\n              className: \"\".concat(isATC ? \"text-white\" : \"\", \" m-0\"),\n              children: isATC ? \"Insured Car Leasing Results\" : \"Search Results\"\n            })\n          }), isATC && /*#__PURE__*/_jsx(\"div\", {\n            className: \"col-12 col-md-6 col-lg-4 d-none d-md-flex justify-content-end align-items-center mb-4\",\n            children: /*#__PURE__*/_jsx(\"img\", {\n              \"data-src\": \"\".concat(process.env.NEXT_PUBLIC_CDN, \"/website/insured-leasing/fuel-logo-wht.svg\"),\n              className: \"img-fluid lazyload\",\n              alt: \"Fuel & Go logo\"\n            })\n          })]\n        })\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: \"container-fluid pb-3 \".concat(isATC ? \"pb-md-5\" : \"py-md-5 bg-light-grey\"),\n        children: [/*#__PURE__*/_jsxs(\"div\", {\n          className: \"row\",\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: \"col-24 col-md-18\",\n            children: isATC ? /*#__PURE__*/_jsxs(\"h3\", {\n              className: \"text-white mb-3 mb-md-5\",\n              children: [/*#__PURE__*/_jsx(\"mark\", {\n                className: \"text-white bg-transparent px-0\",\n                children: modelPreviewsData === null || modelPreviewsData === void 0 ? void 0 : modelPreviewsData.totalVehiclesCount\n              }), \" Fuel & Go deals found\"]\n            }) : /*#__PURE__*/_jsxs(\"h3\", {\n              className: \"mb-3 mb-md-5\",\n              children: [/*#__PURE__*/_jsx(\"mark\", {\n                className: \"mark-text\",\n                children: modelPreviewsData === null || modelPreviewsData === void 0 ? void 0 : modelPreviewsData.totalVehiclesCount\n              }), \" Matching Deals from \", /*#__PURE__*/_jsx(\"mark\", {\n                className: \"mark-text\",\n                children: modelPreviewsData === null || modelPreviewsData === void 0 ? void 0 : modelPreviewsData.totalItemsCount\n              }), \" Matching Models\"]\n            })\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"col-24 col-md-6 mb-5 mb-md-0\",\n            children: /*#__PURE__*/_jsxs(DropDown, {\n              indicator: true,\n              active: \"Price Low-High\",\n              wrapperClass: \"w-100 dd-list\",\n              buttonClass: \"btn-block \".concat(isATC ? \"text-white border-white\" : \"bg-white\", \" text-left\"),\n              buttonText: \"Sort by\",\n              children: [/*#__PURE__*/_jsx(\"button\", {\n                type: \"button\",\n                className: \"text-left\",\n                onClick: function onClick() {\n                  return handleSortChange('OrderPrice', 'DESC');\n                },\n                children: \"Price High-Low\"\n              }), /*#__PURE__*/_jsx(\"button\", {\n                type: \"button\",\n                className: \"text-left\",\n                onClick: function onClick() {\n                  return handleSortChange('OrderPrice', 'ASC');\n                },\n                children: \"Price Low-High\"\n              }), /*#__PURE__*/_jsx(\"button\", {\n                type: \"button\",\n                className: \"text-left\",\n                onClick: function onClick() {\n                  return handleSortChange('Seats', 'DESC');\n                },\n                children: \"Seats High-Low\"\n              }), /*#__PURE__*/_jsx(\"button\", {\n                type: \"button\",\n                className: \"text-left\",\n                onClick: function onClick() {\n                  return handleSortChange('Seats', 'ASC');\n                },\n                children: \"Seats Low-High\"\n              }), /*#__PURE__*/_jsx(\"button\", {\n                type: \"button\",\n                className: \"text-left\",\n                onClick: function onClick() {\n                  return handleSortChange('EngineSize', 'DESC');\n                },\n                children: \"Engine Size High-Low\"\n              }), /*#__PURE__*/_jsx(\"button\", {\n                type: \"button\",\n                className: \"text-left\",\n                onClick: function onClick() {\n                  return handleSortChange('EngineSize', 'ASC');\n                },\n                children: \"Engine Size Low-High\"\n              }), /*#__PURE__*/_jsx(\"button\", {\n                type: \"button\",\n                className: \"text-left\",\n                onClick: function onClick() {\n                  return handleSortChange('Mpg', 'DESC');\n                },\n                children: \"MPG High-Low\"\n              }), /*#__PURE__*/_jsx(\"button\", {\n                type: \"button\",\n                className: \"text-left\",\n                onClick: function onClick() {\n                  return handleSortChange('Mpg', 'ASC');\n                },\n                children: \"MPG Low-High\"\n              }), /*#__PURE__*/_jsx(\"button\", {\n                type: \"button\",\n                className: \"text-left\",\n                onClick: function onClick() {\n                  return handleSortChange('CO2', 'DESC');\n                },\n                children: \"CO2 High-Low\"\n              }), /*#__PURE__*/_jsx(\"button\", {\n                type: \"button\",\n                className: \"text-left\",\n                onClick: function onClick() {\n                  return handleSortChange('CO2', 'ASC');\n                },\n                children: \"CO2 Low-High\"\n              })]\n            })\n          })]\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: \"row\",\n          children: modelPreviewsData === null || modelPreviewsData === void 0 ? void 0 : (_modelPreviewsData$da = modelPreviewsData.dataItems) === null || _modelPreviewsData$da === void 0 ? void 0 : _modelPreviewsData$da.map(function (model, index) {\n            if (isATC && index === 3) {\n              return /*#__PURE__*/_jsxs(_Fragment, {\n                children: [/*#__PURE__*/_jsx(\"div\", {\n                  className: \"col-24 col-md-12 col-lg-6 d-flex order-first-sml\",\n                  children: /*#__PURE__*/_jsx(CardKey, {})\n                }, \"atc-key\"), /*#__PURE__*/_jsx(\"div\", {\n                  className: \"col-24 col-md-12 col-lg-6 d-flex\",\n                  children: /*#__PURE__*/_jsx(CardManufacturer, {\n                    isATC: isATC,\n                    userPostcode: userPostcode,\n                    vehicle: model,\n                    dealSelector: leasingDealType\n                  })\n                }, index + '-' + model.vehicleRef)]\n              });\n            } else {\n              return /*#__PURE__*/_jsx(\"div\", {\n                className: \"col-24 col-md-12 col-lg-6 d-flex\",\n                children: /*#__PURE__*/_jsx(CardManufacturer, {\n                  isATC: isATC,\n                  userPostcode: userPostcode,\n                  vehicle: model,\n                  dealSelector: leasingDealType\n                })\n              }, index + '-' + model.vehicleRef);\n            }\n          })\n        }), isATC && /*#__PURE__*/_jsxs(_Fragment, {\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: \"row\",\n            children: /*#__PURE__*/_jsx(\"div\", {\n              className: \"col-24 text-center py-3 py-md-4\",\n              children: /*#__PURE__*/_jsx(Link, {\n                passHref: true,\n                href: \"/car-leasing-with-insurance\",\n                children: /*#__PURE__*/_jsx(\"a\", {\n                  className: \"btn btn-outline-light btn-lg\",\n                  children: \"Fuel & Go Home\"\n                })\n              })\n            })\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: \"row\",\n            children: [/*#__PURE__*/_jsx(Pagesize, {\n              className: \"col-md-12 d-flex justify-content-start align-items-center my-3\",\n              increments: isATC ? [11, 23, 35] : [12, 24, 36],\n              activePage: resultsPerPage,\n              handlePageClick: function handlePageClick(pagesize) {\n                return handlePageSize(pagesize);\n              }\n            }), /*#__PURE__*/_jsx(Pagination, {\n              className: \"col-md-12 d-flex justify-content-end align-items-center my-3\",\n              totalResults: totalResults,\n              pageCount: pageCount,\n              currentPage: currentPage,\n              handlePageClick: handlePageClick\n            })]\n          })]\n        })]\n      })]\n    }), isATC && pageFaqs && /*#__PURE__*/_jsx(Faqs, {\n      title: \"Fuel & Go Leasing FAQs\",\n      className: \"bg-light-grey\",\n      faqs: pageFaqs,\n      children: /*#__PURE__*/_jsx(\"div\", {\n        className: \"row\",\n        children: /*#__PURE__*/_jsx(\"div\", {\n          className: \"col-24\",\n          children: /*#__PURE__*/_jsx(Link, {\n            passHref: true,\n            href: \"/car-leasing-faqs\",\n            children: /*#__PURE__*/_jsx(\"a\", {\n              className: \"btn btn-outline-primary btn-lg\",\n              children: \"See all Fuel & Go FAQs\"\n            })\n          })\n        })\n      })\n    }), topPicks && /*#__PURE__*/_jsxs(\"section\", {\n      className: \"container-fluid py-3 py-md-5 bg-white\",\n      children: [/*#__PURE__*/_jsx(\"div\", {\n        className: \"row\",\n        children: /*#__PURE__*/_jsx(\"div\", {\n          className: \"col-24\",\n          children: /*#__PURE__*/_jsx(\"h2\", {\n            className: \"mb-3 mb-md-5\",\n            children: \"Customers Also Viewed...\"\n          })\n        })\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: \"row\",\n        children: /*#__PURE__*/_jsx(\"div\", {\n          className: \"col-24\",\n          children: /*#__PURE__*/_jsx(CardWithStickers, {\n            children: /*#__PURE__*/_jsx(VehicleCarousel, {\n              tabletArrows: true,\n              desktopArrows: true,\n              infinite: (topPicks === null || topPicks === void 0 ? void 0 : topPicks.length) > 3,\n              children: topPicks.map(function (vehicle) {\n                return /*#__PURE__*/_jsx(CardVehicle, {\n                  id: \"picked-\".concat(vehicle.vehicleRef),\n                  isATC: isATC,\n                  userPostcode: userPostcode,\n                  vehicle: vehicle,\n                  dealSelector: leasingDealType,\n                  showStickers: false\n                }, \"featured-\".concat(vehicle.vehicleRef));\n              })\n            })\n          })\n        })\n      })]\n    })]\n  });\n};\n\nexport default SearchPage;","map":null,"metadata":{},"sourceType":"module"}