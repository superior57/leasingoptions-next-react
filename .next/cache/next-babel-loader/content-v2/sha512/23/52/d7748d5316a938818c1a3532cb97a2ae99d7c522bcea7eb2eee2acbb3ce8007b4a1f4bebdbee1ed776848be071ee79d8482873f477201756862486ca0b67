{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport React, { useState, useEffect } from 'react';\nimport Link from 'next/link';\nimport { connect } from 'react-redux';\nimport style from './header.module.scss';\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faSpinner, faSearch } from \"@fortawesome/free-solid-svg-icons\";\nimport { GetVehicleUrl } from \"helpers/urlHelper\";\nimport { LeasingDealTypes } from 'enums/LeasingDealTypes';\nimport { VehicleTypes } from 'enums/VehicleTypes';\nimport { GetSearchResults } from 'business-logic/vehicleService';\n\nvar HeaderSearch = function HeaderSearch(_ref) {\n  var dealSelector = _ref.dealSelector,\n      isInternal = _ref.isInternal;\n\n  var _useState = useState(dealSelector === LeasingDealTypes.Van ? LeasingDealTypes.Business : dealSelector),\n      leaseDealType = _useState[0],\n      setLeaseDealType = _useState[1];\n\n  var _useState2 = useState(false),\n      isLoading = _useState2[0],\n      setIsLoading = _useState2[1];\n\n  var _useState3 = useState(false),\n      isActive = _useState3[0],\n      setIsactive = _useState3[1];\n\n  var _useState4 = useState([]),\n      searchResults = _useState4[0],\n      setSearchResults = _useState4[1];\n\n  var handleSearchInit = function handleSearchInit(evt) {\n    var searchQuery = evt.target.value.toString();\n\n    if (searchQuery.length >= 2) {\n      setIsLoading(true);\n      Promise.resolve(getSearchResults(searchQuery)).then(function (data) {\n        setIsactive(true);\n        setSearchResults(data.data);\n        setIsLoading(false);\n      });\n    } else {\n      setIsactive(false);\n      setSearchResults([]);\n    }\n  };\n\n  var handleSearchBlur = function handleSearchBlur() {\n    document.body.removeEventListener('click', handleSearchClose);\n  };\n\n  var handleSearchClose = function handleSearchClose() {\n    setIsactive(false);\n    setIsLoading(false);\n    setSearchResults([]);\n  };\n\n  function getSearchResults(_x) {\n    return _getSearchResults.apply(this, arguments);\n  }\n\n  function _getSearchResults() {\n    _getSearchResults = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(searchQuery) {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return GetSearchResults(searchQuery, isInternal);\n\n            case 2:\n              return _context.abrupt(\"return\", _context.sent);\n\n            case 3:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    return _getSearchResults.apply(this, arguments);\n  }\n\n  useEffect(function () {\n    setLeaseDealType(dealSelector === LeasingDealTypes.Van ? LeasingDealTypes.Personal : dealSelector);\n    setIsactive(false);\n    setSearchResults([]);\n    setIsLoading(false);\n  }, [dealSelector]);\n  useEffect(function () {\n    document.body.addEventListener('click', handleSearchClose);\n  }, []);\n  return /*#__PURE__*/_jsxs(\"div\", {\n    className: style['input-wrapper'],\n    children: [/*#__PURE__*/_jsx(\"div\", {\n      className: style['input-icon'],\n      children: /*#__PURE__*/_jsx(FontAwesomeIcon, {\n        width: \"16\",\n        height: \"16\",\n        icon: faSearch\n      })\n    }), /*#__PURE__*/_jsx(\"input\", {\n      type: \"search\",\n      placeholder: \"e.g. BMW 3 Series\",\n      onFocus: function onFocus(evt) {\n        handleSearchInit(evt);\n      },\n      onKeyUp: function onKeyUp(evt) {\n        handleSearchInit(evt);\n      },\n      onBlur: function onBlur(evt) {\n        return handleSearchBlur;\n      }\n    }), isLoading ? /*#__PURE__*/_jsx(FontAwesomeIcon, {\n      width: \"16\",\n      height: \"16\",\n      icon: faSpinner,\n      className: \"fa-spin \".concat(style['input-loading'])\n    }) : \"\", /*#__PURE__*/_jsx(\"div\", {\n      className: \"\".concat(style['input-list'], \" \").concat(isActive ? style['is-active'] : \"\"),\n      children: /*#__PURE__*/_jsx(\"ul\", {\n        children: searchResults.map(function (result) {\n          return /*#__PURE__*/_jsx(\"li\", {\n            children: /*#__PURE__*/_jsx(Link, {\n              passHref: true,\n              href: GetVehicleUrl(false, '', result.vehicleTypeId === VehicleTypes.Commercial ? LeasingDealTypes.Van : leaseDealType, result.manufacturer, result.shortModTextUrl, result.modelUrl, result.derivativeUrl, result.vehicleRef, null, null, null, null, isInternal),\n              children: /*#__PURE__*/_jsxs(\"a\", {\n                children: [result.manufacturer, \" \", result.model, \" \", result.derivative]\n              })\n            })\n          }, \"result-\".concat(result.vehicleRef));\n        })\n      })\n    })]\n  });\n};\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    isInternal: state.isInternal\n  };\n};\n\nexport default connect(mapStateToProps)(HeaderSearch);","map":null,"metadata":{},"sourceType":"module"}