{"ast":null,"code":"import { VehicleTypes } from 'enums/VehicleTypes';\nimport { LeasingDealTypes } from 'enums/LeasingDealTypes';\nimport { getLOSSRFetchHeaders } from 'helpers/apiHelper';\nimport { getBaseUrl } from 'helpers/urlsHelper';\nimport { GetCanonicalUrl } from 'helpers/urlHelper';\nimport { getVehiclesFilter } from 'helpers/vehiclesFilterHelper';\nimport { dispatchUpdateDealToggle, dispatchUpdateVehicleFilterSearch } from 'redux/dispatches/dispatchs';\nimport { GetVehicleModelPreviews, GetTopLoPickVehicles } from 'business-logic/vehicleService';\nexport const getProps = async context => {\n  const vehiclesFilter = getVehiclesFilter(context);\n  const vehicleType = vehiclesFilter.vehicleType;\n  const leasingDealType = vehiclesFilter.leasingDealType;\n\n  if (vehicleType === VehicleTypes.None || leasingDealType === LeasingDealTypes.None) {\n    //Do we have custom page to show?\n    context.res.writeHead(404);\n    context.res.end();\n    return;\n  }\n\n  await dispatchUpdateVehicleFilterSearch(context, vehiclesFilter);\n\n  if (vehicleType === VehicleTypes.Car) {\n    //TODO: set from filter?\n    dispatchUpdateDealToggle(context);\n  }\n\n  const fetchHeaders = getLOSSRFetchHeaders(context); //Why do we need them on server-side?\n\n  const modelPreviews = (await GetVehicleModelPreviews(vehiclesFilter, {\n    pageSize: 9999,\n    pageIndex: 1\n  }, undefined, fetchHeaders)).data;\n  const topPicks = (await GetTopLoPickVehicles(vehiclesFilter.vehicleType, '', null, null, fetchHeaders)).data;\n  const metaData = vehicleType === VehicleTypes.Commercial ? {\n    title: `Van Leasing | Van Lease Deals & Long Term Van Hire | Leasing Options UK`,\n    description: `Leasing Options offer the most competitive van lease deals in the marketplace. We will not be beaten on price for long term van hire.`,\n    canonicalUrl: GetCanonicalUrl(getBaseUrl(context.req.url)).toLowerCase(),\n    keywords: `Van Leasing, Long Term Van Hire, Van lease deals`\n  } : {\n    title: `Car Leasing | Personal Lease Deals &amp; Contract Hire | Leasing Options`,\n    description: `Get the best car leasing deals for personal contract hire from Leasing Options. Vehicles delivered anywhere in the UK. Get your FREE instant quote, today.`,\n    canonicalUrl: GetCanonicalUrl(getBaseUrl(context.req.url)).toLowerCase(),\n    keywords: `Personal Car Leasing, Personal Car Lease Deals, Personal Car Leasing Manchester, Contract hire`\n  };\n  return {\n    props: {\n      metaData: metaData,\n      modelPreviews: modelPreviews,\n      topPicks: topPicks,\n      vehicleFilter: vehiclesFilter\n    }\n  };\n};","map":null,"metadata":{},"sourceType":"module"}