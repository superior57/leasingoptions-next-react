{"ast":null,"code":"import _regeneratorRuntime from \"E:/current_project/PPH/tfs/Website/website/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _asyncToGenerator from \"E:/current_project/PPH/tfs/Website/website/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"E:\\\\current_project\\\\PPH\\\\tfs\\\\Website\\\\Website\\\\components\\\\layout\\\\header\\\\header-search.tsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport Link from 'next/link';\nimport { connect } from 'react-redux';\nimport style from './header.module.scss';\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faSpinner, faSearch } from \"@fortawesome/free-solid-svg-icons\";\nimport { GetVehicleUrl } from \"helpers/urlHelper\";\nimport { LeasingDealTypes } from 'enums/LeasingDealTypes';\nimport { VehicleTypes } from 'enums/VehicleTypes';\nimport { GetSearchResults } from 'business-logic/vehicleService';\n\nvar HeaderSearch = function HeaderSearch(_ref) {\n  _s();\n\n  var dealSelector = _ref.dealSelector,\n      isInternal = _ref.isInternal;\n\n  var _useState = useState(dealSelector === LeasingDealTypes.Van ? LeasingDealTypes.Business : dealSelector),\n      leaseDealType = _useState[0],\n      setLeaseDealType = _useState[1];\n\n  var _useState2 = useState(false),\n      isLoading = _useState2[0],\n      setIsLoading = _useState2[1];\n\n  var _useState3 = useState(false),\n      isActive = _useState3[0],\n      setIsactive = _useState3[1];\n\n  var _useState4 = useState([]),\n      searchResults = _useState4[0],\n      setSearchResults = _useState4[1];\n\n  var handleSearchInit = function handleSearchInit(evt) {\n    var searchQuery = evt.target.value.toString();\n\n    if (searchQuery.length >= 2) {\n      setIsLoading(true);\n      Promise.resolve(getSearchResults(searchQuery)).then(function (data) {\n        setIsactive(true);\n        setSearchResults(data.data);\n        setIsLoading(false);\n      });\n    } else {\n      setIsactive(false);\n      setSearchResults([]);\n    }\n  };\n\n  var handleSearchBlur = function handleSearchBlur() {\n    document.body.removeEventListener('click', handleSearchClose);\n  };\n\n  var handleSearchClose = function handleSearchClose() {\n    setIsactive(false);\n    setIsLoading(false);\n    setSearchResults([]);\n  };\n\n  function getSearchResults(_x) {\n    return _getSearchResults.apply(this, arguments);\n  }\n\n  function _getSearchResults() {\n    _getSearchResults = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(searchQuery) {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return GetSearchResults(searchQuery, isInternal);\n\n            case 2:\n              return _context.abrupt(\"return\", _context.sent);\n\n            case 3:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    return _getSearchResults.apply(this, arguments);\n  }\n\n  useEffect(function () {\n    setLeaseDealType(dealSelector === LeasingDealTypes.Van ? LeasingDealTypes.Personal : dealSelector);\n    setIsactive(false);\n    setSearchResults([]);\n    setIsLoading(false);\n  }, [dealSelector]);\n  useEffect(function () {\n    document.body.addEventListener('click', handleSearchClose);\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: style['input-wrapper'],\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: style['input-icon'],\n      children: /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n        width: \"16\",\n        height: \"16\",\n        icon: faSearch\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 50\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 13\n    }, _this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"search\",\n      placeholder: \"e.g. BMW 3 Series\",\n      onFocus: function onFocus(evt) {\n        handleSearchInit(evt);\n      },\n      onKeyUp: function onKeyUp(evt) {\n        handleSearchInit(evt);\n      },\n      onBlur: function onBlur(evt) {\n        return handleSearchBlur;\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 13\n    }, _this), isLoading ? /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n      width: \"16\",\n      height: \"16\",\n      icon: faSpinner,\n      className: \"fa-spin \".concat(style['input-loading'])\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 26\n    }, _this) : \"\", /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"\".concat(style['input-list'], \" \").concat(isActive ? style['is-active'] : \"\"),\n      children: /*#__PURE__*/_jsxDEV(\"ul\", {\n        children: searchResults.map(function (result) {\n          return /*#__PURE__*/_jsxDEV(\"li\", {\n            children: /*#__PURE__*/_jsxDEV(Link, {\n              passHref: true,\n              href: GetVehicleUrl(false, '', result.vehicleTypeId === VehicleTypes.Commercial ? LeasingDealTypes.Van : leaseDealType, result.manufacturer, result.shortModTextUrl, result.modelUrl, result.derivativeUrl, result.vehicleRef, null, null, null, null, isInternal),\n              children: /*#__PURE__*/_jsxDEV(\"a\", {\n                children: [result.manufacturer, \" \", result.model, \" \", result.derivative]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 70,\n                columnNumber: 348\n              }, _this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 70,\n              columnNumber: 73\n            }, _this)\n          }, \"result-\".concat(result.vehicleRef), false, {\n            fileName: _jsxFileName,\n            lineNumber: 70,\n            columnNumber: 33\n          }, _this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 17\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 13\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 63,\n    columnNumber: 9\n  }, _this);\n};\n\n_s(HeaderSearch, \"SGXGyFgwdJsSeX7it21UTjzq+p4=\");\n\n_c = HeaderSearch;\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    isInternal: state.isInternal\n  };\n};\n\nexport default connect(mapStateToProps)(HeaderSearch);\n\nvar _c;\n\n$RefreshReg$(_c, \"HeaderSearch\");","map":{"version":3,"sources":["E:/current_project/PPH/tfs/Website/Website/components/layout/header/header-search.tsx"],"names":["React","useState","useEffect","Link","connect","style","FontAwesomeIcon","faSpinner","faSearch","GetVehicleUrl","LeasingDealTypes","VehicleTypes","GetSearchResults","HeaderSearch","dealSelector","isInternal","Van","Business","leaseDealType","setLeaseDealType","isLoading","setIsLoading","isActive","setIsactive","searchResults","setSearchResults","handleSearchInit","evt","searchQuery","target","value","toString","length","Promise","resolve","getSearchResults","then","data","handleSearchBlur","document","body","removeEventListener","handleSearchClose","Personal","addEventListener","map","result","vehicleTypeId","Commercial","manufacturer","shortModTextUrl","modelUrl","derivativeUrl","vehicleRef","model","derivative","mapStateToProps","state"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport Link from 'next/link';\r\nimport { connect } from 'react-redux';\r\nimport style from './header.module.scss';\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faSpinner, faSearch } from \"@fortawesome/free-solid-svg-icons\";\r\nimport { GetVehicleUrl } from \"helpers/urlHelper\";\r\nimport { LeasingDealTypes } from 'enums/LeasingDealTypes';\r\nimport { VehicleTypes } from 'enums/VehicleTypes';\r\nimport { GetSearchResults } from 'business-logic/vehicleService';\r\n\r\ntype Props = {\r\n    dealSelector: LeasingDealTypes;\r\n    isInternal: boolean;\r\n}\r\n\r\nconst HeaderSearch: React.FC<Props> = ({ dealSelector, isInternal}) => {\r\n    const [leaseDealType, setLeaseDealType] = useState<LeasingDealTypes>(dealSelector === LeasingDealTypes.Van ? LeasingDealTypes.Business : dealSelector);\r\n    const [isLoading, setIsLoading] = useState<boolean>(false);\r\n    const [isActive, setIsactive] = useState<boolean>(false);\r\n    const [searchResults, setSearchResults] = useState([]);\r\n    const handleSearchInit = (evt) => {\r\n        let searchQuery = evt.target.value.toString();\r\n\r\n        if (searchQuery.length >=2) {\r\n            setIsLoading(true);\r\n\r\n            Promise.resolve(getSearchResults(searchQuery)).then(function(data) {\r\n                setIsactive(true);\r\n                setSearchResults(data.data);\r\n                setIsLoading(false);\r\n            })\r\n        } else {\r\n            setIsactive(false);\r\n            setSearchResults([]);\r\n        }\r\n    };\r\n    const handleSearchBlur = () => {\r\n        document.body.removeEventListener('click', handleSearchClose);\r\n    }\r\n    const handleSearchClose = () => {\r\n        setIsactive(false);\r\n        setIsLoading(false);\r\n        setSearchResults([]);\r\n    }\r\n\r\n    async function getSearchResults(searchQuery) {\r\n        return await GetSearchResults(searchQuery, isInternal);\r\n    } \r\n\r\n    useEffect(() => {\r\n        setLeaseDealType(dealSelector === LeasingDealTypes.Van ? LeasingDealTypes.Personal : dealSelector);\r\n        setIsactive(false);\r\n        setSearchResults([]);\r\n        setIsLoading(false);\r\n    }, [dealSelector]);\r\n\r\n    useEffect(() => {\r\n        document.body.addEventListener('click', handleSearchClose);\r\n    }, []);\r\n\r\n    return (\r\n        <div className={style['input-wrapper']}>\r\n            <div className={style['input-icon']}><FontAwesomeIcon width=\"16\" height=\"16\" icon={faSearch} /></div>\r\n            <input type=\"search\" placeholder=\"e.g. BMW 3 Series\" onFocus={(evt) => {handleSearchInit(evt)}} onKeyUp={(evt) => {handleSearchInit(evt)}} onBlur={(evt) => handleSearchBlur} />\r\n            {isLoading ? <FontAwesomeIcon width=\"16\" height=\"16\" icon={faSpinner} className={`fa-spin ${style['input-loading']}`} /> : \"\"}\r\n            <div className={`${style['input-list']} ${isActive ? style['is-active'] : \"\"}`}>\r\n                <ul>\r\n                    {searchResults.map(result => {\r\n                        return (<li key={`result-${result.vehicleRef}`}><Link passHref href={GetVehicleUrl(false, '', result.vehicleTypeId === VehicleTypes.Commercial ? LeasingDealTypes.Van : leaseDealType, result.manufacturer, result.shortModTextUrl, result.modelUrl, result.derivativeUrl, result.vehicleRef, null, null, null, null, isInternal)}><a>{result.manufacturer} {result.model} {result.derivative}</a></Link></li>);\r\n                    })}\r\n                </ul>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nconst mapStateToProps = (state) => ({\r\n    isInternal: state.isInternal\r\n});\r\n\r\nexport default connect(mapStateToProps)(HeaderSearch);"]},"metadata":{},"sourceType":"module"}