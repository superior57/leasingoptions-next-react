{"ast":null,"code":"import { jsx as _jsx } from \"react/jsx-runtime\";\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport wrapper from 'redux/store.tsx/store';\nimport MainLayout from 'components/layout/main-layout';\nimport SearchPageTemplate from 'components/pages/search';\nimport { PricingTypes } from 'enums/PricingTypes';\nimport { getLOSSRFetchHeaders } from 'helpers/apiHelper';\nimport { getBaseUrl } from 'helpers/urlsHelper';\nimport { GetCanonicalUrl } from 'helpers/urlHelper';\nimport { getVehiclesFilter } from 'helpers/vehiclesFilterHelper';\nimport { dispatchUpdateDealToggle, dispatchUpdateUserPostcode, dispatchUpdateVehicleFilterSearch } from 'redux/dispatches/dispatchs';\nimport { GetTopLoPickVehicles, GetVehicleModelPreviews } from 'business-logic/vehicleService'; //TODO: check logic\n\nexport const getServerSideProps = wrapper.getServerSideProps(async context => {\n  dispatchUpdateDealToggle(context);\n  dispatchUpdateUserPostcode(context);\n  const dealSelector = context.store.getState().dealSelector;\n  const userPostcode = context.store.getState().userPostcode;\n  let vehiclesFilter = getVehiclesFilter(context);\n  vehiclesFilter.leasingDealType = dealSelector;\n  vehiclesFilter.postcode = userPostcode;\n  vehiclesFilter.maintenance = false;\n  await dispatchUpdateVehicleFilterSearch(context, vehiclesFilter);\n  const fetchHeaders = getLOSSRFetchHeaders(context);\n  const paginationCriteria = {\n    pageSize: 11,\n    pageIndex: 1\n  };\n  const modelPreviews = (await GetVehicleModelPreviews(vehiclesFilter, paginationCriteria, undefined, fetchHeaders)).data;\n  const topPicks = (await GetTopLoPickVehicles(vehiclesFilter.vehicleType, '', PricingTypes.Atc, userPostcode, fetchHeaders)).data; //Missing postcode\n\n  const metaData = {\n    title: `Car Leasing | Personal Lease Deals &amp; Contract Hire | Leasing Options`,\n    description: `Get the best car leasing deals for personal contract hire from Leasing Options. Vehicles delivered anywhere in the UK. Get your FREE instant quote, today.`,\n    canonicalUrl: GetCanonicalUrl(getBaseUrl(context.req.url)),\n    keywords: `Personal Car Leasing, Personal Car Lease Deals, Personal Car Leasing Manchester, Contract hire`\n  };\n  return {\n    props: {\n      pricingType: vehiclesFilter.pricingType,\n      userPostcode: userPostcode,\n      metaData: metaData,\n      modelPreviews: modelPreviews,\n      topPicks: topPicks,\n      vehicleFilter: vehiclesFilter\n    }\n  };\n});\n\nfunction mapStateToProps(state) {\n  return {\n    leasingDealType: state.dealSelector\n  };\n}\n\nconst AtcSearchPage = ({\n  pricingType,\n  userPostcode,\n  leasingDealType,\n  vehicleFilter,\n  modelPreviews,\n  topPicks\n}) => {\n  return /*#__PURE__*/_jsx(SearchPageTemplate, {\n    pricingType: pricingType,\n    userPostcode: userPostcode,\n    leasingDealType: leasingDealType,\n    vehicleFilter: vehicleFilter,\n    modelPreviews: modelPreviews,\n    topPicks: topPicks\n  });\n};\n\nAtcSearchPage.layout = MainLayout;\nexport default connect(mapStateToProps)(AtcSearchPage);","map":null,"metadata":{},"sourceType":"module"}