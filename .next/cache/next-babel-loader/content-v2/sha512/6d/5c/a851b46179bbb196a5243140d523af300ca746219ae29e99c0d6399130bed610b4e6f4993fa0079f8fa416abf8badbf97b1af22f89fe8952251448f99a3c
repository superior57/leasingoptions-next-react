{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React, { useState, useEffect } from 'react';\nimport Link from 'next/link';\nimport { useRouter } from 'next/router';\nimport ExpandableText from 'components/expandable-text';\nimport CardManufacturer from 'components/card/card-manufacturer';\nimport CardVehicle from 'components/card/card-vehicle';\nimport VehicleCarousel from 'components/vehicle-carousel';\nimport DropDown from 'components/layout/drop-down';\nimport Pagination from 'components/layout/pagination';\nimport Pagesize from 'components/layout/pagesize';\nimport TrustMicro from 'components/trustpilot/trust-micro';\nimport CardNews from 'components/card/card-news';\nimport { useIsMount } from 'custom-hooks/useIsMount';\nimport { VehicleTypes } from 'enums/VehicleTypes';\nimport { LeasingDealTypes } from 'enums/LeasingDealTypes';\nimport { PricingTypes } from 'enums/PricingTypes';\nimport { GetVehicleManufacturerUrl } from 'helpers/urlHelper';\nimport { MakeVanABCheck, MakeABCheck, MakeABSplit, MakeContentABCheck } from 'helpers/helpers';\nimport { TrustThemeTypes } from 'enums/TrustThemeTypes';\nimport CardWithStickers from 'components/card/card-with-stickers';\nimport { GetVehicleModelPreviews } from 'business-logic/vehicleService';\nimport ReactPlaceholder from 'react-placeholder';\nimport \"react-placeholder/lib/reactPlaceholder.css\";\n\n//TODO: check logic\nconst MakePage = ({\n  leasingDealType,\n  vehicleType,\n  title,\n  description,\n  vehicleFilter,\n  modelData,\n  makeName,\n  makeUrl,\n  modelPreviews,\n  topPicks,\n  pricingType,\n  userPostcode,\n  categoryNews\n}) => {\n  var _vehicleFilter$manufa, _MakeABSplit, _modelPreviewsData$da, _MakeABSplit2, _MakeABSplit3, _MakeABSplit4, _categoryNews$dataIte, _categoryNews$dataIte2, _categoryNews$dataIte3;\n\n  const isMount = useIsMount();\n  const router = useRouter();\n  const {\n    0: modelPreviewsData,\n    1: setModelPreviewsData\n  } = useState(modelPreviews);\n  const isATC = pricingType === PricingTypes.Atc;\n  const {\n    0: totalResults,\n    1: setTotalResults\n  } = useState(0);\n  const {\n    0: pageCount,\n    1: setPagecount\n  } = useState(1);\n  const {\n    0: currentPage,\n    1: setCurrentPage\n  } = useState(1);\n  const {\n    0: resultsPerPage,\n    1: setResultsPerPage\n  } = useState(isATC ? 12 : 999);\n  const {\n    0: sortBy,\n    1: setSortBy\n  } = useState('');\n  const {\n    0: sortDirection,\n    1: setSortDirection\n  } = useState(''); //Temp: Set news tag ID based off URL\n\n  let tagId = null;\n\n  switch (makeUrl === null || makeUrl === void 0 ? void 0 : makeUrl.toLocaleLowerCase()) {\n    case \"seat\":\n      tagId = 278;\n      break;\n\n    case \"skoda\":\n      tagId = 176;\n      break;\n\n    default:\n      break;\n  }\n\n  const handlePageSize = pagesize => setResultsPerPage(pagesize);\n\n  const handlePageClick = (evt, page) => {\n    evt.preventDefault();\n    setCurrentPage(page);\n  };\n\n  const handleModelChange = modelUrl => router.push(modelUrl);\n\n  const updateModelPreviews = async (sortBy, sortDirection) => {\n    const paginationCriteria = {\n      pageSize: resultsPerPage,\n      pageIndex: currentPage\n    };\n    const sortingCriteria = {\n      sortBy: sortBy,\n      sortDirection: sortDirection\n    };\n    await GetVehicleModelPreviews(vehicleFilter, paginationCriteria, sortingCriteria).then(function (data) {\n      var _data$data, _data$data2;\n\n      setModelPreviewsData(data === null || data === void 0 ? void 0 : data.data);\n      setTotalResults(data === null || data === void 0 ? void 0 : (_data$data = data.data) === null || _data$data === void 0 ? void 0 : _data$data.totalItemsCount);\n      setPagecount(data === null || data === void 0 ? void 0 : (_data$data2 = data.data) === null || _data$data2 === void 0 ? void 0 : _data$data2.totalPagesCount);\n    });\n  };\n\n  const handleSortChange = (sortBy, sortDirection) => {\n    setSortBy(sortBy);\n    setSortDirection(sortDirection);\n    updateModelPreviews(sortBy, sortDirection);\n  };\n\n  if (vehicleType === VehicleTypes.Commercial) {\n    leasingDealType = LeasingDealTypes.Van;\n  }\n\n  useEffect(() => {\n    updateModelPreviews(sortBy, sortDirection);\n  }, [leasingDealType, resultsPerPage, currentPage, sortBy, sortDirection]);\n  useEffect(() => {\n    if (!isMount) {\n      updateModelPreviews(sortBy, sortDirection);\n    }\n  }, [leasingDealType, resultsPerPage, currentPage, sortBy, sortDirection]);\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsxs(\"div\", {\n      className: `container-fluid py-3 ${isATC ? \"bg-atc py-md-5\" : \"pt-md-0\"} ${MakeContentABCheck(makeUrl, vehicleType) ? 'pb-md-4' : 'pb-md-5'}`,\n      children: [isATC && /*#__PURE__*/_jsx(\"div\", {\n        className: \"row\",\n        children: /*#__PURE__*/_jsx(\"div\", {\n          className: \"col-24 col-md-12 my-3\",\n          children: /*#__PURE__*/_jsx(TrustMicro, {\n            theme: TrustThemeTypes.Dark\n          })\n        })\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: \"row\",\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: `${isATC ? \"col-12\" : \"col-19 col-md-12\"} d-flex align-items-center ${!MakeContentABCheck(makeUrl, vehicleType) ? 'mb-4' : ''}`,\n          children: /*#__PURE__*/_jsx(\"h1\", {\n            className: \"m-0\",\n            children: title\n          })\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: `${isATC ? \"col-12\" : \"col-5 col-md-12\"} d-flex flex-wrap align-items-center justify-content-end ${!MakeContentABCheck(makeUrl, vehicleType) ? 'mb-4' : ''}`,\n          children: [isATC && /*#__PURE__*/_jsx(\"img\", {\n            width: \"200\",\n            \"data-src\": `${process.env.NEXT_PUBLIC_CDN}/website/insured-leasing/fuel-strap-logo.svg`,\n            className: \"img-fluid mr-md-3 lazyload\",\n            alt: \"Fuel & Go logo\"\n          }), /*#__PURE__*/_jsx(\"img\", {\n            \"data-src\": `${process.env.NEXT_PUBLIC_CDN}/website/static/makes/${vehicleFilter === null || vehicleFilter === void 0 ? void 0 : (_vehicleFilter$manufa = vehicleFilter.manufacturerUrl) === null || _vehicleFilter$manufa === void 0 ? void 0 : _vehicleFilter$manufa.toLowerCase()}.svg`,\n            className: \"img-fluid manfacturer-logo lazyload\",\n            alt: `${vehicleFilter === null || vehicleFilter === void 0 ? void 0 : vehicleFilter.manufacturerUrl} logo`\n          })]\n        })]\n      }), !MakeContentABCheck(makeUrl, vehicleType) && /*#__PURE__*/_jsx(\"div\", {\n        className: \"row\",\n        children: /*#__PURE__*/_jsx(\"div\", {\n          className: \"col-24\",\n          children: description ? /*#__PURE__*/_jsx(ExpandableText, {\n            theme: isATC ? \"dark\" : \"light\",\n            modelDropDown: true,\n            modelDropDownData: modelData,\n            vehicleFilter: vehicleFilter,\n            leasingDealType: leasingDealType,\n            handleModelChange: handleModelChange,\n            children: MakeABCheck(makeUrl, vehicleType) ? (_MakeABSplit = MakeABSplit(makeUrl, description.toString())) === null || _MakeABSplit === void 0 ? void 0 : _MakeABSplit[0] : description\n          }) : null\n        })\n      })]\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      className: `container-fluid ${MakeVanABCheck(makeUrl, vehicleType) ? \"pt-5 pb-4 pb-md-3\" : \"py-5\"} bg-light-grey`,\n      children: [/*#__PURE__*/_jsxs(\"div\", {\n        className: \"row\",\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: \"col-24 col-md-18\",\n          children: /*#__PURE__*/_jsxs(\"h3\", {\n            className: \"mb-3 mb-md-5\",\n            children: [/*#__PURE__*/_jsx(\"mark\", {\n              className: \"mark-text\",\n              children: modelPreviewsData === null || modelPreviewsData === void 0 ? void 0 : modelPreviewsData.totalVehiclesCount\n            }), \" Matching Deals from \", /*#__PURE__*/_jsx(\"mark\", {\n              className: \"mark-text\",\n              children: modelPreviewsData === null || modelPreviewsData === void 0 ? void 0 : modelPreviewsData.totalItemsCount\n            }), \" Matching Models\"]\n          })\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: \"col-24 col-md-6 mb-3 mb-md-0\",\n          children: /*#__PURE__*/_jsxs(DropDown, {\n            indicator: true,\n            active: \"Default\",\n            wrapperClass: \"w-100\",\n            buttonClass: \"btn-block bg-white text-left\",\n            buttonText: \"Sort by\",\n            children: [/*#__PURE__*/_jsx(\"button\", {\n              type: \"button\",\n              className: \"text-left\",\n              onClick: () => handleSortChange('', ''),\n              children: \"Default\"\n            }), /*#__PURE__*/_jsx(\"button\", {\n              type: \"button\",\n              className: \"text-left\",\n              onClick: () => handleSortChange('OrderPrice', 'DESC'),\n              children: \"Price High-Low\"\n            }), /*#__PURE__*/_jsx(\"button\", {\n              type: \"button\",\n              className: \"text-left\",\n              onClick: () => handleSortChange('OrderPrice', 'ASC'),\n              children: \"Price Low-High\"\n            }), /*#__PURE__*/_jsx(\"button\", {\n              type: \"button\",\n              className: \"text-left\",\n              onClick: () => handleSortChange('Seats', 'DESC'),\n              children: \"Seats High-Low\"\n            }), /*#__PURE__*/_jsx(\"button\", {\n              type: \"button\",\n              className: \"text-left\",\n              onClick: () => handleSortChange('Seats', 'ASC'),\n              children: \"Seats Low-High\"\n            }), /*#__PURE__*/_jsx(\"button\", {\n              type: \"button\",\n              className: \"text-left\",\n              onClick: () => handleSortChange('EngineSize', 'DESC'),\n              children: \"Engine Size High-Low\"\n            }), /*#__PURE__*/_jsx(\"button\", {\n              type: \"button\",\n              className: \"text-left\",\n              onClick: () => handleSortChange('EngineSize', 'ASC'),\n              children: \"Engine Size Low-High\"\n            }), /*#__PURE__*/_jsx(\"button\", {\n              type: \"button\",\n              className: \"text-left\",\n              onClick: () => handleSortChange('Mpg', 'DESC'),\n              children: \"MPG High-Low\"\n            }), /*#__PURE__*/_jsx(\"button\", {\n              type: \"button\",\n              className: \"text-left\",\n              onClick: () => handleSortChange('Mpg', 'ASC'),\n              children: \"MPG Low-High\"\n            }), /*#__PURE__*/_jsx(\"button\", {\n              type: \"button\",\n              className: \"text-left\",\n              onClick: () => handleSortChange('CO2', 'DESC'),\n              children: \"CO2 High-Low\"\n            }), /*#__PURE__*/_jsx(\"button\", {\n              type: \"button\",\n              className: \"text-left\",\n              onClick: () => handleSortChange('CO2', 'ASC'),\n              children: \"CO2 Low-High\"\n            })]\n          })\n        })]\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: \"row\",\n        children: modelPreviewsData === null || modelPreviewsData === void 0 ? void 0 : (_modelPreviewsData$da = modelPreviewsData.dataItems) === null || _modelPreviewsData$da === void 0 ? void 0 : _modelPreviewsData$da.map(model => {\n          var _modelPreviewsData$da2;\n\n          return /*#__PURE__*/_jsx(ReactPlaceholder, {\n            firstLaunchOnly: true,\n            className: \"col-24 col-md-12 col-lg-6 mb-3\",\n            type: \"text\",\n            showLoadingAnimation: true,\n            ready: (modelPreviewsData === null || modelPreviewsData === void 0 ? void 0 : (_modelPreviewsData$da2 = modelPreviewsData.dataItems) === null || _modelPreviewsData$da2 === void 0 ? void 0 : _modelPreviewsData$da2.length) > 0 ? true : false,\n            rows: 6,\n            children: /*#__PURE__*/_jsx(\"div\", {\n              className: \"col-24 col-md-12 col-lg-6 d-flex\",\n              children: /*#__PURE__*/_jsx(CardManufacturer, {\n                isATC: isATC,\n                userPostcode: userPostcode,\n                vehicle: model,\n                dealSelector: leasingDealType\n              })\n            }, model === null || model === void 0 ? void 0 : model.vehicleRef)\n          }, model === null || model === void 0 ? void 0 : model.vehicleRef);\n        })\n      }), isATC && /*#__PURE__*/_jsxs(\"div\", {\n        className: \"row\",\n        children: [/*#__PURE__*/_jsx(Pagesize, {\n          className: \"col-md-12 d-flex justify-content-start align-items-center my-3\",\n          increments: [12, 24, 36],\n          activePage: resultsPerPage,\n          handlePageClick: pagesize => handlePageSize(pagesize)\n        }), /*#__PURE__*/_jsx(Pagination, {\n          className: \"col-md-12 d-flex justify-content-end align-items-center my-3\",\n          totalResults: totalResults,\n          pageCount: pageCount,\n          currentPage: currentPage,\n          handlePageClick: handlePageClick\n        })]\n      })]\n    }), MakeVanABCheck(makeUrl, vehicleType) && /*#__PURE__*/_jsx(\"div\", {\n      className: \"container-fluid pb-5 bg-light-grey\",\n      children: /*#__PURE__*/_jsx(\"div\", {\n        className: \"row\",\n        children: /*#__PURE__*/_jsx(\"div\", {\n          className: \"col-24 text-center\",\n          children: /*#__PURE__*/_jsx(Link, {\n            passHref: true,\n            href: GetVehicleManufacturerUrl(false, '', LeasingDealTypes.Van, makeUrl),\n            children: /*#__PURE__*/_jsxs(\"a\", {\n              className: \"btn btn-outline-primary btn-lg btn-fluid-xs\",\n              children: [\"View \", makeName, \" Van Lease Deals\"]\n            })\n          })\n        })\n      })\n    }), MakeABCheck(makeUrl, vehicleType) && /*#__PURE__*/_jsxs(\"div\", {\n      className: \"container-fluid py-5 bg-white\",\n      children: [/*#__PURE__*/_jsx(\"div\", {\n        className: \"row\",\n        children: /*#__PURE__*/_jsx(\"div\", {\n          className: \"col-24\",\n          children: /*#__PURE__*/_jsxs(\"h2\", {\n            className: \"mb-3 mb-md-5\",\n            children: [\"Leasing A \", makeName]\n          })\n        })\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: \"row\",\n        children: /*#__PURE__*/_jsx(\"div\", {\n          className: \"col-24\",\n          dangerouslySetInnerHTML: {\n            __html: ((_MakeABSplit2 = MakeABSplit(makeUrl, description.toString())) === null || _MakeABSplit2 === void 0 ? void 0 : _MakeABSplit2[1]) + ((_MakeABSplit3 = MakeABSplit(makeUrl, description.toString())) === null || _MakeABSplit3 === void 0 ? void 0 : _MakeABSplit3[2])\n          }\n        })\n      })]\n    }), MakeContentABCheck(makeUrl, vehicleType) && /*#__PURE__*/_jsx(\"div\", {\n      className: \"container-fluid py-5 bg-white\",\n      children: /*#__PURE__*/_jsx(\"div\", {\n        className: \"row\",\n        children: /*#__PURE__*/_jsx(\"div\", {\n          className: \"col-24\",\n          children: description ? /*#__PURE__*/_jsx(ExpandableText, {\n            theme: \"light\",\n            modelDropDown: true,\n            vehicleFilter: vehicleFilter,\n            leasingDealType: leasingDealType,\n            children: MakeABCheck(makeUrl, vehicleType) ? (_MakeABSplit4 = MakeABSplit(makeUrl, description.toString())) === null || _MakeABSplit4 === void 0 ? void 0 : _MakeABSplit4[0] : description\n          }) : null\n        })\n      })\n    }), /*#__PURE__*/_jsxs(CardWithStickers, {\n      children: [MakeContentABCheck(makeUrl, vehicleType) && (categoryNews === null || categoryNews === void 0 ? void 0 : (_categoryNews$dataIte = categoryNews.dataItems) === null || _categoryNews$dataIte === void 0 ? void 0 : _categoryNews$dataIte.length) > 0 && /*#__PURE__*/_jsx(\"section\", {\n        className: \"container-fluid py-md-5 bg-light-grey\",\n        children: /*#__PURE__*/_jsxs(\"div\", {\n          className: \"row\",\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: \"col-24\",\n            children: /*#__PURE__*/_jsxs(\"h3\", {\n              className: \"text-center mb-0 mb-md-3\",\n              children: [makeName, \" News\"]\n            })\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"col-24 mt-3 mb-5 mb-md-0\",\n            children: /*#__PURE__*/_jsx(VehicleCarousel, {\n              className: \"slick-paginated\",\n              dots: true,\n              mobileAuto: true,\n              mobileArrows: true,\n              tabletArrows: true,\n              desktopArrows: true,\n              infinite: (categoryNews === null || categoryNews === void 0 ? void 0 : (_categoryNews$dataIte2 = categoryNews.dataItems) === null || _categoryNews$dataIte2 === void 0 ? void 0 : _categoryNews$dataIte2.length) > 4,\n              children: categoryNews === null || categoryNews === void 0 ? void 0 : (_categoryNews$dataIte3 = categoryNews.dataItems) === null || _categoryNews$dataIte3 === void 0 ? void 0 : _categoryNews$dataIte3.map(article => {\n                return /*#__PURE__*/_jsx(CardNews, {\n                  id: `article-${article.id}`,\n                  className: \"card-news--space\",\n                  image: article.imageUrl,\n                  tag: article.type,\n                  link: article.url,\n                  title: article.title,\n                  date: article.onDate,\n                  excerpt: article.description\n                }, `article-${article.id}`);\n              })\n            })\n          })]\n        })\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: `container-fluid py-5 ${MakeABCheck(makeUrl, vehicleType) ? \"bg-light-grey\" : \"bg-white\"}`,\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: \"row\",\n          children: /*#__PURE__*/_jsx(\"div\", {\n            className: \"col-24\",\n            children: /*#__PURE__*/_jsx(\"h2\", {\n              className: \"mb-3 mb-md-5\",\n              children: \"Customers Also Viewed...\"\n            })\n          })\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: \"row\",\n          children: /*#__PURE__*/_jsx(\"div\", {\n            className: \"col-24\",\n            children: /*#__PURE__*/_jsx(VehicleCarousel, {\n              tabletArrows: true,\n              desktopArrows: true,\n              infinite: (topPicks === null || topPicks === void 0 ? void 0 : topPicks.length) > 3,\n              children: topPicks === null || topPicks === void 0 ? void 0 : topPicks.map(vehicle => /*#__PURE__*/_jsx(ReactPlaceholder, {\n                firstLaunchOnly: true,\n                type: \"text\",\n                showLoadingAnimation: true,\n                ready: (topPicks === null || topPicks === void 0 ? void 0 : topPicks.length) > 0 ? true : false,\n                rows: 6,\n                children: /*#__PURE__*/_jsx(CardVehicle, {\n                  id: `picked-${vehicle.vehicleRef}`,\n                  isATC: isATC,\n                  userPostcode: userPostcode,\n                  vehicle: vehicle,\n                  dealSelector: leasingDealType,\n                  showStickers: false\n                }, `featured-${vehicle.vehicleRef}`)\n              }, `featured-${vehicle.vehicleRef}`))\n            })\n          })\n        })]\n      })]\n    })]\n  });\n};\n\nexport default MakePage;","map":null,"metadata":{},"sourceType":"module"}