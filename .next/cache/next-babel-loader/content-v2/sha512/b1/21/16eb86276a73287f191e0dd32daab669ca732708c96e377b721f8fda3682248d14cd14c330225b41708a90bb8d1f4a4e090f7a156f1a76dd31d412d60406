{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React, { useState, useEffect } from 'react';\nimport style from 'sass/single-post.module.scss';\nimport Link from 'next/link';\nimport MainLayout from '../../../components/layout/main-layout';\nimport PageUpsell from '../../../components/layout/page-upsell';\nimport PageFaqs from '../../../components/layout/page-faqs';\nimport AsideGuides from '../../../components/layout/aside-guides';\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faThumbsUp, faThumbsDown } from \"@fortawesome/pro-regular-svg-icons\";\nimport { InlineShareButtons } from 'sharethis-reactjs';\nimport wrapper from 'redux/store.tsx/store';\nimport { ContentService } from 'business-logic/contentService';\nimport * as _ from 'underscore';\nexport const getServerSideProps = wrapper.getServerSideProps(async context => {\n  const postUrl = context.query.url;\n  const categoryUrl = context.query.category;\n  const categoryList = await ContentService.GetContentCategories();\n\n  const category = _.find(categoryList.data || [], function (item) {\n    return item.url === categoryUrl;\n  });\n\n  const popularGuides = await ContentService.GetPopularContentItems();\n  const pageContent = await ContentService.GetByUrl(postUrl);\n  const faqList = await ContentService.GetAdviceGuidesFaqs(0);\n  const metaData = {\n    title: pageContent === null || pageContent === void 0 ? void 0 : pageContent.data.seoPageTitle,\n    description: pageContent === null || pageContent === void 0 ? void 0 : pageContent.data.seoMetaDescription,\n    canonicalUrl: context.req.url,\n    ampHTML: `/amp/advice/${categoryUrl}/${postUrl}`,\n    imageUrl: pageContent === null || pageContent === void 0 ? void 0 : pageContent.data.imageUrl\n  };\n  return {\n    props: {\n      postUrl: postUrl,\n      category: category,\n      categoryList: categoryList.data,\n      popularGuides: popularGuides.data,\n      pageContent: pageContent.data,\n      faqList: faqList.data,\n      metaData: metaData\n    }\n  };\n});\nexport default function AdvicePost({\n  postUrl,\n  category,\n  metaData,\n  categoryList,\n  popularGuides,\n  faqList,\n  pageContent\n}) {\n  const {\n    0: likeCount,\n    1: setLikeCount\n  } = useState(pageContent.likesCount === null ? 0 : pageContent.likesCount);\n  const {\n    0: dislikeCount,\n    1: setDisikeCount\n  } = useState(pageContent.dislikesCount === null ? 0 : pageContent.dislikesCount);\n  const cardImage = pageContent.imageUrl ? pageContent.imageUrl : process.env.NEXT_PUBLIC_CDN + \"/fit-in/400x400/website/static/img-placeholder.jpg\";\n\n  const handleIncrementLikes = newsId => {\n    //TODO: ADD check for user IP\n    Promise.resolve(IncrementLikes(newsId)).then(function (data) {\n      setLikeCount(likeCount + 1);\n    });\n  };\n\n  const handleIncrementDislikes = newsId => {\n    //TODO: ADD check for user IP\n    Promise.resolve(IncrementDislikes(newsId)).then(function (data) {\n      setDisikeCount(dislikeCount + 1);\n    });\n  };\n\n  async function IncrementLikes(newsId) {\n    return await ContentService.IncrementLikes(newsId);\n  }\n\n  async function IncrementDislikes(newsId) {\n    return await ContentService.IncrementDislikes(newsId);\n  }\n\n  useEffect(() => {\n    if (postUrl === 'car-running-cost-calculator') {\n      appendCalculatorScript('runningCalcScript', `\n                var eventMethod = window.addEventListener\n                    ? \"addEventListener\"\n                    : \"attachEvent\";\n                var eventer = window[eventMethod];\n                var messageEvent = eventMethod == \"attachEvent\" ? \"onmessage\" : \"message\";\n                eventer(\n                    messageEvent,\n                    function (e) {\n                    if (e.data.indexOf(\"resize::\") != -1) {\n                        var height = e.data.replace(\"resize::\", \"\");\n                        document.getElementById(\"runningCalc\").style.height = height + \"px\";\n                    }\n                    },\n                    false\n                );\n            `, false);\n    }\n\n    if (postUrl === 'pcp-early-settlement-calculator') {\n      appendCalculatorScript('pcpCalcScript', `\n                var eventMethod = window.addEventListener\n                    ? \"addEventListener\"\n                    : \"attachEvent\";\n                var eventer = window[eventMethod];\n                var messageEvent = eventMethod == \"attachEvent\" ? \"onmessage\" : \"message\";\n                eventer(\n                    messageEvent,\n                    function (e) {\n                    if (e.data.indexOf(\"resize::\") != -1) {\n                        var height = e.data.replace(\"resize::\", \"\");\n                        document.getElementById(\"pcpCalc\").style.height = height + \"px\";\n                    }\n                    },\n                    false\n                );\n            `, false);\n    }\n  }, []);\n\n  function appendCalculatorScript(id, text, async) {\n    const mainScript = document.createElement('script');\n    mainScript.type = 'text/javascript';\n    mainScript.id = id;\n    mainScript.text = text;\n    mainScript.async = async;\n    document.head.appendChild(mainScript);\n  }\n\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsx(\"section\", {\n      className: \"bg-light-grey py-3 py-md-5\",\n      children: /*#__PURE__*/_jsx(\"div\", {\n        className: \"container-fluid\",\n        children: /*#__PURE__*/_jsxs(\"div\", {\n          className: \"row d-flex\",\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: \"col-24 col-lg-18 order-2 order-lg-1\",\n            children: /*#__PURE__*/_jsxs(\"article\", {\n              className: style['single-post'],\n              children: [/*#__PURE__*/_jsxs(\"div\", {\n                className: style['single-post__img'],\n                children: [/*#__PURE__*/_jsx(\"img\", {\n                  className: \"img-fluid lazyload\",\n                  alt: `${pageContent.pageTitle} image`,\n                  \"data-src\": cardImage\n                }), /*#__PURE__*/_jsx(\"div\", {\n                  className: style['single-post__tags'],\n                  children: /*#__PURE__*/_jsx(\"ul\", {\n                    children: /*#__PURE__*/_jsx(\"li\", {\n                      children: /*#__PURE__*/_jsx(Link, {\n                        href: `/advice/${category.url}`,\n                        passHref: true,\n                        children: /*#__PURE__*/_jsx(\"a\", {\n                          children: category.name\n                        })\n                      })\n                    })\n                  })\n                })]\n              }), /*#__PURE__*/_jsxs(\"div\", {\n                className: style['single-post__info'],\n                children: [/*#__PURE__*/_jsx(\"h1\", {\n                  children: pageContent.pageTitle\n                }), /*#__PURE__*/_jsx(\"span\", {\n                  dangerouslySetInnerHTML: {\n                    __html: pageContent.pageSubtitle\n                  }\n                }), /*#__PURE__*/_jsx(\"div\", {\n                  className: \"w-100 position-relative\",\n                  dangerouslySetInnerHTML: {\n                    __html: pageContent.content\n                  }\n                })]\n              }), /*#__PURE__*/_jsxs(\"div\", {\n                className: style['single-post__tags'],\n                children: [pageContent.tags.length > 0 && /*#__PURE__*/_jsxs(\"ul\", {\n                  children: [/*#__PURE__*/_jsx(\"li\", {\n                    className: \"tag-label\",\n                    children: \"Tags\"\n                  }), pageContent.tags.map(tag => /*#__PURE__*/_jsx(\"li\", {\n                    children: tag\n                  }, `tag-${tag}`))]\n                }), /*#__PURE__*/_jsx(\"hr\", {})]\n              }), /*#__PURE__*/_jsxs(\"div\", {\n                className: `${style['single-post__social']} d-lg-flex align-items-center justify-content-center`,\n                children: [/*#__PURE__*/_jsxs(\"div\", {\n                  className: `${style['single-post__rate']} d-inline-flex flex-wrap align-items-lg-center justify-content-center justify-content-lg-start`,\n                  children: [/*#__PURE__*/_jsx(\"h4\", {\n                    children: \"Enjoy this article?\"\n                  }), /*#__PURE__*/_jsxs(\"a\", {\n                    className: `${style['single-post__thumb']} ${style['single-post__thumb--left']}`,\n                    children: [/*#__PURE__*/_jsx(\"span\", {\n                      children: likeCount\n                    }), /*#__PURE__*/_jsx(FontAwesomeIcon, {\n                      width: \"30\",\n                      height: \"30\",\n                      icon: faThumbsUp,\n                      onClick: () => handleIncrementLikes(pageContent.id)\n                    })]\n                  }), /*#__PURE__*/_jsxs(\"a\", {\n                    className: `${style['single-post__thumb']} ${style['single-post__thumb--right']}`,\n                    children: [/*#__PURE__*/_jsx(FontAwesomeIcon, {\n                      width: \"30\",\n                      height: \"30\",\n                      icon: faThumbsDown,\n                      onClick: () => handleIncrementDislikes(pageContent.id)\n                    }), /*#__PURE__*/_jsx(\"span\", {\n                      children: dislikeCount\n                    })]\n                  })]\n                }), /*#__PURE__*/_jsx(\"div\", {\n                  className: `${style['single-post__share']} d-inline-flex flex-wrap align-items-lg-center justify-content-center justify-content-lg-end`,\n                  children: /*#__PURE__*/_jsx(InlineShareButtons, {\n                    config: {\n                      alignment: 'center',\n                      // alignment of buttons (left, center, right)\n                      color: 'social',\n                      // set the color of buttons (social, white)\n                      enabled: true,\n                      // show/hide buttons (true, false)\n                      font_size: 10,\n                      // font size for the buttons\n                      labels: 'cta',\n                      // button labels (cta, counts, null)\n                      language: 'en',\n                      // which language to use (see LANGUAGES)\n                      networks: [// which networks to include (see SHARING NETWORKS)\n                      'facebook', 'twitter', 'linkedin'],\n                      padding: 12,\n                      // padding within buttons (INTEGER)\n                      radius: 0,\n                      // the corner radius on each button (INTEGER)\n                      show_total: false,\n                      size: 26 // the size of each button (INTEGER)\n\n                    }\n                  })\n                })]\n              })]\n            })\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"col-24 col-lg-6 order-1 order-lg-2\",\n            children: /*#__PURE__*/_jsx(AsideGuides, {\n              selectedCategory: category.id,\n              categoryList: categoryList,\n              popular: true,\n              popularGuides: popularGuides\n            })\n          })]\n        })\n      })\n    }), /*#__PURE__*/_jsx(PageFaqs, {\n      faqList: faqList\n    }), /*#__PURE__*/_jsx(PageUpsell, {})]\n  });\n}\nAdvicePost.layout = MainLayout;","map":null,"metadata":{},"sourceType":"module"}