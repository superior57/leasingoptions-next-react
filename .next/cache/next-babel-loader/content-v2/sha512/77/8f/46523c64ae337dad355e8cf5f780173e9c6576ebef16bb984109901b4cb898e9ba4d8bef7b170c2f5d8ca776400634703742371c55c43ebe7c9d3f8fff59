{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport React, { useState, useEffect } from 'react';\nimport Link from 'next/link';\nimport { useRouter } from 'next/router';\nimport ExpandableText from 'components/expandable-text';\nimport CardManufacturer from 'components/card/card-manufacturer';\nimport CardVehicle from 'components/card/card-vehicle';\nimport VehicleCarousel from 'components/vehicle-carousel';\nimport DropDown from 'components/layout/drop-down';\nimport Pagination from 'components/layout/pagination';\nimport Pagesize from 'components/layout/pagesize';\nimport TrustMicro from 'components/trustpilot/trust-micro';\nimport CardNews from 'components/card/card-news';\nimport { useIsMount } from 'custom-hooks/useIsMount';\nimport { VehicleTypes } from 'enums/VehicleTypes';\nimport { LeasingDealTypes } from 'enums/LeasingDealTypes';\nimport { PricingTypes } from 'enums/PricingTypes';\nimport { GetVehicleManufacturerUrl } from 'helpers/urlHelper';\nimport { MakeVanABCheck, MakeABCheck, MakeABSplit, MakeContentABCheck } from 'helpers/helpers';\nimport { TrustThemeTypes } from 'enums/TrustThemeTypes';\nimport CardWithStickers from 'components/card/card-with-stickers';\nimport { GetVehicleModelPreviews } from 'business-logic/vehicleService';\nimport ReactPlaceholder from 'react-placeholder';\nimport \"react-placeholder/lib/reactPlaceholder.css\";\n\n//TODO: check logic\nvar MakePage = function MakePage(_ref) {\n  var _vehicleFilter$manufa, _MakeABSplit, _modelPreviewsData$da, _MakeABSplit2, _MakeABSplit3, _MakeABSplit4, _categoryNews$dataIte, _categoryNews$dataIte2, _categoryNews$dataIte3;\n\n  var leasingDealType = _ref.leasingDealType,\n      vehicleType = _ref.vehicleType,\n      title = _ref.title,\n      description = _ref.description,\n      vehicleFilter = _ref.vehicleFilter,\n      modelData = _ref.modelData,\n      makeName = _ref.makeName,\n      makeUrl = _ref.makeUrl,\n      modelPreviews = _ref.modelPreviews,\n      topPicks = _ref.topPicks,\n      pricingType = _ref.pricingType,\n      userPostcode = _ref.userPostcode,\n      categoryNews = _ref.categoryNews;\n  var isMount = useIsMount();\n  var router = useRouter();\n\n  var _useState = useState(modelPreviews),\n      modelPreviewsData = _useState[0],\n      setModelPreviewsData = _useState[1];\n\n  var isATC = pricingType === PricingTypes.Atc;\n\n  var _useState2 = useState(0),\n      totalResults = _useState2[0],\n      setTotalResults = _useState2[1];\n\n  var _useState3 = useState(1),\n      pageCount = _useState3[0],\n      setPagecount = _useState3[1];\n\n  var _useState4 = useState(1),\n      currentPage = _useState4[0],\n      setCurrentPage = _useState4[1];\n\n  var _useState5 = useState(isATC ? 12 : 999),\n      resultsPerPage = _useState5[0],\n      setResultsPerPage = _useState5[1];\n\n  var _useState6 = useState(''),\n      sortBy = _useState6[0],\n      setSortBy = _useState6[1];\n\n  var _useState7 = useState(''),\n      sortDirection = _useState7[0],\n      setSortDirection = _useState7[1]; //Temp: Set news tag ID based off URL\n\n\n  var tagId = null;\n\n  switch (makeUrl === null || makeUrl === void 0 ? void 0 : makeUrl.toLocaleLowerCase()) {\n    case \"seat\":\n      tagId = 278;\n      break;\n\n    case \"skoda\":\n      tagId = 176;\n      break;\n\n    default:\n      break;\n  }\n\n  var handlePageSize = function handlePageSize(pagesize) {\n    return setResultsPerPage(pagesize);\n  };\n\n  var handlePageClick = function handlePageClick(evt, page) {\n    evt.preventDefault();\n    setCurrentPage(page);\n  };\n\n  var handleModelChange = function handleModelChange(modelUrl) {\n    return router.push(modelUrl);\n  };\n\n  var updateModelPreviews = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(sortBy, sortDirection) {\n      var paginationCriteria, sortingCriteria;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              paginationCriteria = {\n                pageSize: resultsPerPage,\n                pageIndex: currentPage\n              };\n              sortingCriteria = {\n                sortBy: sortBy,\n                sortDirection: sortDirection\n              };\n              _context.next = 4;\n              return GetVehicleModelPreviews(vehicleFilter, paginationCriteria, sortingCriteria).then(function (data) {\n                var _data$data, _data$data2;\n\n                setModelPreviewsData(data === null || data === void 0 ? void 0 : data.data);\n                setTotalResults(data === null || data === void 0 ? void 0 : (_data$data = data.data) === null || _data$data === void 0 ? void 0 : _data$data.totalItemsCount);\n                setPagecount(data === null || data === void 0 ? void 0 : (_data$data2 = data.data) === null || _data$data2 === void 0 ? void 0 : _data$data2.totalPagesCount);\n              });\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function updateModelPreviews(_x, _x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var handleSortChange = function handleSortChange(sortBy, sortDirection) {\n    setSortBy(sortBy);\n    setSortDirection(sortDirection);\n    updateModelPreviews(sortBy, sortDirection);\n  };\n\n  if (vehicleType === VehicleTypes.Commercial) {\n    leasingDealType = LeasingDealTypes.Van;\n  }\n\n  useEffect(function () {\n    updateModelPreviews(sortBy, sortDirection);\n  }, [leasingDealType, resultsPerPage, currentPage, sortBy, sortDirection]);\n  useEffect(function () {\n    if (!isMount) {\n      updateModelPreviews(sortBy, sortDirection);\n    }\n  }, [leasingDealType, resultsPerPage, currentPage, sortBy, sortDirection]);\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsxs(\"div\", {\n      className: \"container-fluid py-3 \".concat(isATC ? \"bg-atc py-md-5\" : \"pt-md-0\", \" \").concat(MakeContentABCheck(makeUrl, vehicleType) ? 'pb-md-4' : 'pb-md-5'),\n      children: [isATC && /*#__PURE__*/_jsx(\"div\", {\n        className: \"row\",\n        children: /*#__PURE__*/_jsx(\"div\", {\n          className: \"col-24 col-md-12 my-3\",\n          children: /*#__PURE__*/_jsx(TrustMicro, {\n            theme: TrustThemeTypes.Dark\n          })\n        })\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: \"row\",\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: \"\".concat(isATC ? \"col-12\" : \"col-19 col-md-12\", \" d-flex align-items-center \").concat(!MakeContentABCheck(makeUrl, vehicleType) ? 'mb-4' : ''),\n          children: /*#__PURE__*/_jsx(\"h1\", {\n            className: \"m-0\",\n            children: title\n          })\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: \"\".concat(isATC ? \"col-12\" : \"col-5 col-md-12\", \" d-flex flex-wrap align-items-center justify-content-end \").concat(!MakeContentABCheck(makeUrl, vehicleType) ? 'mb-4' : ''),\n          children: [isATC && /*#__PURE__*/_jsx(\"img\", {\n            width: \"200\",\n            \"data-src\": \"\".concat(process.env.NEXT_PUBLIC_CDN, \"/website/insured-leasing/fuel-strap-logo.svg\"),\n            className: \"img-fluid mr-md-3 lazyload\",\n            alt: \"Fuel & Go logo\"\n          }), /*#__PURE__*/_jsx(\"img\", {\n            \"data-src\": \"\".concat(process.env.NEXT_PUBLIC_CDN, \"/website/static/makes/\").concat(vehicleFilter === null || vehicleFilter === void 0 ? void 0 : (_vehicleFilter$manufa = vehicleFilter.manufacturerUrl) === null || _vehicleFilter$manufa === void 0 ? void 0 : _vehicleFilter$manufa.toLowerCase(), \".svg\"),\n            className: \"img-fluid manfacturer-logo lazyload\",\n            alt: \"\".concat(vehicleFilter === null || vehicleFilter === void 0 ? void 0 : vehicleFilter.manufacturerUrl, \" logo\")\n          })]\n        })]\n      }), !MakeContentABCheck(makeUrl, vehicleType) && /*#__PURE__*/_jsx(\"div\", {\n        className: \"row\",\n        children: /*#__PURE__*/_jsx(\"div\", {\n          className: \"col-24\",\n          children: description ? /*#__PURE__*/_jsx(ExpandableText, {\n            theme: isATC ? \"dark\" : \"light\",\n            modelDropDown: true,\n            modelDropDownData: modelData,\n            vehicleFilter: vehicleFilter,\n            leasingDealType: leasingDealType,\n            handleModelChange: handleModelChange,\n            children: MakeABCheck(makeUrl, vehicleType) ? (_MakeABSplit = MakeABSplit(makeUrl, description.toString())) === null || _MakeABSplit === void 0 ? void 0 : _MakeABSplit[0] : description\n          }) : null\n        })\n      })]\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      className: \"container-fluid \".concat(MakeVanABCheck(makeUrl, vehicleType) ? \"pt-5 pb-4 pb-md-3\" : \"py-5\", \" bg-light-grey\"),\n      children: [/*#__PURE__*/_jsxs(\"div\", {\n        className: \"row\",\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: \"col-24 col-md-18\",\n          children: /*#__PURE__*/_jsxs(\"h3\", {\n            className: \"mb-3 mb-md-5\",\n            children: [/*#__PURE__*/_jsx(\"mark\", {\n              className: \"mark-text\",\n              children: modelPreviewsData === null || modelPreviewsData === void 0 ? void 0 : modelPreviewsData.totalVehiclesCount\n            }), \" Matching Deals from \", /*#__PURE__*/_jsx(\"mark\", {\n              className: \"mark-text\",\n              children: modelPreviewsData === null || modelPreviewsData === void 0 ? void 0 : modelPreviewsData.totalItemsCount\n            }), \" Matching Models\"]\n          })\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: \"col-24 col-md-6 mb-3 mb-md-0\",\n          children: /*#__PURE__*/_jsxs(DropDown, {\n            indicator: true,\n            active: \"Default\",\n            wrapperClass: \"w-100\",\n            buttonClass: \"btn-block bg-white text-left\",\n            buttonText: \"Sort by\",\n            children: [/*#__PURE__*/_jsx(\"button\", {\n              type: \"button\",\n              className: \"text-left\",\n              onClick: function onClick() {\n                return handleSortChange('', '');\n              },\n              children: \"Default\"\n            }), /*#__PURE__*/_jsx(\"button\", {\n              type: \"button\",\n              className: \"text-left\",\n              onClick: function onClick() {\n                return handleSortChange('OrderPrice', 'DESC');\n              },\n              children: \"Price High-Low\"\n            }), /*#__PURE__*/_jsx(\"button\", {\n              type: \"button\",\n              className: \"text-left\",\n              onClick: function onClick() {\n                return handleSortChange('OrderPrice', 'ASC');\n              },\n              children: \"Price Low-High\"\n            }), /*#__PURE__*/_jsx(\"button\", {\n              type: \"button\",\n              className: \"text-left\",\n              onClick: function onClick() {\n                return handleSortChange('Seats', 'DESC');\n              },\n              children: \"Seats High-Low\"\n            }), /*#__PURE__*/_jsx(\"button\", {\n              type: \"button\",\n              className: \"text-left\",\n              onClick: function onClick() {\n                return handleSortChange('Seats', 'ASC');\n              },\n              children: \"Seats Low-High\"\n            }), /*#__PURE__*/_jsx(\"button\", {\n              type: \"button\",\n              className: \"text-left\",\n              onClick: function onClick() {\n                return handleSortChange('EngineSize', 'DESC');\n              },\n              children: \"Engine Size High-Low\"\n            }), /*#__PURE__*/_jsx(\"button\", {\n              type: \"button\",\n              className: \"text-left\",\n              onClick: function onClick() {\n                return handleSortChange('EngineSize', 'ASC');\n              },\n              children: \"Engine Size Low-High\"\n            }), /*#__PURE__*/_jsx(\"button\", {\n              type: \"button\",\n              className: \"text-left\",\n              onClick: function onClick() {\n                return handleSortChange('Mpg', 'DESC');\n              },\n              children: \"MPG High-Low\"\n            }), /*#__PURE__*/_jsx(\"button\", {\n              type: \"button\",\n              className: \"text-left\",\n              onClick: function onClick() {\n                return handleSortChange('Mpg', 'ASC');\n              },\n              children: \"MPG Low-High\"\n            }), /*#__PURE__*/_jsx(\"button\", {\n              type: \"button\",\n              className: \"text-left\",\n              onClick: function onClick() {\n                return handleSortChange('CO2', 'DESC');\n              },\n              children: \"CO2 High-Low\"\n            }), /*#__PURE__*/_jsx(\"button\", {\n              type: \"button\",\n              className: \"text-left\",\n              onClick: function onClick() {\n                return handleSortChange('CO2', 'ASC');\n              },\n              children: \"CO2 Low-High\"\n            })]\n          })\n        })]\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: \"row\",\n        children: modelPreviewsData === null || modelPreviewsData === void 0 ? void 0 : (_modelPreviewsData$da = modelPreviewsData.dataItems) === null || _modelPreviewsData$da === void 0 ? void 0 : _modelPreviewsData$da.map(function (model) {\n          var _modelPreviewsData$da2;\n\n          return /*#__PURE__*/_jsx(ReactPlaceholder, {\n            firstLaunchOnly: true,\n            className: \"col-24 col-md-12 col-lg-6 mb-3\",\n            type: \"text\",\n            showLoadingAnimation: true,\n            ready: (modelPreviewsData === null || modelPreviewsData === void 0 ? void 0 : (_modelPreviewsData$da2 = modelPreviewsData.dataItems) === null || _modelPreviewsData$da2 === void 0 ? void 0 : _modelPreviewsData$da2.length) > 0 ? true : false,\n            rows: 6,\n            children: /*#__PURE__*/_jsx(\"div\", {\n              className: \"col-24 col-md-12 col-lg-6 d-flex\",\n              children: /*#__PURE__*/_jsx(CardManufacturer, {\n                isATC: isATC,\n                userPostcode: userPostcode,\n                vehicle: model,\n                dealSelector: leasingDealType\n              })\n            }, model === null || model === void 0 ? void 0 : model.vehicleRef)\n          }, model === null || model === void 0 ? void 0 : model.vehicleRef);\n        })\n      }), isATC && /*#__PURE__*/_jsxs(\"div\", {\n        className: \"row\",\n        children: [/*#__PURE__*/_jsx(Pagesize, {\n          className: \"col-md-12 d-flex justify-content-start align-items-center my-3\",\n          increments: [12, 24, 36],\n          activePage: resultsPerPage,\n          handlePageClick: function handlePageClick(pagesize) {\n            return handlePageSize(pagesize);\n          }\n        }), /*#__PURE__*/_jsx(Pagination, {\n          className: \"col-md-12 d-flex justify-content-end align-items-center my-3\",\n          totalResults: totalResults,\n          pageCount: pageCount,\n          currentPage: currentPage,\n          handlePageClick: handlePageClick\n        })]\n      })]\n    }), MakeVanABCheck(makeUrl, vehicleType) && /*#__PURE__*/_jsx(\"div\", {\n      className: \"container-fluid pb-5 bg-light-grey\",\n      children: /*#__PURE__*/_jsx(\"div\", {\n        className: \"row\",\n        children: /*#__PURE__*/_jsx(\"div\", {\n          className: \"col-24 text-center\",\n          children: /*#__PURE__*/_jsx(Link, {\n            passHref: true,\n            href: GetVehicleManufacturerUrl(false, '', LeasingDealTypes.Van, makeUrl),\n            children: /*#__PURE__*/_jsxs(\"a\", {\n              className: \"btn btn-outline-primary btn-lg btn-fluid-xs\",\n              children: [\"View \", makeName, \" Van Lease Deals\"]\n            })\n          })\n        })\n      })\n    }), MakeABCheck(makeUrl, vehicleType) && /*#__PURE__*/_jsxs(\"div\", {\n      className: \"container-fluid py-5 bg-white\",\n      children: [/*#__PURE__*/_jsx(\"div\", {\n        className: \"row\",\n        children: /*#__PURE__*/_jsx(\"div\", {\n          className: \"col-24\",\n          children: /*#__PURE__*/_jsxs(\"h2\", {\n            className: \"mb-3 mb-md-5\",\n            children: [\"Leasing A \", makeName]\n          })\n        })\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: \"row\",\n        children: /*#__PURE__*/_jsx(\"div\", {\n          className: \"col-24\",\n          dangerouslySetInnerHTML: {\n            __html: ((_MakeABSplit2 = MakeABSplit(makeUrl, description.toString())) === null || _MakeABSplit2 === void 0 ? void 0 : _MakeABSplit2[1]) + ((_MakeABSplit3 = MakeABSplit(makeUrl, description.toString())) === null || _MakeABSplit3 === void 0 ? void 0 : _MakeABSplit3[2])\n          }\n        })\n      })]\n    }), MakeContentABCheck(makeUrl, vehicleType) && /*#__PURE__*/_jsx(\"div\", {\n      className: \"container-fluid py-5 bg-white\",\n      children: /*#__PURE__*/_jsx(\"div\", {\n        className: \"row\",\n        children: /*#__PURE__*/_jsx(\"div\", {\n          className: \"col-24\",\n          children: description ? /*#__PURE__*/_jsx(ExpandableText, {\n            theme: \"light\",\n            modelDropDown: true,\n            vehicleFilter: vehicleFilter,\n            leasingDealType: leasingDealType,\n            children: MakeABCheck(makeUrl, vehicleType) ? (_MakeABSplit4 = MakeABSplit(makeUrl, description.toString())) === null || _MakeABSplit4 === void 0 ? void 0 : _MakeABSplit4[0] : description\n          }) : null\n        })\n      })\n    }), /*#__PURE__*/_jsxs(CardWithStickers, {\n      children: [MakeContentABCheck(makeUrl, vehicleType) && (categoryNews === null || categoryNews === void 0 ? void 0 : (_categoryNews$dataIte = categoryNews.dataItems) === null || _categoryNews$dataIte === void 0 ? void 0 : _categoryNews$dataIte.length) > 0 && /*#__PURE__*/_jsx(\"section\", {\n        className: \"container-fluid py-md-5 bg-light-grey\",\n        children: /*#__PURE__*/_jsxs(\"div\", {\n          className: \"row\",\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: \"col-24\",\n            children: /*#__PURE__*/_jsxs(\"h3\", {\n              className: \"text-center mb-0 mb-md-3\",\n              children: [makeName, \" News\"]\n            })\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"col-24 mt-3 mb-5 mb-md-0\",\n            children: /*#__PURE__*/_jsx(VehicleCarousel, {\n              className: \"slick-paginated\",\n              dots: true,\n              mobileAuto: true,\n              mobileArrows: true,\n              tabletArrows: true,\n              desktopArrows: true,\n              infinite: (categoryNews === null || categoryNews === void 0 ? void 0 : (_categoryNews$dataIte2 = categoryNews.dataItems) === null || _categoryNews$dataIte2 === void 0 ? void 0 : _categoryNews$dataIte2.length) > 4,\n              children: categoryNews === null || categoryNews === void 0 ? void 0 : (_categoryNews$dataIte3 = categoryNews.dataItems) === null || _categoryNews$dataIte3 === void 0 ? void 0 : _categoryNews$dataIte3.map(function (article) {\n                return /*#__PURE__*/_jsx(CardNews, {\n                  id: \"article-\".concat(article.id),\n                  className: \"card-news--space\",\n                  image: article.imageUrl,\n                  tag: article.type,\n                  link: article.url,\n                  title: article.title,\n                  date: article.onDate,\n                  excerpt: article.description\n                }, \"article-\".concat(article.id));\n              })\n            })\n          })]\n        })\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: \"container-fluid py-5 \".concat(MakeABCheck(makeUrl, vehicleType) ? \"bg-light-grey\" : \"bg-white\"),\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: \"row\",\n          children: /*#__PURE__*/_jsx(\"div\", {\n            className: \"col-24\",\n            children: /*#__PURE__*/_jsx(\"h2\", {\n              className: \"mb-3 mb-md-5\",\n              children: \"Customers Also Viewed...\"\n            })\n          })\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: \"row\",\n          children: /*#__PURE__*/_jsx(\"div\", {\n            className: \"col-24\",\n            children: /*#__PURE__*/_jsx(VehicleCarousel, {\n              tabletArrows: true,\n              desktopArrows: true,\n              infinite: (topPicks === null || topPicks === void 0 ? void 0 : topPicks.length) > 3,\n              children: topPicks === null || topPicks === void 0 ? void 0 : topPicks.map(function (vehicle) {\n                return /*#__PURE__*/_jsx(ReactPlaceholder, {\n                  firstLaunchOnly: true,\n                  type: \"text\",\n                  showLoadingAnimation: true,\n                  ready: (topPicks === null || topPicks === void 0 ? void 0 : topPicks.length) > 0 ? true : false,\n                  rows: 6,\n                  children: /*#__PURE__*/_jsx(CardVehicle, {\n                    id: \"picked-\".concat(vehicle.vehicleRef),\n                    isATC: isATC,\n                    userPostcode: userPostcode,\n                    vehicle: vehicle,\n                    dealSelector: leasingDealType,\n                    showStickers: false\n                  }, \"featured-\".concat(vehicle.vehicleRef))\n                }, \"featured-\".concat(vehicle.vehicleRef));\n              })\n            })\n          })\n        })]\n      })]\n    })]\n  });\n};\n\nexport default MakePage;","map":null,"metadata":{},"sourceType":"module"}