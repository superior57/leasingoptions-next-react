{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React, { useState, useEffect } from 'react';\nimport Link from 'next/link';\nimport { connect } from 'react-redux';\nimport style from './header.module.scss';\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faSpinner, faSearch } from \"@fortawesome/free-solid-svg-icons\";\nimport { GetVehicleUrl } from \"helpers/urlHelper\";\nimport { LeasingDealTypes } from 'enums/LeasingDealTypes';\nimport { VehicleTypes } from 'enums/VehicleTypes';\nimport { GetSearchResults } from 'business-logic/vehicleService';\n\nconst HeaderSearch = ({\n  dealSelector,\n  isInternal\n}) => {\n  const {\n    0: leaseDealType,\n    1: setLeaseDealType\n  } = useState(dealSelector === LeasingDealTypes.Van ? LeasingDealTypes.Business : dealSelector);\n  const {\n    0: isLoading,\n    1: setIsLoading\n  } = useState(false);\n  const {\n    0: isActive,\n    1: setIsactive\n  } = useState(false);\n  const {\n    0: searchResults,\n    1: setSearchResults\n  } = useState([]);\n\n  const handleSearchInit = evt => {\n    let searchQuery = evt.target.value.toString();\n\n    if (searchQuery.length >= 2) {\n      setIsLoading(true);\n      Promise.resolve(getSearchResults(searchQuery)).then(function (data) {\n        setIsactive(true);\n        setSearchResults(data.data);\n        setIsLoading(false);\n      });\n    } else {\n      setIsactive(false);\n      setSearchResults([]);\n    }\n  };\n\n  const handleSearchBlur = () => {\n    document.body.removeEventListener('click', handleSearchClose);\n  };\n\n  const handleSearchClose = () => {\n    setIsactive(false);\n    setIsLoading(false);\n    setSearchResults([]);\n  };\n\n  async function getSearchResults(searchQuery) {\n    return await GetSearchResults(searchQuery, isInternal);\n  }\n\n  useEffect(() => {\n    setLeaseDealType(dealSelector === LeasingDealTypes.Van ? LeasingDealTypes.Personal : dealSelector);\n    setIsactive(false);\n    setSearchResults([]);\n    setIsLoading(false);\n  }, [dealSelector]);\n  useEffect(() => {\n    document.body.addEventListener('click', handleSearchClose);\n  }, []);\n  return /*#__PURE__*/_jsxs(\"div\", {\n    className: style['input-wrapper'],\n    children: [/*#__PURE__*/_jsx(\"div\", {\n      className: style['input-icon'],\n      children: /*#__PURE__*/_jsx(FontAwesomeIcon, {\n        width: \"16\",\n        height: \"16\",\n        icon: faSearch\n      })\n    }), /*#__PURE__*/_jsx(\"input\", {\n      type: \"search\",\n      placeholder: \"e.g. BMW 3 Series\",\n      onFocus: evt => {\n        handleSearchInit(evt);\n      },\n      onKeyUp: evt => {\n        handleSearchInit(evt);\n      },\n      onBlur: evt => handleSearchBlur\n    }), isLoading ? /*#__PURE__*/_jsx(FontAwesomeIcon, {\n      width: \"16\",\n      height: \"16\",\n      icon: faSpinner,\n      className: `fa-spin ${style['input-loading']}`\n    }) : \"\", /*#__PURE__*/_jsx(\"div\", {\n      className: `${style['input-list']} ${isActive ? style['is-active'] : \"\"}`,\n      children: /*#__PURE__*/_jsx(\"ul\", {\n        children: searchResults.map(result => {\n          return /*#__PURE__*/_jsx(\"li\", {\n            children: /*#__PURE__*/_jsx(Link, {\n              passHref: true,\n              href: GetVehicleUrl(false, '', result.vehicleTypeId === VehicleTypes.Commercial ? LeasingDealTypes.Van : leaseDealType, result.manufacturer, result.shortModTextUrl, result.modelUrl, result.derivativeUrl, result.vehicleRef, null, null, null, null, isInternal),\n              children: /*#__PURE__*/_jsxs(\"a\", {\n                children: [result.manufacturer, \" \", result.model, \" \", result.derivative]\n              })\n            })\n          }, `result-${result.vehicleRef}`);\n        })\n      })\n    })]\n  });\n};\n\nconst mapStateToProps = state => ({\n  isInternal: state.isInternal\n});\n\nexport default connect(mapStateToProps)(HeaderSearch);","map":null,"metadata":{},"sourceType":"module"}