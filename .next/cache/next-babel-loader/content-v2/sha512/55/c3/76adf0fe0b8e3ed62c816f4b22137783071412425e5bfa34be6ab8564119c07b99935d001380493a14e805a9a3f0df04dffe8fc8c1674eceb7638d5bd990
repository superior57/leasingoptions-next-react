{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React, { useState, useEffect } from 'react';\nimport Link from 'next/link';\nimport CardManufacturer from 'components/card/card-manufacturer';\nimport CardVehicle from 'components/card/card-vehicle';\nimport CardKey from 'components/card/card-key';\nimport VehicleCarousel from 'components/vehicle-carousel';\nimport DropDown from 'components/layout/drop-down';\nimport Pagination from 'components/layout/pagination';\nimport Pagesize from 'components/layout/pagesize';\nimport Faqs from 'components/layout/faqs';\nimport { PricingTypes } from 'enums/PricingTypes';\nimport { ContentService } from 'business-logic/contentService';\nimport CardWithStickers from 'components/card/card-with-stickers';\nimport { GetVehicleModelPreviews } from 'business-logic/vehicleService';\n\n//TODO: check logic\nconst SearchPage = ({\n  leasingDealType,\n  vehicleFilter,\n  modelPreviews,\n  topPicks,\n  pricingType,\n  userPostcode\n}) => {\n  var _modelPreviewsData$da;\n\n  const isATC = pricingType === PricingTypes.Atc;\n  const {\n    0: totalResults,\n    1: setTotalResults\n  } = useState(0);\n  const {\n    0: pageCount,\n    1: setPagecount\n  } = useState(1);\n  const {\n    0: currentPage,\n    1: setCurrentPage\n  } = useState(1);\n  const {\n    0: resultsPerPage,\n    1: setResultsPerPage\n  } = useState(isATC ? 11 : 9999);\n  const {\n    0: sortBy,\n    1: setSortBy\n  } = useState('OrderPrice');\n  const {\n    0: sortDirection,\n    1: setSortDirection\n  } = useState('ASC');\n  const {\n    0: modelPreviewsData,\n    1: setModelPreviewsData\n  } = useState(modelPreviews);\n  const {\n    0: pageFaqs,\n    1: setPageFaqs\n  } = useState();\n  useEffect(() => {\n    Promise.resolve(getPageFaqs()).then(function (data) {\n      setPageFaqs(data.data);\n    });\n  }, []);\n  useEffect(() => {\n    Promise.resolve(filterModelPreviews(sortBy, sortDirection, currentPage, resultsPerPage)).then(function (data) {\n      setModelPreviewsData(data.data);\n      setTotalResults(data.data.totalItemsCount);\n      setPagecount(data.data.totalPagesCount + 1);\n    });\n  }, [userPostcode, leasingDealType, vehicleFilter, sortBy, sortDirection, currentPage, resultsPerPage]);\n\n  const handlePageSize = pagesize => setResultsPerPage(pagesize);\n\n  const handlePageClick = (evt, page) => {\n    evt.preventDefault();\n    setCurrentPage(page);\n  };\n\n  const handleSortChange = (sortBy, sortDirection) => {\n    setSortBy(sortBy);\n    setSortDirection(sortDirection);\n    Promise.resolve(filterModelPreviews(sortBy, sortDirection, currentPage, resultsPerPage)).then(function (data) {\n      setModelPreviewsData(data.data);\n      setTotalResults(data.data.totalItemsCount);\n      setPagecount(data.data.totalPagesCount + 1);\n    });\n  };\n\n  const filterModelPreviews = async (sortBy, sortDirection, currentPage, resultsPerPage) => {\n    const sortingCriteria = {\n      sortBy: sortBy,\n      sortDirection: sortDirection\n    };\n    const paginationCriteria = {\n      pageSize: resultsPerPage,\n      pageIndex: currentPage\n    };\n    return await GetVehicleModelPreviews(vehicleFilter, paginationCriteria, sortingCriteria);\n  };\n\n  const getPageFaqs = async () => {\n    return await ContentService.GetFaqList(12);\n  };\n\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsxs(\"section\", {\n      className: isATC ? \"bt-atc--models\" : \"\",\n      children: [/*#__PURE__*/_jsx(\"div\", {\n        className: `container-fluid pt-5 pb-3 ${isATC ? \"pb-md-0\" : \"\"}`,\n        children: /*#__PURE__*/_jsxs(\"div\", {\n          className: \"row\",\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: `col-24 ${isATC ? \"col-12 col-md-18 col-lg-20\" : \"\"} d-flex align-items-center mb-md-4`,\n            children: /*#__PURE__*/_jsx(\"h1\", {\n              className: `${isATC ? \"text-white\" : \"\"} m-0`,\n              children: isATC ? \"Insured Car Leasing Results\" : \"Search Results\"\n            })\n          }), isATC && /*#__PURE__*/_jsx(\"div\", {\n            className: \"col-12 col-md-6 col-lg-4 d-none d-md-flex justify-content-end align-items-center mb-4\",\n            children: /*#__PURE__*/_jsx(\"img\", {\n              \"data-src\": `${process.env.NEXT_PUBLIC_CDN}/website/insured-leasing/fuel-logo-wht.svg`,\n              className: \"img-fluid lazyload\",\n              alt: \"Fuel & Go logo\"\n            })\n          })]\n        })\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: `container-fluid pb-3 ${isATC ? \"pb-md-5\" : \"py-md-5 bg-light-grey\"}`,\n        children: [/*#__PURE__*/_jsxs(\"div\", {\n          className: \"row\",\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: \"col-24 col-md-18\",\n            children: isATC ? /*#__PURE__*/_jsxs(\"h3\", {\n              className: \"text-white mb-3 mb-md-5\",\n              children: [/*#__PURE__*/_jsx(\"mark\", {\n                className: \"text-white bg-transparent px-0\",\n                children: modelPreviewsData === null || modelPreviewsData === void 0 ? void 0 : modelPreviewsData.totalVehiclesCount\n              }), \" Fuel & Go deals found\"]\n            }) : /*#__PURE__*/_jsxs(\"h3\", {\n              className: \"mb-3 mb-md-5\",\n              children: [/*#__PURE__*/_jsx(\"mark\", {\n                className: \"mark-text\",\n                children: modelPreviewsData === null || modelPreviewsData === void 0 ? void 0 : modelPreviewsData.totalVehiclesCount\n              }), \" Matching Deals from \", /*#__PURE__*/_jsx(\"mark\", {\n                className: \"mark-text\",\n                children: modelPreviewsData === null || modelPreviewsData === void 0 ? void 0 : modelPreviewsData.totalItemsCount\n              }), \" Matching Models\"]\n            })\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"col-24 col-md-6 mb-5 mb-md-0\",\n            children: /*#__PURE__*/_jsxs(DropDown, {\n              indicator: true,\n              active: \"Price Low-High\",\n              wrapperClass: \"w-100 dd-list\",\n              buttonClass: `btn-block ${isATC ? \"text-white border-white\" : \"bg-white\"} text-left`,\n              buttonText: \"Sort by\",\n              children: [/*#__PURE__*/_jsx(\"button\", {\n                type: \"button\",\n                className: \"text-left\",\n                onClick: () => handleSortChange('OrderPrice', 'DESC'),\n                children: \"Price High-Low\"\n              }), /*#__PURE__*/_jsx(\"button\", {\n                type: \"button\",\n                className: \"text-left\",\n                onClick: () => handleSortChange('OrderPrice', 'ASC'),\n                children: \"Price Low-High\"\n              }), /*#__PURE__*/_jsx(\"button\", {\n                type: \"button\",\n                className: \"text-left\",\n                onClick: () => handleSortChange('Seats', 'DESC'),\n                children: \"Seats High-Low\"\n              }), /*#__PURE__*/_jsx(\"button\", {\n                type: \"button\",\n                className: \"text-left\",\n                onClick: () => handleSortChange('Seats', 'ASC'),\n                children: \"Seats Low-High\"\n              }), /*#__PURE__*/_jsx(\"button\", {\n                type: \"button\",\n                className: \"text-left\",\n                onClick: () => handleSortChange('EngineSize', 'DESC'),\n                children: \"Engine Size High-Low\"\n              }), /*#__PURE__*/_jsx(\"button\", {\n                type: \"button\",\n                className: \"text-left\",\n                onClick: () => handleSortChange('EngineSize', 'ASC'),\n                children: \"Engine Size Low-High\"\n              }), /*#__PURE__*/_jsx(\"button\", {\n                type: \"button\",\n                className: \"text-left\",\n                onClick: () => handleSortChange('Mpg', 'DESC'),\n                children: \"MPG High-Low\"\n              }), /*#__PURE__*/_jsx(\"button\", {\n                type: \"button\",\n                className: \"text-left\",\n                onClick: () => handleSortChange('Mpg', 'ASC'),\n                children: \"MPG Low-High\"\n              }), /*#__PURE__*/_jsx(\"button\", {\n                type: \"button\",\n                className: \"text-left\",\n                onClick: () => handleSortChange('CO2', 'DESC'),\n                children: \"CO2 High-Low\"\n              }), /*#__PURE__*/_jsx(\"button\", {\n                type: \"button\",\n                className: \"text-left\",\n                onClick: () => handleSortChange('CO2', 'ASC'),\n                children: \"CO2 Low-High\"\n              })]\n            })\n          })]\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: \"row\",\n          children: modelPreviewsData === null || modelPreviewsData === void 0 ? void 0 : (_modelPreviewsData$da = modelPreviewsData.dataItems) === null || _modelPreviewsData$da === void 0 ? void 0 : _modelPreviewsData$da.map((model, index) => {\n            if (isATC && index === 3) {\n              return /*#__PURE__*/_jsxs(_Fragment, {\n                children: [/*#__PURE__*/_jsx(\"div\", {\n                  className: \"col-24 col-md-12 col-lg-6 d-flex order-first-sml\",\n                  children: /*#__PURE__*/_jsx(CardKey, {})\n                }, \"atc-key\"), /*#__PURE__*/_jsx(\"div\", {\n                  className: \"col-24 col-md-12 col-lg-6 d-flex\",\n                  children: /*#__PURE__*/_jsx(CardManufacturer, {\n                    isATC: isATC,\n                    userPostcode: userPostcode,\n                    vehicle: model,\n                    dealSelector: leasingDealType\n                  })\n                }, index + '-' + model.vehicleRef)]\n              });\n            } else {\n              return /*#__PURE__*/_jsx(\"div\", {\n                className: \"col-24 col-md-12 col-lg-6 d-flex\",\n                children: /*#__PURE__*/_jsx(CardManufacturer, {\n                  isATC: isATC,\n                  userPostcode: userPostcode,\n                  vehicle: model,\n                  dealSelector: leasingDealType\n                })\n              }, index + '-' + model.vehicleRef);\n            }\n          })\n        }), isATC && /*#__PURE__*/_jsxs(_Fragment, {\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: \"row\",\n            children: /*#__PURE__*/_jsx(\"div\", {\n              className: \"col-24 text-center py-3 py-md-4\",\n              children: /*#__PURE__*/_jsx(Link, {\n                passHref: true,\n                href: \"/car-leasing-with-insurance\",\n                children: /*#__PURE__*/_jsx(\"a\", {\n                  className: \"btn btn-outline-light btn-lg\",\n                  children: \"Fuel & Go Home\"\n                })\n              })\n            })\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: \"row\",\n            children: [/*#__PURE__*/_jsx(Pagesize, {\n              className: \"col-md-12 d-flex justify-content-start align-items-center my-3\",\n              increments: isATC ? [11, 23, 35] : [12, 24, 36],\n              activePage: resultsPerPage,\n              handlePageClick: pagesize => handlePageSize(pagesize)\n            }), /*#__PURE__*/_jsx(Pagination, {\n              className: \"col-md-12 d-flex justify-content-end align-items-center my-3\",\n              totalResults: totalResults,\n              pageCount: pageCount,\n              currentPage: currentPage,\n              handlePageClick: handlePageClick\n            })]\n          })]\n        })]\n      })]\n    }), isATC && pageFaqs && /*#__PURE__*/_jsx(Faqs, {\n      title: \"Fuel & Go Leasing FAQs\",\n      className: \"bg-light-grey\",\n      faqs: pageFaqs,\n      children: /*#__PURE__*/_jsx(\"div\", {\n        className: \"row\",\n        children: /*#__PURE__*/_jsx(\"div\", {\n          className: \"col-24\",\n          children: /*#__PURE__*/_jsx(Link, {\n            passHref: true,\n            href: \"/car-leasing-faqs\",\n            children: /*#__PURE__*/_jsx(\"a\", {\n              className: \"btn btn-outline-primary btn-lg\",\n              children: \"See all Fuel & Go FAQs\"\n            })\n          })\n        })\n      })\n    }), topPicks && /*#__PURE__*/_jsxs(\"section\", {\n      className: \"container-fluid py-3 py-md-5 bg-white\",\n      children: [/*#__PURE__*/_jsx(\"div\", {\n        className: \"row\",\n        children: /*#__PURE__*/_jsx(\"div\", {\n          className: \"col-24\",\n          children: /*#__PURE__*/_jsx(\"h2\", {\n            className: \"mb-3 mb-md-5\",\n            children: \"Customers Also Viewed...\"\n          })\n        })\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: \"row\",\n        children: /*#__PURE__*/_jsx(\"div\", {\n          className: \"col-24\",\n          children: /*#__PURE__*/_jsx(CardWithStickers, {\n            children: /*#__PURE__*/_jsx(VehicleCarousel, {\n              tabletArrows: true,\n              desktopArrows: true,\n              infinite: (topPicks === null || topPicks === void 0 ? void 0 : topPicks.length) > 3,\n              children: topPicks.map(vehicle => /*#__PURE__*/_jsx(CardVehicle, {\n                id: `picked-${vehicle.vehicleRef}`,\n                isATC: isATC,\n                userPostcode: userPostcode,\n                vehicle: vehicle,\n                dealSelector: leasingDealType,\n                showStickers: false\n              }, `featured-${vehicle.vehicleRef}`))\n            })\n          })\n        })\n      })]\n    })]\n  });\n};\n\nexport default SearchPage;","map":null,"metadata":{},"sourceType":"module"}