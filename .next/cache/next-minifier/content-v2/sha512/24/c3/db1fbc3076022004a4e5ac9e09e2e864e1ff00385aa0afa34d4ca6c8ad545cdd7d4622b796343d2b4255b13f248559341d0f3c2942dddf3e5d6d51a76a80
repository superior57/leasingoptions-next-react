{"code":"(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[33],{\"/kJK\":function(e,t,n){\"use strict\";n.d(t,\"a\",(function(){return s}));var i=n(\"H+61\"),o=n(\"UlJF\"),r=n(\"cpVT\"),a=n(\"xG9w\"),s=function(){function e(){Object(i.a)(this,e)}return Object(o.a)(e,null,[{key:\"getRelationshipDescription\",value:function(e){var t=null;if(e)switch(e.toUpperCase()){case\"OO\":t=\"From the options below, a maximum of one may be selected. For example, you can only have one type of paintwork.\";break;case\"RO\":t=\"The option you have chosen must be accompanied by at least one of the additional options in the group below.\";break;case\"RA\":t=\"The option you have chosen must be accompanied by all of the additional options in the group below.\";break;case\"NW\":t=\"The option you have chosen cannot be accompanied by any of the options in the group below. For example if wood inlay is chosen it cannot be accompanied by any cloth trim.\";break;case\"IN\":t=\"Please note the options below are included (at no extra cost) with the option you have chosen which comes as a pack.\";break;case\"IO\":t=\"The option you have chosen must be accompanied by one option from the group below. The additional option will be no extra cost.\"}return t||e}},{key:\"getSelectedOptions\",value:function(e,t){var n=[];return e&&e.length>0&&t&&t.length>0&&(n=a.a.filter(e,(function(e){return a.a.contains(t,e.id)}))),n}},{key:\"getOptionsPrice\",value:function(e,t){var n=0;if(e){var i=this;e.forEach((function(e){n+=i.getOptionPrice(e,t)}))}return n}},{key:\"getOptionPrice\",value:function(e,t){var n=0;if(e){var i=this._getOptionState(t,e.id);n=this._getOptionPrice(e,i)}return n}},{key:\"getOptionsStates\",value:function(e,t){var n=[];e&&t&&this.getRelationships(t,e).forEach((function(t){var i=t.primaryOptionIds,o=t.regularOptionIds;if(\"OO\"===t.type||a.a.intersection(i,e).length===i.length)if(\"OO\"==t.type)a.a.difference(o,e).forEach((function(e){var t=a.a.find(n,(function(t){return t.id===e}));t||(t={id:e,selectionRequiredBy:[],deselectionRequiredBy:[]},n.push(t)),t.deselectionRequiredBy=a.a.union(t.deselectionRequiredBy,[-1])}));else if(\"RA\"==t.type||\"IN\"==t.type){var r=t.mirrorRelationshipIds&&t.mirrorRelationshipIds.length>0;o.forEach((function(e){var i=a.a.find(n,(function(t){return t.id===e}));i||(i={id:e,selectionRequiredBy:[],deselectionRequiredBy:[],mirrorIn:[]},n.push(i)),i.selectionRequiredBy=a.a.union(i.selectionRequiredBy,[t.id]),i.useZeroPrice=i.useZeroPrice||\"IN\"===t.type,r&&(i.mirrorIn=a.a.union(i.mirrorIn,[t.id],t.mirrorRelationshipIds))}))}}));return n}},{key:\"cloneOptionsStates\",value:function(e){return a.a.map(e,(function(e){return{id:e.id,selectionRequiredBy:a.a.clone(e.selectionRequiredBy),deselectionRequiredBy:a.a.clone(e.deselectionRequiredBy),mirrorIn:a.a.clone(e.mirrorIn),useZeroPrice:e.useZeroPrice}}))}},{key:\"getOptionsWithoutRelationships\",value:function(e,t){var n=[];return t&&t.length>0&&(n=a.a.filter(e||[],(function(e){return e&&a.a.contains(t,e.id)&&(!e.linkedRelationshipIds||0===e.linkedRelationshipIds.length)}))),n}},{key:\"getRelationships\",value:function(e,t){var n=[],i=this.allowedRelationshipTypes;return t&&t.length>0&&(n=a.a.filter(e||[],(function(e){return e&&a.a.contains(i,e.type)&&(a.a.intersection(t,e.primaryOptionIds).length>0||a.a.intersection(t,e.regularOptionIds).length>0)}))),n}},{key:\"getConfirmRelationship\",value:function(e,t,n,i,o){var r=null;if(e&&e.length>0){var s=this._getRelationship(e,n);if(s){r={id:s.id,type:s.type,options:[]};var c=this._getRelationshipOptions(s,t,!0,i,o),l=this._getRelationshipOptions(s,t,!1,i,o);r.options=a.a.union(r.options,c),r.options=a.a.union(r.options,l)}}return r}},{key:\"splitOptionIdsByAction\",value:function(e){var t={selectIds:[],deselectIds:[]};return e&&e.length>0&&(t.selectIds=a.a.pluck(a.a.filter(e,(function(e){return e.selectionRequiredBy.length>0})),\"id\"),t.deselectIds=a.a.pluck(a.a.filter(e,(function(e){return e.deselectionRequiredBy.length>0})),\"id\")),t}},{key:\"getOptionAction\",value:function(e,t){var n=null;if(e&&!e.isDisabled){var i=e.id,o=!a.a.contains(t||[],i);n={id:i,selectionRequiredBy:o?[0]:[],deselectionRequiredBy:o?[]:[0]}}return n}},{key:\"optionExists\",value:function(e,t){return!!this._getOption(t,e)}},{key:\"_getRelationshipOptions\",value:function(e,t,n,i,o){var r=[];if(null!==e&&null!=t&&t.length>0){var s=this;((n?e.primaryOptionIds:e.regularOptionIds)||[]).forEach((function(e){var c=s._getOption(t,e);if(c){var l=s._getOptionState(o,c.id),u={id:c.id,name:c.name,isPrimary:n,price:s._getOptionPrice(c,l),isSelected:a.a.contains(i||[],c.id),isDisabled:!1};r.push(u)}})),r=a.a.sortBy(r,\"name\")}return r}},{key:\"_getOptionPrice\",value:function(e,t){var n=0;return e&&(n=t&&t.useZeroPrice?0:e.price),n}},{key:\"_getOptionState\",value:function(e,t){return a.a.find(e,(function(e){return e&&e.id===t}))}},{key:\"_getOption\",value:function(e,t){return a.a.find(e,(function(e){return e&&e.id===t}))}},{key:\"_getRelationship\",value:function(e,t){return a.a.find(e,(function(e){return e&&e.id===t}))}}]),e}();Object(r.a)(s,\"allowedRelationshipTypes\",[\"OO\",\"RO\",\"RA\",\"NW\",\"IN\",\"IO\"])},CTce:function(e,t,n){\"use strict\";n.d(t,\"a\",(function(){return c}));var i=n(\"H+61\"),o=n(\"UlJF\"),r=n(\"cpVT\"),a=n(\"xG9w\"),s=n(\"/kJK\"),c=function(){function e(){Object(i.a)(this,e),Object(r.a)(this,\"_vehicleOptions\",[]),Object(r.a)(this,\"_vehicleOptionRelationships\",[]),Object(r.a)(this,\"_selectedOptionIds\",[]),Object(r.a)(this,\"_confirmRelationshipIds\",[]),Object(r.a)(this,\"_optionsStates\",[])}return Object(o.a)(e,[{key:\"_clearMangerState\",value:function(){this._confirmRelationshipIds=[],this._selectedOptionIds=[],this._optionsStates=[]}},{key:\"init\",value:function(e,t){this._vehicleOptions=e||[],this._vehicleOptionRelationships=t||[],this._clearMangerState()}},{key:\"processOptions\",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this._clearMangerState(),this._selectedOptionIds=a.a.clone(n||[]),this._confirmRelationshipIds=a.a.clone(t||[]),this._optionsStates=s.a.cloneOptionsStates(i||[]);var o=null;if(e&&e.length>0){var r=a.a.clone(this._selectedOptionIds),c=s.a.splitOptionIdsByAction(e);if(a.a.intersection(c.selectIds,c.deselectIds).length>0)return alert(\"Action is not allowed.\"),null;var l=a.a.pluck(s.a.getOptionsWithoutRelationships(this._vehicleOptions,c.selectIds),\"id\"),u=a.a.pluck(s.a.getOptionsWithoutRelationships(this._vehicleOptions,c.deselectIds),\"id\"),d=a.a.union(l,u);d.length>0&&(r=a.a.union(r,l),r=a.a.difference(r,u),this._selectedOptionIds=a.a.clone(r),o=a.a.clone(r));var p=a.a.filter(e,(function(e){return!a.a.contains(d,e.id)}));if(null!=p&&p.length>0){var f=this._getConfirmDetails(p,r,this._confirmRelationshipIds,this._optionsStates);if(f.hasConflicts)return alert(\"Action is not allowed.\"),null;var h=a.a.filter(p,(function(e){return!a.a.some(f.confirmRelationships,(function(t){return a.a.contains(t.optionIds,e.id)}))}));h.length>0&&(o=a.a.clone(this._selectedOptionIds),c=s.a.splitOptionIdsByAction(h),o=a.a.union(o,c.selectIds),o=a.a.difference(o,c.deselectIds)),this._selectedOptionIds=f.selectedOptionIds,this._confirmRelationshipIds=a.a.pluck(f.confirmRelationships,\"id\"),this._optionsStates=f.optionsStates}}var g={selectedOptionIds:a.a.clone(this._selectedOptionIds),confirmRelationshipIds:a.a.clone(this._confirmRelationshipIds),optionsStates:a.a.clone(this._optionsStates),silentlySelectedOptionIds:o};return g}},{key:\"_getConfirmDetails\",value:function(e,t,n,i){var o=this,r={hasConflicts:!1,selectedOptionIds:[],confirmRelationships:[],optionsStates:[]};return e&&e.length>0&&function(){for(var c=a.a.clone(t||[]),l=a.a.clone(n||[]),u=s.a.cloneOptionsStates(i||[]),d=a.a.clone(e),p=o._getConfirmDetailsIteration(d,c,u);p;){if(p.hasConflicts){r.hasConflicts=!0;break}d.forEach((function(e){var t=a.a.find(u,(function(t){return t.id===e.id}));t||(t={id:e.id,selectionRequiredBy:[],deselectionRequiredBy:[],mirrorIn:[]},u.push(t)),t.selectionRequiredBy=a.a.union(t.selectionRequiredBy,a.a.difference(e.selectionRequiredBy,[-1])),t.deselectionRequiredBy=a.a.union(t.deselectionRequiredBy,a.a.difference(e.deselectionRequiredBy,[-1])),t.mirrorIn=a.a.union(t.mirrorIn,e.mirrorIn)})),p.recallRestrictionRelationshipIds&&u.forEach((function(e){e.selectionRequiredBy=a.a.difference(e.selectionRequiredBy,p.recallRestrictionRelationshipIds),e.deselectionRequiredBy=a.a.difference(e.deselectionRequiredBy,p.recallRestrictionRelationshipIds)}));var f=a.a.pluck(a.a.filter(d,(function(e){return e.selectionRequiredBy.length>0})),\"id\"),h=a.a.pluck(a.a.filter(d,(function(e){return e.deselectionRequiredBy.length>0})),\"id\");c=a.a.difference(a.a.union(c,f),h),l=a.a.union(l,p.confirmRelationshipIds),d=p.nextIterationOptions,p=o._getConfirmDetailsIteration(d,c,u)}if(!r.hasConflicts){var g=o,y=u,m=c,O=[];l.forEach((function(e){var t=a.a.find(g._vehicleOptionRelationships,(function(t){return t&&t.id===e}));if(t){var n=[];n=a.a.union(n,t.primaryOptionIds),n=a.a.union(n,t.regularOptionIds),(n=a.a.filter(n,(function(e){return s.a.optionExists(e,g._vehicleOptions)}))).length>0&&O.push({id:e,optionIds:n})}}));var v=a.a.filter(O,(function(e){return 0==a.a.intersection(e.optionIds,m).length}));O.length>v.length&&(O=a.a.filter(O,(function(e){return a.a.intersection(e.optionIds,m).length>0})));var I=[],b=a.a.filter(o._vehicleOptionRelationships,(function(e){return e&&a.a.contains(s.a.allowedRelationshipTypes,e.type)&&\"IN\"===e.type&&a.a.intersection(m,e.primaryOptionIds).length===e.primaryOptionIds.length}));b&&b.length>0&&b.forEach((function(e){I=a.a.union(I,e.regularOptionIds)})),y.forEach((function(e){e.useZeroPrice=a.a.contains(I,e.id),e.selectionRequiredBy=a.a.without(e.selectionRequiredBy,0),e.deselectionRequiredBy=a.a.without(e.deselectionRequiredBy,0)})),r.optionsStates=y,r.selectedOptionIds=m,r.confirmRelationships=O}}(),r}},{key:\"_getConfirmDetailsIteration\",value:function(e,t,n){var i=this;if(e&&e.length>0){var o=function(){var o=!1,r=[],c=[],l=[],u=s.a.splitOptionIdsByAction(e);if(!(o=a.a.intersection(u.selectIds,u.deselectIds).length>0)){var d=a.a.difference(u.selectIds,t),p=a.a.intersection(u.deselectIds,t),f=a.a.difference(a.a.union(t,d),p),h=s.a.getRelationships(i._vehicleOptionRelationships,a.a.union(d,p));if(h&&h.length>0)for(var g=function(e){var i=h[e],s=i.primaryOptionIds,u=i.regularOptionIds,g=a.a.union(s,u),y=a.a.intersection(g,d),m=a.a.intersection(g,p);if(y.length>0&&m.length>0);else if(y.length>0){if(!(\"OO\"===i.type||a.a.intersection(s,f).length===s.length))return\"continue\";for(var O=function(e){var t=y[0],r=a.a.find(n,(function(e){return e.id===t}));if(r&&a.a.difference(r.deselectionRequiredBy,[i.id,-1]).length>0)return o=!0,\"break\"},v=0;v<y.length;v++){if(\"break\"===O())break}if(o)return\"break\";if(\"OO\"==i.type){if(y.length>1)return o=!0,\"break\";a.a.find(n,(function(e){return e.id===y[0]}));a.a.difference(u,y).forEach((function(e){var t=a.a.find(c,(function(t){return t.id===e}));t||(t={id:e,selectionRequiredBy:[],deselectionRequiredBy:[]},c.push(t)),t.deselectionRequiredBy=a.a.union(t.deselectionRequiredBy,[-1])}))}else if(\"RA\"==i.type||\"IN\"==i.type){var I=i.mirrorRelationshipIds&&i.mirrorRelationshipIds.length>0;u.forEach((function(e){var t=a.a.find(c,(function(t){return t.id===e}));t||(t={id:e,selectionRequiredBy:[],deselectionRequiredBy:[],mirrorIn:[]},c.push(t)),t.selectionRequiredBy=a.a.union(t.selectionRequiredBy,[i.id]),I&&(t.mirrorIn=a.a.union(t.mirrorIn,[i.id],i.mirrorRelationshipIds))}))}r=a.a.union(r,[i.id])}else if(m.length>0){for(var b=function(e){var t=m[e],i=a.a.find(n,(function(e){return e.id===t}));if(i&&a.a.difference(i.selectionRequiredBy,i.mirrorIn).length>0)return o=!0,\"break\"},R=0;R<m.length;R++){if(\"break\"===b(R))break}if(o)return\"break\";if(\"OO\"==i.type)0==a.a.intersection(f,g).length&&l.push(i.id),r=a.a.union(r,[i.id]);else if(\"RA\"==i.type||\"IN\"==i.type){i.mirrorRelationshipIds&&i.mirrorRelationshipIds.length>0&&a.a.difference(g,m).forEach((function(e){var t=a.a.find(c,(function(t){return t.id===e}));t||(t={id:e,selectionRequiredBy:[],deselectionRequiredBy:[],mirrorIn:[]},c.push(t)),t.deselectionRequiredBy=a.a.union(t.deselectionRequiredBy,[0])})),a.a.intersection(s,f).length!==s.length&&l.push(i.id),a.a.intersection(s,t).length===s.length&&(r=a.a.union(r,[i.id]))}}},y=0;y<h.length;y++){var m=g(y);if(\"continue\"!==m&&\"break\"===m)break}}return{v:{hasConflicts:o,confirmRelationshipIds:o?[]:r,nextIterationOptions:o?[]:c,recallRestrictionRelationshipIds:o?[]:l}}}();if(\"object\"===typeof o)return o.v}return null}}]),e}()},Ezyo:function(e,t,n){\"use strict\";n.d(t,\"a\",(function(){return o}));var i=n(\"l7ai\"),o=function(e,t,n,o){var r=null;return t&&t>0&&(r=(t=e===i.a.Personal?1.2*t:t)/(12*n-1+o)),r||0}},FK8X:function(e,t,n){\"use strict\";n.d(t,\"a\",(function(){return c}));var i=n(\"H+61\"),o=n(\"UlJF\"),r=n(\"G6YE\"),a=n(\"Kj82\"),s=n(\"mmV+\"),c=function(){function e(){Object(i.a)(this,e)}return Object(o.a)(e,null,[{key:\"getTriggerMaxSize\",value:function(e){switch(e){case r.a.History:return 4;default:return null}}},{key:\"getStorageMaxSize\",value:function(e){switch(e){case r.a.Garage:return 4;case r.a.History:return 20;default:return null}}},{key:\"getStorageName\",value:function(e){switch(e){case r.a.Garage:return\"garage\";case r.a.History:return\"history\";default:return null}}},{key:\"getItems\",value:function(e){var t=null,n=this.getStorageName(e);Object(a.c)(n)||(t=JSON.parse(localStorage.getItem(n))),t||(t=[]);var i=this.getStorageMaxSize(e);if(t.length<i)for(var o=i-t.length,r=0;r<o;r++)t.push(null);return t}},{key:\"getItem\",value:function(e,t){return this.getItems(e).find((function(e){return e&&e.id===t}))}},{key:\"addItem\",value:function(e,t,n){var i=!1,o=this.getItems(e),r=this.getStorageMaxSize(e),a=!Object(s.u)(n);return(!a&&o.length<r||a&&n>=0&&n<r)&&(a?o[n]=t:o.push(t),i=this.persistItems(e,o)),i}},{key:\"updateItem\",value:function(e,t){var n=!1,i=this.getItems(e),o=i.find((function(e){return e&&e.id===t.id&&e.index===t.index}));return o&&(i[i.indexOf(o)]=t,n=this.persistItems(e,i)),n}},{key:\"removeItem\",value:function(e,t){var n=!1,i=this.getItems(e),o=i.find((function(e){return e&&e.id===t}));return o&&(i[i.indexOf(o)]=null,n=this.persistItems(e,i)),n}},{key:\"clear\",value:function(e){var t=this.getStorageName(e);return!Object(a.c)(t)&&(localStorage.removeItem(t),!0)}},{key:\"persistItems\",value:function(e,t){var n=this.getStorageName(e);return!Object(a.c)(n)&&(localStorage.setItem(n,JSON.stringify(t)),!0)}}]),e}()},G6YE:function(e,t,n){\"use strict\";var i;n.d(t,\"a\",(function(){return i})),function(e){e[e.None=0]=\"None\",e[e.Garage=1]=\"Garage\",e[e.History=2]=\"History\"}(i||(i={}))},TovF:function(e,t,n){\"use strict\";n.d(t,\"a\",(function(){return a}));var i=n(\"nKUr\"),o=(n(\"q1tI\"),n(\"dDCJ\")),r=n(\"9vsu\"),a=function(e){var t=e.id,n=e.trigger,a=e.title,s=e.body;return Object(i.jsx)(o.a,{trigger:\"click\",placement:\"top\",overlay:Object(i.jsxs)(r.a,{id:\"popover-positioned-\".concat(t),children:[a?Object(i.jsx)(r.a.Title,{children:a}):\"\",Object(i.jsx)(r.a.Content,{children:s})]}),children:n},t)}},\"Wj+e\":function(e,t,n){\"use strict\";n.d(t,\"a\",(function(){return g}));var i=n(\"cpVT\"),o=n(\"nKUr\"),r=n(\"dhJC\"),a=n(\"q1tI\"),s=n(\"zM5D\"),c=n(\"mmV+\"),l=n(\"oszm\"),u=n(\"/kJK\"),d=n(\"CTce\"),p=function(e){var t=e.options,n=e.relationships,i=e.leasingDealType,r=e.state,s=e.settings,p=Object(c.h)(i),f=Object(a.useState)([]),h=f[0],g=f[1];if(Object(a.useEffect)((function(){var e=[];r.confirmRelationshipIds&&r.confirmRelationshipIds.length>0&&r.confirmRelationshipIds.forEach((function(i){var o=u.a.getConfirmRelationship(n,t,i,r.selectedOptionIds,r.optionsStates);o&&e.push(o)})),g(e)}),[r]),h.length>0){var y=u.a.getOptionsPrice(u.a.getSelectedOptions(t,r.selectedOptionIds),r.optionsStates);return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)(\"div\",{className:\"options-box\",children:h.map((function(e){return Object(o.jsxs)(\"div\",{className:\"rule-item\",children:[Object(o.jsx)(\"p\",{className:\"my-3\",children:Object(o.jsx)(\"strong\",{className:\"text-center\",children:u.a.getRelationshipDescription(e.type)})}),Object(o.jsx)(\"div\",{children:e.options.map((function(e){return Object(o.jsxs)(\"div\",{className:\"row\",children:[Object(o.jsxs)(\"div\",{className:\"col-16 col-md-20 d-flex flex-row flex-wrap align-items-center my-2\",children:[e.isPrimary?Object(o.jsx)(\"img\",{className:\"lazyload mr-2\",height:\"13\",alt:\"Primary icon\",\"data-src\":\"\".concat(\"https://imagecdn.leasingoptions.co.uk\",\"/website/icon-primary.png\")}):\"\",\" \",e.name]}),Object(o.jsxs)(\"div\",{className:\"col-8 col-md-4 d-flex justify-content-end align-items-center\",children:[Object(l.a)(e.price),\" \",Object(o.jsx)(\"span\",{className:\"vehicle-option__indicator \".concat(e.isSelected?\"is-active\":\"\",\" \").concat(e.isDisabled?\"is-disabled\":\"\"),onClick:function(){return function(e){var i=u.a.getOptionAction(e,r.selectedOptionIds);if(i){var o=[i],a=new d.a;a.init(t,n);var c=a.processOptions(o,r.confirmRelationshipIds,r.selectedOptionIds,r.optionsStates);c&&s.onStateChanged&&s.onStateChanged({confirmRelationshipIds:c.confirmRelationshipIds,selectedOptionIds:c.selectedOptionIds,optionsStates:c.optionsStates})}}(e)}})]})]},\"option-\".concat(e.id))}))})]},\"rule-\".concat(e.id))}))}),Object(o.jsx)(\"div\",{className:\"options-pricing\",children:Object(o.jsxs)(\"div\",{className:\"row\",children:[Object(o.jsx)(\"div\",{className:\"col-16 col-md-19 d-flex flex-row flex-wrap my-2\",children:\"Total Extras Cost Per Month\"}),Object(o.jsxs)(\"div\",{className:\"col-8 col-md-5 d-flex justify-content-end align-items-center\",children:[Object(l.a)(y),\" \",p]})]})})]})}return null};function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){Object(i.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var g=function(e){var t=e.title,n=e.data,i=e.options,c=e.initialState,l=e.settings,u=e.onRequestClose,d=Object(r.a)(e,[\"title\",\"data\",\"options\",\"initialState\",\"settings\",\"onRequestClose\"]),f=Object(a.useState)(c),g=f[0],y=f[1],m=function(){l.onCancel&&l.onCancel(),u()};return Object(o.jsxs)(s.a,h(h({onHide:m,centered:!0,scrollable:!0},d),{},{children:[Object(o.jsx)(s.a.Header,{className:\"options-title d-flex flex-nowrap justify-content-center align-items-center\",closeButton:!0,children:Object(o.jsx)(s.a.Title,{className:\"mb-0\",children:t})}),Object(o.jsx)(s.a.Body,{children:Object(o.jsx)(p,{options:n.extraOptions,relationships:n.extraOptionsRelationships,leasingDealType:i.leasingDealType,state:g,settings:{onStateChanged:function(e){y(e)}}})}),Object(o.jsxs)(s.a.Footer,{children:[Object(o.jsx)(\"button\",{className:\"btn btn-danger btn-lg d-flex justify-content-center align-items-center flex-grow-1\",onClick:m,children:\"Cancel\"}),Object(o.jsx)(\"button\",{className:\"btn btn-primary btn-lg d-flex justify-content-center align-items-center flex-grow-1\",onClick:function(){l.onApply&&l.onApply(g),u()},children:\"Apply\"})]})]}))}},ZrQC:function(e,t,n){\"use strict\";n.d(t,\"a\",(function(){return l}));var i=n(\"H+61\"),o=n(\"UlJF\"),r=n(\"Kj82\"),a=n(\"xVrE\"),s=n(\"PG61\"),c=n(\"wbKs\"),l=function(){function e(){Object(i.a)(this,e)}return Object(o.a)(e,null,[{key:\"getVehicleCustomOptions\",value:function(e,t){var n={},i=!1,o=e.url.split(\"?\"),s=o[1]?Object(a.c)(o[1].split(\"&\")):null;if(s){var l=NaN;l=parseInt(s.term),isNaN(l)||(n.term=l),l=parseInt(s.initialrentals),isNaN(l)||(n.initialRentalMonths=l),l=parseInt(s.mileage),isNaN(l)||(n.mileage=l),i=!Object(r.c)(s.isdefault)&&\"1\"===s.isdefault}e.pricingType&&2===e.pricingType?n.maintenance=!0:e.maintenanceAllowed||(n.maintenance=!1);var d=u.getOrAddVehicleCustomOptions(e.vehicleRef,e.leasingDealType,i,n);if(d.useCheapestTerm){var p={pricingType:e.pricingType||void 0,postcode:e.postcode||void 0};Object(c.G)(d.vehicleRef,d.leasingDealType,d.maintenance,d.mileage,d.initialRentalMonths,p).then((function(e){var n=null;e.isSucceed&&e.data&&(n=e.data),d.useCheapestTerm=!1,n&&n>0&&(d.term=n),u.addOrUpdateVehicleCustomOptions(d),t(d)}))}else t(d)}},{key:\"storeVehicleCustomOptions\",value:function(e){e&&(e.useCheapestTerm=!1,u.addOrUpdateVehicleCustomOptions(e))}}]),e}(),u=function(){function e(){Object(i.a)(this,e)}return Object(o.a)(e,null,[{key:\"getOrAddVehicleCustomOptions\",value:function(e,t,n,i){var o=this.getVehicleCustomOptions(e,t);return o&&!n||(o={vehicleRef:e,leasingDealType:t,term:s.a.DefaultTerm,mileage:s.a.GetDealTypeDefaultMileage(t),maintenance:s.a.DefaultMaintenance,initialRentalMonths:s.a.DefaultInitialRentals,options:[],salesCode:0,ageCategory:null,useCheapestTerm:!0}),Object.assign(o,i||{}),this.addOrUpdateVehicleCustomOptions(o),o}},{key:\"addOrUpdateVehicleCustomOptions\",value:function(e){if(null!==e){var t=this.getOptionsItemKey(e.vehicleRef,e.leasingDealType);localStorage.setItem(t,JSON.stringify(e))}}},{key:\"getVehicleCustomOptions\",value:function(e,t){var n=null;if(e&&t){var i=this.getOptionsItemKey(e,t),o=localStorage.getItem(i);n=JSON.parse(o)}return n}},{key:\"getOptionsItemKey\",value:function(e,t){return(\"options_\"+e+\"_\"+t).toLowerCase()}}]),e}()},jmJx:function(e,t,n){\"use strict\";n.d(t,\"a\",(function(){return u}));var i=n(\"H+61\"),o=n(\"UlJF\"),r=n(\"cpVT\"),a=n(\"xG9w\"),s=n(\"G6YE\"),c=n(\"FK8X\"),l=n(\"mmV+\"),u=function(){function e(){Object(i.a)(this,e)}return Object(o.a)(e,null,[{key:\"addItem\",value:function(e,t){if(t&&e>=0&&e<this.storageMaxSize){var n={id:Object(l.p)(),index:e,vehicle:t};if(c.a.addItem(this.storageType,n,e))return n}return null}},{key:\"updateItem\",value:function(e,t,n){if(t){var i=c.a.getItem(this.storageType,e);if(i&&(n||!a.a.isEqual(i.vehicle,t))&&(i.vehicle=t,c.a.updateItem(this.storageType,i)))return i}return null}},{key:\"addOrUpdateItem\",value:function(e){if(e){var t=this.getItems(!1),n=t.find((function(t){return t&&t.vehicle&&t.vehicle.vehicleRef===e.vehicleRef}));if(n)return this.updateItem(n.id,e,!0);var i=t.indexOf(null);if(!Object(l.u)(i)&&i>=0&&i<this.storageMaxSize)return this.addItem(i,e)}return null}},{key:\"cloneItem\",value:function(e){var t=this.getItems(!1),n=t.find((function(t){return t&&t.id===e}));if(n){var i=t.indexOf(null);if(!Object(l.u)(i)&&i>=0&&i<this.storageMaxSize){var o={id:Object(l.p)(),index:i,vehicle:n.vehicle};if(c.a.addItem(this.storageType,o,i))return o}}return null}},{key:\"removeItem\",value:function(e){return c.a.removeItem(this.storageType,e)}},{key:\"getItems\",value:function(e){var t=c.a.getItems(this.storageType);return t&&t.length>0&&e&&(t=t.filter((function(e){return e}))),t}},{key:\"clear\",value:function(){c.a.clear(this.storageType)}},{key:\"countItems\",value:function(){return this.getItems(!0).length}},{key:\"isFull\",value:function(){return!(this.countItems()<this.storageMaxSize)}}]),e}();Object(r.a)(u,\"storageType\",s.a.Garage),Object(r.a)(u,\"storageMaxSize\",c.a.getStorageMaxSize(s.a.Garage)||0)}}]);","map":{"version":3,"sources":["static/chunks/a3d5a6a92e5246eac71d159c47e7de37e6418e76.c6bca5d6638df670c2af.js"],"names":["window","push","/kJK","module","__webpack_exports__","__webpack_require__","d","VehicleExtraOptionsHelper","E_current_project_PPH_tfs_Website_website_node_modules_next_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__","E_current_project_PPH_tfs_Website_website_node_modules_next_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__","E_current_project_PPH_tfs_Website_website_node_modules_next_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_2__","underscore__WEBPACK_IMPORTED_MODULE_3__","Object","this","key","value","relationshipType","result","toUpperCase","options","selectedOptionIds","selectedOptions","length","filter","option","contains","id","optionsStates","self","forEach","getOptionPrice","optionState","_getOptionState","_getOptionPrice","optionIds","relationships","getRelationships","relationship","primaryOptionIds","regularOptionIds","type","intersection","difference","optionId","find","selectionRequiredBy","deselectionRequiredBy","union","isMirror","mirrorRelationshipIds","mirrorIn","useZeroPrice","map","clone","filteredOptions","item","linkedRelationshipIds","filteredRelationships","allowedRelationshipTypes","vehicleOptions","relationshipId","confirmRelationship","_getRelationship","relationshipPrimaryOptions","_getRelationshipOptions","relationshipRegularOptions","optionsToProcess","selectIds","deselectIds","pluck","isDisabled","isSelectAction","_getOption","primary","relationshipOptions","relationshipOption","name","isPrimary","price","isSelected","sortBy","CTce","VehicleExtraOptionsManager","_helpers_VehicleExtraOptionsHelper__WEBPACK_IMPORTED_MODULE_4__","_confirmRelationshipIds","_selectedOptionIds","_optionsStates","_vehicleOptions","_vehicleOptionRelationships","_clearMangerState","confirmRelationshipIds","arguments","undefined","cloneOptionsStates","silentlySelectedOptionIds","optionIdsByAction","splitOptionIdsByAction","alert","forSilentSelect","getOptionsWithoutRelationships","forSilentDeselect","optionIdsForSilentApply","optionsToConfirm","optionToProcess","confirmDetails","_getConfirmDetails","hasConflicts","optionsForSilentApply","some","confirmRelationships","initialSelectedOptionIds","initialConfirmReationshipIds","initialOptionsStates","_this","currentSelectedOptionIds","currentPendingRelationshipIds","currentOptionsStates","iterationOptions","iterationResult","_getConfirmDetailsIteration","iterationOptionState","recallRestrictionRelationshipIds","nextIterationOptions","optionExists","emptyRelationships","zeroPriceOptionIds","activeINRelationships","without","_this2","_ret","requiredOptionIdsByAction","uniqueSelectIds","uniqueDeselectIds","iterationSelectedOptionIds","relationshipsToConfirm","_loop","relationshipIdx","relationshipToConfirm","selectIntersection","deselectIntersection","_loop2","i","nextIterationOption","_loop3","_i","_ret2","v","Ezyo","getVehicleMonthlyPrice","enums_LeasingDealTypes__WEBPACK_IMPORTED_MODULE_0__","leasingDealType","term","rentalMonths","Personal","FK8X","VehiclesStorageProvider","enums_VehicleStorageTypes__WEBPACK_IMPORTED_MODULE_2__","helpers_stringHelper__WEBPACK_IMPORTED_MODULE_3__","helpers_helpers__WEBPACK_IMPORTED_MODULE_4__","storageType","History","Garage","items","storageName","getStorageName","JSON","parse","localStorage","getItem","requiredSize","getStorageMaxSize","itemsToAdd","itemId","getItems","index","storageMaxSize","indexHasValue","persistItems","existingItem","indexOf","removeItem","vehicleItems","setItem","stringify","G6YE","VehicleStorageTypes","TovF","popover","jsx_runtime","OverlayTrigger","Popover","_ref","trigger","title","body","placement","overlay","concat","children","Title","Content","Wj+e","vehicle_extra_options_confirm_modal","defineProperty","objectWithoutProperties","react","Modal","helpers","currencyHelper","vehicle_extra_options_relationships_manager","state","settings","vatText","_useState","setConfirmRelationships","confirmList","getConfirmRelationship","totalPrice","getOptionsPrice","getSelectedOptions","className","getRelationshipDescription","height","alt","data-src","onClick","getOptionAction","manager","init","managerState","processOptions","onStateChanged","handleOptionClick","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","sym","getOwnPropertyDescriptor","enumerable","apply","_objectSpread","target","source","getOwnPropertyDescriptors","defineProperties","data","initialState","onRequestClose","otherProps","currentState","setCurrentState","hadleCancelClick","onCancel","onHide","centered","scrollable","Header","closeButton","Body","extraOptions","extraOptionsRelationships","Footer","onApply","ZrQC","CustomOptionsHelper","_stringHelper__WEBPACK_IMPORTED_MODULE_2__","_urlsHelper__WEBPACK_IMPORTED_MODULE_3__","environment_siteSettings__WEBPACK_IMPORTED_MODULE_4__","business_logic_vehicleService__WEBPACK_IMPORTED_MODULE_5__","callback","values","isDefault","parts","url","split","queryStringParams","parsedInt","NaN","parseInt","isNaN","pricingType","maintenanceAllowed","customOptions","CustomOptionsStorageHelper","getOrAddVehicleCustomOptions","vehicleRef","useCheapestTerm","pricingData","postcode","maintenance","mileage","initialRentalMonths","then","cheapestTerm","isSucceed","addOrUpdateVehicleCustomOptions","setToDefault","getVehicleCustomOptions","DefaultTerm","GetDealTypeDefaultMileage","DefaultMaintenance","DefaultInitialRentals","salesCode","ageCategory","assign","getOptionsItemKey","serializedItem","toLowerCase","jmJx","GarageStorageHelper","enums_VehicleStorageTypes__WEBPACK_IMPORTED_MODULE_4__","helpers_vehiclesStorageProvider__WEBPACK_IMPORTED_MODULE_5__","helpers_helpers__WEBPACK_IMPORTED_MODULE_6__","storageItem","vehicle","addItem","alwaysUpdate","isEqual","updateItem","storageItems","itemToClone","clonnedItem","ignoreEmptyItems","clear","countItems"],"mappings":"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"},"name":"static/chunks/a3d5a6a92e5246eac71d159c47e7de37e6418e76.c6bca5d6638df670c2af.js","input":"(window[\"webpackJsonp_N_E\"] = window[\"webpackJsonp_N_E\"] || []).push([[33],{\n\n/***/ \"/kJK\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return VehicleExtraOptionsHelper; });\n/* harmony import */ var E_current_project_PPH_tfs_Website_website_node_modules_next_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"H+61\");\n/* harmony import */ var E_current_project_PPH_tfs_Website_website_node_modules_next_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"UlJF\");\n/* harmony import */ var E_current_project_PPH_tfs_Website_website_node_modules_next_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"cpVT\");\n/* harmony import */ var underscore__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(\"xG9w\");\n\n\n\n\nvar VehicleExtraOptionsHelper = /*#__PURE__*/function () {\n  function VehicleExtraOptionsHelper() {\n    Object(E_current_project_PPH_tfs_Website_website_node_modules_next_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])(this, VehicleExtraOptionsHelper);\n  }\n\n  Object(E_current_project_PPH_tfs_Website_website_node_modules_next_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__[/* default */ \"a\"])(VehicleExtraOptionsHelper, null, [{\n    key: \"getRelationshipDescription\",\n    value: function getRelationshipDescription(relationshipType) {\n      var result = null;\n\n      if (relationshipType) {\n        switch (relationshipType.toUpperCase()) {\n          case \"OO\":\n            result = \"From the options below, a maximum of one may be selected. For example, you can only have one type of paintwork.\";\n            break;\n\n          case \"RO\":\n            result = \"The option you have chosen must be accompanied by at least one of the additional options in the group below.\";\n            break;\n\n          case \"RA\":\n            result = \"The option you have chosen must be accompanied by all of the additional options in the group below.\";\n            break;\n\n          case \"NW\":\n            result = \"The option you have chosen cannot be accompanied by any of the options in the group below. For example if wood inlay is chosen it cannot be accompanied by any cloth trim.\";\n            break;\n\n          case \"IN\":\n            result = \"Please note the options below are included (at no extra cost) with the option you have chosen which comes as a pack.\";\n            break;\n\n          case \"IO\":\n            result = \"The option you have chosen must be accompanied by one option from the group below. The additional option will be no extra cost.\";\n            break;\n        }\n      }\n\n      return result ? result : relationshipType;\n    }\n  }, {\n    key: \"getSelectedOptions\",\n    value: function getSelectedOptions(options, selectedOptionIds) {\n      var selectedOptions = [];\n      if (options && options.length > 0 && selectedOptionIds && selectedOptionIds.length > 0) selectedOptions = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].filter(options, function (option) {\n        return underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].contains(selectedOptionIds, option.id);\n      });\n      return selectedOptions;\n    }\n  }, {\n    key: \"getOptionsPrice\",\n    value: function getOptionsPrice(options, optionsStates) {\n      var result = 0;\n\n      if (options) {\n        var self = this;\n        options.forEach(function (option) {\n          result += self.getOptionPrice(option, optionsStates);\n        });\n      }\n\n      return result;\n    }\n  }, {\n    key: \"getOptionPrice\",\n    value: function getOptionPrice(option, optionsStates) {\n      var result = 0;\n\n      if (option) {\n        var optionState = this._getOptionState(optionsStates, option.id);\n\n        result = this._getOptionPrice(option, optionState);\n      }\n\n      return result;\n    }\n  }, {\n    key: \"getOptionsStates\",\n    value: function getOptionsStates(optionIds, relationships) {\n      var optionsStates = [];\n\n      if (optionIds && relationships) {\n        var filteredRelationships = this.getRelationships(relationships, optionIds);\n        filteredRelationships.forEach(function (relationship) {\n          var primaryOptionIds = relationship.primaryOptionIds;\n          var regularOptionIds = relationship.regularOptionIds;\n          var isActive = relationship.type === \"OO\" || underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].intersection(primaryOptionIds, optionIds).length === primaryOptionIds.length;\n\n          if (isActive) {\n            if (relationship.type == \"OO\") {\n              underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].difference(regularOptionIds, optionIds).forEach(function (optionId) {\n                var optionState = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].find(optionsStates, function (option) {\n                  return option.id === optionId;\n                });\n\n                if (!optionState) {\n                  optionState = {\n                    id: optionId,\n                    selectionRequiredBy: [],\n                    deselectionRequiredBy: []\n                  };\n                  optionsStates.push(optionState);\n                }\n\n                optionState.deselectionRequiredBy = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].union(optionState.deselectionRequiredBy, [-1]);\n              });\n            } else if (relationship.type == \"RA\" || relationship.type == \"IN\") {\n              var isMirror = relationship.mirrorRelationshipIds && relationship.mirrorRelationshipIds.length > 0;\n              regularOptionIds.forEach(function (optionId) {\n                var optionState = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].find(optionsStates, function (option) {\n                  return option.id === optionId;\n                });\n\n                if (!optionState) {\n                  optionState = {\n                    id: optionId,\n                    selectionRequiredBy: [],\n                    deselectionRequiredBy: [],\n                    mirrorIn: []\n                  };\n                  optionsStates.push(optionState);\n                }\n\n                optionState.selectionRequiredBy = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].union(optionState.selectionRequiredBy, [relationship.id]);\n                optionState.useZeroPrice = optionState.useZeroPrice || relationship.type === \"IN\";\n\n                if (isMirror) {\n                  optionState.mirrorIn = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].union(optionState.mirrorIn, [relationship.id], relationship.mirrorRelationshipIds);\n                }\n              });\n            }\n          }\n        });\n      }\n\n      return optionsStates;\n    }\n  }, {\n    key: \"cloneOptionsStates\",\n    value: function cloneOptionsStates(optionsStates) {\n      return underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].map(optionsStates, function (optionState) {\n        var result = {\n          id: optionState.id,\n          selectionRequiredBy: underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].clone(optionState.selectionRequiredBy),\n          deselectionRequiredBy: underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].clone(optionState.deselectionRequiredBy),\n          mirrorIn: underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].clone(optionState.mirrorIn),\n          useZeroPrice: optionState.useZeroPrice\n        };\n        return result;\n      });\n    }\n  }, {\n    key: \"getOptionsWithoutRelationships\",\n    value: function getOptionsWithoutRelationships(options, optionIds) {\n      var filteredOptions = [];\n\n      if (optionIds && optionIds.length > 0) {\n        filteredOptions = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].filter(options || [], function (item) {\n          return item && underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].contains(optionIds, item.id) && (!item.linkedRelationshipIds || item.linkedRelationshipIds.length === 0);\n        });\n      }\n\n      return filteredOptions;\n    }\n  }, {\n    key: \"getRelationships\",\n    value: function getRelationships(relationships, optionIds) {\n      var filteredRelationships = [];\n      var allowedRelationshipTypes = this.allowedRelationshipTypes;\n\n      if (optionIds && optionIds.length > 0) {\n        filteredRelationships = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].filter(relationships || [], function (item) {\n          return item && underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].contains(allowedRelationshipTypes, item.type) && (underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].intersection(optionIds, item.primaryOptionIds).length > 0 || underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].intersection(optionIds, item.regularOptionIds).length > 0);\n        });\n      }\n\n      return filteredRelationships;\n    }\n  }, {\n    key: \"getConfirmRelationship\",\n    value: function getConfirmRelationship(relationships, vehicleOptions, relationshipId, selectedOptionIds, optionsStates) {\n      var confirmRelationship = null;\n\n      if (relationships && relationships.length > 0) {\n        var relationship = this._getRelationship(relationships, relationshipId);\n\n        if (relationship) {\n          confirmRelationship = {\n            id: relationship.id,\n            type: relationship.type,\n            options: []\n          };\n\n          var relationshipPrimaryOptions = this._getRelationshipOptions(relationship, vehicleOptions, true, selectedOptionIds, optionsStates);\n\n          var relationshipRegularOptions = this._getRelationshipOptions(relationship, vehicleOptions, false, selectedOptionIds, optionsStates);\n\n          confirmRelationship.options = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].union(confirmRelationship.options, relationshipPrimaryOptions);\n          confirmRelationship.options = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].union(confirmRelationship.options, relationshipRegularOptions);\n        }\n      }\n\n      return confirmRelationship;\n    } //is not used at the moment\n    //public static disableConfirmRelationshipOptions(confirmRelationship: ExtraOptionConfirmRelationship, selectedOptionIds: number[]) {\n    //    if (confirmRelationship.type !== \"OO\") {\n    //        let relationshipPrimaryOptions: ExtraOptionRelationshipOption[] = _.filter(confirmRelationship.options,\n    //            function (relationshipOption: ExtraOptionRelationshipOption) {\n    //                return relationshipOption.isPrimary;\n    //            });\n    //        let relationshipRegularOptions: ExtraOptionRelationshipOption[] = _.filter(confirmRelationship.options,\n    //            function (relationshipOption: ExtraOptionRelationshipOption) {\n    //                return !relationshipOption.isPrimary;\n    //            });\n    //        let relationshipPrimaryOptionIds: number[] = _.pluck(relationshipPrimaryOptions, 'id');\n    //        let relationshipRegularOptionIds: number[] = _.pluck(relationshipRegularOptions, 'id');\n    //        let activeRule = _.intersection(relationshipPrimaryOptionIds, selectedOptionIds).length === relationshipPrimaryOptionIds.length;\n    //        if (confirmRelationship.type == \"RA\" || confirmRelationship.type == \"IN\" || confirmRelationship.type == \"NW\") {\n    //            relationshipRegularOptions.forEach(function (relationshipOption) {\n    //                relationshipOption.isDisabled = activeRule;\n    //            });\n    //        }\n    //        else if (confirmRelationship.type == \"RO\" || confirmRelationship.type == \"IO\") {\n    //            //IO is a separate case\n    //            if (activeRule) {\n    //                let selectedIds: number[] = _.intersection(selectedOptionIds, relationshipRegularOptionIds);\n    //                if (selectedIds.length == 1) {\n    //                    relationshipRegularOptions.forEach(function (relationshipOption) {\n    //                        relationshipOption.isDisabled = relationshipOption.id === selectedIds[0];\n    //                    });\n    //                }\n    //            }\n    //        }\n    //    }\n    //}\n\n  }, {\n    key: \"splitOptionIdsByAction\",\n    value: function splitOptionIdsByAction(optionsToProcess) {\n      var result = {\n        selectIds: [],\n        deselectIds: []\n      };\n\n      if (optionsToProcess && optionsToProcess.length > 0) {\n        result.selectIds = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].pluck(underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].filter(optionsToProcess, function (option) {\n          return option.selectionRequiredBy.length > 0;\n        }), \"id\");\n        result.deselectIds = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].pluck(underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].filter(optionsToProcess, function (option) {\n          return option.deselectionRequiredBy.length > 0;\n        }), \"id\");\n      }\n\n      return result;\n    }\n  }, {\n    key: \"getOptionAction\",\n    value: function getOptionAction(option, selectedOptionIds) {\n      var result = null;\n\n      if (option && !option.isDisabled) {\n        var optionId = option.id;\n        var isSelectAction = !underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].contains(selectedOptionIds || [], optionId);\n        result = {\n          id: optionId,\n          selectionRequiredBy: isSelectAction ? [0] : [],\n          deselectionRequiredBy: !isSelectAction ? [0] : []\n        };\n      }\n\n      return result;\n    }\n  }, {\n    key: \"optionExists\",\n    value: function optionExists(optionId, vehicleOptions) {\n      var option = this._getOption(vehicleOptions, optionId);\n\n      if (option) {\n        return true;\n      }\n\n      return false;\n    }\n  }, {\n    key: \"_getRelationshipOptions\",\n    value: function _getRelationshipOptions(relationship, vehicleOptions, primary, selectedOptionIds, optionsStates) {\n      var relationshipOptions = [];\n\n      if (relationship !== null && vehicleOptions != null && vehicleOptions.length > 0) {\n        var self = this;\n        var ids = primary ? relationship.primaryOptionIds : relationship.regularOptionIds;\n        (ids || []).forEach(function (id) {\n          var option = self._getOption(vehicleOptions, id);\n\n          if (option) {\n            var optionState = self._getOptionState(optionsStates, option.id);\n\n            var relationshipOption = {\n              id: option.id,\n              name: option.name,\n              isPrimary: primary,\n              price: self._getOptionPrice(option, optionState),\n              isSelected: underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].contains(selectedOptionIds || [], option.id),\n              isDisabled: false\n            };\n            relationshipOptions.push(relationshipOption);\n          }\n        });\n        relationshipOptions = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].sortBy(relationshipOptions, 'name');\n      }\n\n      return relationshipOptions;\n    }\n  }, {\n    key: \"_getOptionPrice\",\n    value: function _getOptionPrice(option, optionState) {\n      var result = 0;\n\n      if (option) {\n        result = optionState && optionState.useZeroPrice ? 0 : option.price;\n      }\n\n      return result;\n    }\n  }, {\n    key: \"_getOptionState\",\n    value: function _getOptionState(optionsStates, id) {\n      return underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].find(optionsStates, function (item) {\n        return item && item.id === id;\n      });\n    }\n  }, {\n    key: \"_getOption\",\n    value: function _getOption(vehicleOptions, id) {\n      return underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].find(vehicleOptions, function (item) {\n        return item && item.id === id;\n      });\n    }\n  }, {\n    key: \"_getRelationship\",\n    value: function _getRelationship(relationships, id) {\n      return underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].find(relationships, function (item) {\n        return item && item.id === id;\n      });\n    }\n  }]);\n\n  return VehicleExtraOptionsHelper;\n}();\n\nObject(E_current_project_PPH_tfs_Website_website_node_modules_next_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_2__[/* default */ \"a\"])(VehicleExtraOptionsHelper, \"allowedRelationshipTypes\", [\"OO\", \"RO\", \"RA\", \"NW\", \"IN\", \"IO\"]);\n\n/***/ }),\n\n/***/ \"CTce\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return VehicleExtraOptionsManager; });\n/* harmony import */ var E_current_project_PPH_tfs_Website_website_node_modules_next_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"H+61\");\n/* harmony import */ var E_current_project_PPH_tfs_Website_website_node_modules_next_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"UlJF\");\n/* harmony import */ var E_current_project_PPH_tfs_Website_website_node_modules_next_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"cpVT\");\n/* harmony import */ var underscore__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(\"xG9w\");\n/* harmony import */ var _helpers_VehicleExtraOptionsHelper__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(\"/kJK\");\n\n\n\n\n\nvar VehicleExtraOptionsManager = /*#__PURE__*/function () {\n  function VehicleExtraOptionsManager() {\n    Object(E_current_project_PPH_tfs_Website_website_node_modules_next_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])(this, VehicleExtraOptionsManager);\n\n    Object(E_current_project_PPH_tfs_Website_website_node_modules_next_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_2__[/* default */ \"a\"])(this, \"_vehicleOptions\", []);\n\n    Object(E_current_project_PPH_tfs_Website_website_node_modules_next_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_2__[/* default */ \"a\"])(this, \"_vehicleOptionRelationships\", []);\n\n    Object(E_current_project_PPH_tfs_Website_website_node_modules_next_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_2__[/* default */ \"a\"])(this, \"_selectedOptionIds\", []);\n\n    Object(E_current_project_PPH_tfs_Website_website_node_modules_next_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_2__[/* default */ \"a\"])(this, \"_confirmRelationshipIds\", []);\n\n    Object(E_current_project_PPH_tfs_Website_website_node_modules_next_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_2__[/* default */ \"a\"])(this, \"_optionsStates\", []);\n  }\n\n  Object(E_current_project_PPH_tfs_Website_website_node_modules_next_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__[/* default */ \"a\"])(VehicleExtraOptionsManager, [{\n    key: \"_clearMangerState\",\n    value: function _clearMangerState() {\n      this._confirmRelationshipIds = [];\n      this._selectedOptionIds = [];\n      this._optionsStates = [];\n    }\n  }, {\n    key: \"init\",\n    value: function init(options, relationships) {\n      this._vehicleOptions = options || [];\n      this._vehicleOptionRelationships = relationships || [];\n\n      this._clearMangerState();\n    }\n  }, {\n    key: \"processOptions\",\n    value: function processOptions(optionsToProcess) {\n      var confirmRelationshipIds = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n      var selectedOptionIds = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n      var optionsStates = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n\n      this._clearMangerState();\n\n      this._selectedOptionIds = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].clone(selectedOptionIds || []);\n      this._confirmRelationshipIds = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].clone(confirmRelationshipIds || []);\n      this._optionsStates = _helpers_VehicleExtraOptionsHelper__WEBPACK_IMPORTED_MODULE_4__[/* VehicleExtraOptionsHelper */ \"a\"].cloneOptionsStates(optionsStates || []);\n      var silentlySelectedOptionIds = null;\n\n      if (optionsToProcess && optionsToProcess.length > 0) {\n        var _selectedOptionIds = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].clone(this._selectedOptionIds);\n\n        var optionIdsByAction = _helpers_VehicleExtraOptionsHelper__WEBPACK_IMPORTED_MODULE_4__[/* VehicleExtraOptionsHelper */ \"a\"].splitOptionIdsByAction(optionsToProcess);\n\n        if (underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].intersection(optionIdsByAction.selectIds, optionIdsByAction.deselectIds).length > 0) {\n          alert(\"Action is not allowed.\");\n          return null;\n        }\n\n        var forSilentSelect = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].pluck(_helpers_VehicleExtraOptionsHelper__WEBPACK_IMPORTED_MODULE_4__[/* VehicleExtraOptionsHelper */ \"a\"].getOptionsWithoutRelationships(this._vehicleOptions, optionIdsByAction.selectIds), 'id');\n\n        var forSilentDeselect = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].pluck(_helpers_VehicleExtraOptionsHelper__WEBPACK_IMPORTED_MODULE_4__[/* VehicleExtraOptionsHelper */ \"a\"].getOptionsWithoutRelationships(this._vehicleOptions, optionIdsByAction.deselectIds), 'id');\n\n        var optionIdsForSilentApply = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].union(forSilentSelect, forSilentDeselect);\n\n        if (optionIdsForSilentApply.length > 0) {\n          _selectedOptionIds = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].union(_selectedOptionIds, forSilentSelect);\n          _selectedOptionIds = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].difference(_selectedOptionIds, forSilentDeselect);\n          this._selectedOptionIds = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].clone(_selectedOptionIds);\n          silentlySelectedOptionIds = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].clone(_selectedOptionIds);\n        }\n\n        var optionsToConfirm = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].filter(optionsToProcess, function (optionToProcess) {\n          return !underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].contains(optionIdsForSilentApply, optionToProcess.id);\n        });\n\n        if (optionsToConfirm != null && optionsToConfirm.length > 0) {\n          var confirmDetails = this._getConfirmDetails(optionsToConfirm, _selectedOptionIds, this._confirmRelationshipIds, this._optionsStates);\n\n          if (confirmDetails.hasConflicts) {\n            alert(\"Action is not allowed.\");\n            return null;\n          }\n\n          var optionsForSilentApply = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].filter(optionsToConfirm, function (option) {\n            var notAny = !underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].some(confirmDetails.confirmRelationships, function (confirmRelationship) {\n              var contains = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].contains(confirmRelationship.optionIds, option.id);\n\n              return contains;\n            });\n            return notAny;\n          });\n\n          if (optionsForSilentApply.length > 0) {\n            silentlySelectedOptionIds = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].clone(this._selectedOptionIds);\n            optionIdsByAction = _helpers_VehicleExtraOptionsHelper__WEBPACK_IMPORTED_MODULE_4__[/* VehicleExtraOptionsHelper */ \"a\"].splitOptionIdsByAction(optionsForSilentApply);\n            silentlySelectedOptionIds = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].union(silentlySelectedOptionIds, optionIdsByAction.selectIds);\n            silentlySelectedOptionIds = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].difference(silentlySelectedOptionIds, optionIdsByAction.deselectIds);\n          }\n\n          this._selectedOptionIds = confirmDetails.selectedOptionIds;\n          this._confirmRelationshipIds = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].pluck(confirmDetails.confirmRelationships, \"id\");\n          this._optionsStates = confirmDetails.optionsStates;\n        }\n      }\n\n      var result = {\n        selectedOptionIds: underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].clone(this._selectedOptionIds),\n        confirmRelationshipIds: underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].clone(this._confirmRelationshipIds),\n        optionsStates: underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].clone(this._optionsStates),\n        silentlySelectedOptionIds: silentlySelectedOptionIds\n      };\n      return result;\n    }\n  }, {\n    key: \"_getConfirmDetails\",\n    value: function _getConfirmDetails(optionsToConfirm, initialSelectedOptionIds, initialConfirmReationshipIds, initialOptionsStates) {\n      var _this = this;\n\n      var result = {\n        hasConflicts: false,\n        selectedOptionIds: [],\n        confirmRelationships: [],\n        optionsStates: []\n      };\n\n      if (optionsToConfirm && optionsToConfirm.length > 0) {\n        (function () {\n          var currentSelectedOptionIds = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].clone(initialSelectedOptionIds || []);\n\n          var currentPendingRelationshipIds = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].clone(initialConfirmReationshipIds || []);\n\n          var currentOptionsStates = _helpers_VehicleExtraOptionsHelper__WEBPACK_IMPORTED_MODULE_4__[/* VehicleExtraOptionsHelper */ \"a\"].cloneOptionsStates(initialOptionsStates || []);\n\n          var iterationOptions = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].clone(optionsToConfirm);\n\n          var iterationResult = _this._getConfirmDetailsIteration(iterationOptions, currentSelectedOptionIds, currentOptionsStates);\n\n          while (iterationResult) {\n            if (iterationResult.hasConflicts) {\n              result.hasConflicts = true;\n              break;\n            }\n\n            iterationOptions.forEach(function (iterationOptionState) {\n              var optionState = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].find(currentOptionsStates, function (optionState) {\n                return optionState.id === iterationOptionState.id;\n              });\n\n              if (!optionState) {\n                optionState = {\n                  id: iterationOptionState.id,\n                  selectionRequiredBy: [],\n                  deselectionRequiredBy: [],\n                  mirrorIn: []\n                };\n                currentOptionsStates.push(optionState);\n              }\n\n              optionState.selectionRequiredBy = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].union(optionState.selectionRequiredBy, underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].difference(iterationOptionState.selectionRequiredBy, [-1]));\n              optionState.deselectionRequiredBy = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].union(optionState.deselectionRequiredBy, underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].difference(iterationOptionState.deselectionRequiredBy, [-1]));\n              optionState.mirrorIn = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].union(optionState.mirrorIn, iterationOptionState.mirrorIn);\n            });\n\n            if (iterationResult.recallRestrictionRelationshipIds) {\n              currentOptionsStates.forEach(function (optionState) {\n                optionState.selectionRequiredBy = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].difference(optionState.selectionRequiredBy, iterationResult.recallRestrictionRelationshipIds);\n                optionState.deselectionRequiredBy = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].difference(optionState.deselectionRequiredBy, iterationResult.recallRestrictionRelationshipIds);\n              });\n            }\n\n            var selectIds = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].pluck(underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].filter(iterationOptions, function (option) {\n              return option.selectionRequiredBy.length > 0;\n            }), \"id\");\n\n            var deselectIds = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].pluck(underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].filter(iterationOptions, function (option) {\n              return option.deselectionRequiredBy.length > 0;\n            }), \"id\");\n\n            currentSelectedOptionIds = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].difference(underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].union(currentSelectedOptionIds, selectIds), deselectIds);\n            currentPendingRelationshipIds = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].union(currentPendingRelationshipIds, iterationResult.confirmRelationshipIds);\n            iterationOptions = iterationResult.nextIterationOptions;\n            iterationResult = _this._getConfirmDetailsIteration(iterationOptions, currentSelectedOptionIds, currentOptionsStates);\n          }\n\n          if (!result.hasConflicts) {\n            var self = _this;\n            var optionsStates = currentOptionsStates;\n            var selectedOptionIds = currentSelectedOptionIds;\n            var confirmRelationships = [];\n            currentPendingRelationshipIds.forEach(function (relationshipId) {\n              var relationship = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].find(self._vehicleOptionRelationships, function (item) {\n                return item && item.id === relationshipId;\n              });\n\n              if (relationship) {\n                var optionIds = [];\n                optionIds = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].union(optionIds, relationship.primaryOptionIds);\n                optionIds = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].union(optionIds, relationship.regularOptionIds);\n                optionIds = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].filter(optionIds, function (id) {\n                  return _helpers_VehicleExtraOptionsHelper__WEBPACK_IMPORTED_MODULE_4__[/* VehicleExtraOptionsHelper */ \"a\"].optionExists(id, self._vehicleOptions);\n                });\n\n                if (optionIds.length > 0) {\n                  confirmRelationships.push({\n                    id: relationshipId,\n                    optionIds: optionIds\n                  });\n                }\n              }\n            }); //process empty RO, IO here\n            //wrong, should be applied processed items which not covered by confirm rules\n            //if ((!confirmRelationships || confirmRelationships.length === 0) && silentApplyAllowed && selectedOptionIds.length > 0) {\n            //    if (this.onApply) {\n            //        this.onApply(_.clone(selectedOptionIds));\n            //    }\n            //}\n            //cleanup confirm relationships\n            //--------------------------\n\n            var emptyRelationships = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].filter(confirmRelationships, function (item) {\n              return underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].intersection(item.optionIds, selectedOptionIds).length == 0;\n            });\n\n            if (confirmRelationships.length > emptyRelationships.length) {\n              confirmRelationships = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].filter(confirmRelationships, function (item) {\n                return underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].intersection(item.optionIds, selectedOptionIds).length > 0;\n              });\n            } //--------------------------\n            //confirmRelationships.forEach(function (confirmRelationship) {\n            //    VehicleExtraOptionsHelper.disableConfirmRelationshipOptions(confirmRelationship, selectedOptionIds);\n            //});\n\n\n            var zeroPriceOptionIds = [];\n\n            var activeINRelationships = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].filter(_this._vehicleOptionRelationships, function (relationship) {\n              return relationship && underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].contains(_helpers_VehicleExtraOptionsHelper__WEBPACK_IMPORTED_MODULE_4__[/* VehicleExtraOptionsHelper */ \"a\"].allowedRelationshipTypes, relationship.type) && relationship.type === \"IN\" && underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].intersection(selectedOptionIds, relationship.primaryOptionIds).length === relationship.primaryOptionIds.length;\n            });\n\n            if (activeINRelationships && activeINRelationships.length > 0) {\n              activeINRelationships.forEach(function (relationship) {\n                zeroPriceOptionIds = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].union(zeroPriceOptionIds, relationship.regularOptionIds);\n              });\n            }\n\n            optionsStates.forEach(function (optionState) {\n              optionState.useZeroPrice = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].contains(zeroPriceOptionIds, optionState.id);\n              optionState.selectionRequiredBy = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].without(optionState.selectionRequiredBy, 0);\n              optionState.deselectionRequiredBy = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].without(optionState.deselectionRequiredBy, 0);\n            });\n            result.optionsStates = optionsStates;\n            result.selectedOptionIds = selectedOptionIds;\n            result.confirmRelationships = confirmRelationships;\n          }\n        })();\n      }\n\n      return result;\n    }\n  }, {\n    key: \"_getConfirmDetailsIteration\",\n    value: function _getConfirmDetailsIteration(iterationOptions, selectedOptionIds, optionsStates) {\n      var _this2 = this;\n\n      if (iterationOptions && iterationOptions.length > 0) {\n        var _ret = function () {\n          var hasConflicts = false;\n          var confirmRelationshipIds = [];\n          var nextIterationOptions = [];\n          var recallRestrictionRelationshipIds = [];\n          var requiredOptionIdsByAction = _helpers_VehicleExtraOptionsHelper__WEBPACK_IMPORTED_MODULE_4__[/* VehicleExtraOptionsHelper */ \"a\"].splitOptionIdsByAction(iterationOptions);\n          hasConflicts = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].intersection(requiredOptionIdsByAction.selectIds, requiredOptionIdsByAction.deselectIds).length > 0;\n\n          if (!hasConflicts) {\n            var uniqueSelectIds = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].difference(requiredOptionIdsByAction.selectIds, selectedOptionIds);\n\n            var uniqueDeselectIds = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].intersection(requiredOptionIdsByAction.deselectIds, selectedOptionIds);\n\n            var iterationSelectedOptionIds = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].difference(underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].union(selectedOptionIds, uniqueSelectIds), uniqueDeselectIds);\n\n            var relationshipsToConfirm = _helpers_VehicleExtraOptionsHelper__WEBPACK_IMPORTED_MODULE_4__[/* VehicleExtraOptionsHelper */ \"a\"].getRelationships(_this2._vehicleOptionRelationships, underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].union(uniqueSelectIds, uniqueDeselectIds));\n\n            if (relationshipsToConfirm && relationshipsToConfirm.length > 0) {\n              var _loop = function _loop(relationshipIdx) {\n                var relationshipToConfirm = relationshipsToConfirm[relationshipIdx];\n                var primaryOptionIds = relationshipToConfirm.primaryOptionIds;\n                var regularOptionIds = relationshipToConfirm.regularOptionIds;\n\n                var optionIds = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].union(primaryOptionIds, regularOptionIds);\n\n                var selectIntersection = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].intersection(optionIds, uniqueSelectIds);\n\n                var deselectIntersection = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].intersection(optionIds, uniqueDeselectIds);\n\n                if (selectIntersection.length > 0 && deselectIntersection.length > 0) {} else if (selectIntersection.length > 0) {\n                  var isActive = relationshipToConfirm.type === \"OO\" || underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].intersection(primaryOptionIds, iterationSelectedOptionIds).length === primaryOptionIds.length;\n\n                  if (!isActive) {\n                    return \"continue\";\n                  }\n\n                  var _loop2 = function _loop2(i) {\n                    var optionId = selectIntersection[0];\n\n                    var optionState = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].find(optionsStates, function (optionState) {\n                      return optionState.id === optionId;\n                    });\n\n                    if (optionState) {\n                      if (underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].difference(optionState.deselectionRequiredBy, [relationshipToConfirm.id, -1]).length > 0) {\n                        hasConflicts = true;\n                        return \"break\";\n                      }\n                    }\n                  };\n\n                  for (var i = 0; i < selectIntersection.length; i++) {\n                    var _ret3 = _loop2(i);\n\n                    if (_ret3 === \"break\") break;\n                  }\n\n                  if (hasConflicts) {\n                    return \"break\";\n                  }\n\n                  if (relationshipToConfirm.type == \"OO\") {\n                    if (selectIntersection.length > 1) {\n                      hasConflicts = true;\n                      return \"break\";\n                    } else {\n                      var selectOptionState = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].find(optionsStates, function (optionState) {\n                        return optionState.id === selectIntersection[0];\n                      }); //if (selectOptionState) {\n                      //    selectOptionState.deselectionRequiredBy = _.without(selectOptionState.deselectionRequiredBy, relationshipToConfirm.id);\n                      //}\n\n\n                      underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].difference(regularOptionIds, selectIntersection).forEach(function (optionId) {\n                        var nextIterationOption = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].find(nextIterationOptions, function (option) {\n                          return option.id === optionId;\n                        });\n\n                        if (!nextIterationOption) {\n                          nextIterationOption = {\n                            id: optionId,\n                            selectionRequiredBy: [],\n                            deselectionRequiredBy: []\n                          };\n                          nextIterationOptions.push(nextIterationOption);\n                        }\n\n                        nextIterationOption.deselectionRequiredBy = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].union(nextIterationOption.deselectionRequiredBy, [-1]);\n                      });\n                    }\n                  } else if (relationshipToConfirm.type == \"RA\" || relationshipToConfirm.type == \"IN\") {\n                    var isMirror = relationshipToConfirm.mirrorRelationshipIds && relationshipToConfirm.mirrorRelationshipIds.length > 0;\n                    regularOptionIds.forEach(function (optionId) {\n                      var nextIterationOption = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].find(nextIterationOptions, function (option) {\n                        return option.id === optionId;\n                      });\n\n                      if (!nextIterationOption) {\n                        nextIterationOption = {\n                          id: optionId,\n                          selectionRequiredBy: [],\n                          deselectionRequiredBy: [],\n                          mirrorIn: []\n                        };\n                        nextIterationOptions.push(nextIterationOption);\n                      }\n\n                      nextIterationOption.selectionRequiredBy = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].union(nextIterationOption.selectionRequiredBy, [relationshipToConfirm.id]);\n\n                      if (isMirror) {\n                        nextIterationOption.mirrorIn = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].union(nextIterationOption.mirrorIn, [relationshipToConfirm.id], relationshipToConfirm.mirrorRelationshipIds);\n                      }\n                    });\n                  }\n\n                  confirmRelationshipIds = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].union(confirmRelationshipIds, [relationshipToConfirm.id]);\n                } else if (deselectIntersection.length > 0) {\n                  var _loop3 = function _loop3(_i) {\n                    var optionId = deselectIntersection[_i];\n\n                    var optionState = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].find(optionsStates, function (optionState) {\n                      return optionState.id === optionId;\n                    });\n\n                    if (optionState && underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].difference(optionState.selectionRequiredBy, optionState.mirrorIn).length > 0) {\n                      hasConflicts = true;\n                      return \"break\";\n                    }\n                  };\n\n                  for (var _i = 0; _i < deselectIntersection.length; _i++) {\n                    var _ret4 = _loop3(_i);\n\n                    if (_ret4 === \"break\") break;\n                  }\n\n                  if (hasConflicts) {\n                    return \"break\";\n                  }\n\n                  if (relationshipToConfirm.type == \"OO\") {\n                    if (underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].intersection(iterationSelectedOptionIds, optionIds).length == 0) {\n                      recallRestrictionRelationshipIds.push(relationshipToConfirm.id);\n                    }\n\n                    confirmRelationshipIds = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].union(confirmRelationshipIds, [relationshipToConfirm.id]);\n                  } else if (relationshipToConfirm.type == \"RA\" || relationshipToConfirm.type == \"IN\") {\n                    var _isMirror = relationshipToConfirm.mirrorRelationshipIds && relationshipToConfirm.mirrorRelationshipIds.length > 0;\n\n                    if (_isMirror) {\n                      underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].difference(optionIds, deselectIntersection).forEach(function (optionId) {\n                        var nextIterationOption = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].find(nextIterationOptions, function (option) {\n                          return option.id === optionId;\n                        });\n\n                        if (!nextIterationOption) {\n                          nextIterationOption = {\n                            id: optionId,\n                            selectionRequiredBy: [],\n                            deselectionRequiredBy: [],\n                            mirrorIn: []\n                          };\n                          nextIterationOptions.push(nextIterationOption);\n                        }\n\n                        nextIterationOption.deselectionRequiredBy = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].union(nextIterationOption.deselectionRequiredBy, [0]);\n                      });\n                    }\n\n                    if (underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].intersection(primaryOptionIds, iterationSelectedOptionIds).length !== primaryOptionIds.length) {\n                      recallRestrictionRelationshipIds.push(relationshipToConfirm.id);\n                    }\n\n                    if (underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].intersection(primaryOptionIds, selectedOptionIds).length === primaryOptionIds.length) {\n                      confirmRelationshipIds = underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].union(confirmRelationshipIds, [relationshipToConfirm.id]);\n                    }\n                  }\n                }\n              };\n\n              for (var relationshipIdx = 0; relationshipIdx < relationshipsToConfirm.length; relationshipIdx++) {\n                var _ret2 = _loop(relationshipIdx);\n\n                if (_ret2 === \"continue\") continue;\n                if (_ret2 === \"break\") break;\n              }\n            }\n          }\n\n          return {\n            v: {\n              hasConflicts: hasConflicts,\n              confirmRelationshipIds: hasConflicts ? [] : confirmRelationshipIds,\n              nextIterationOptions: hasConflicts ? [] : nextIterationOptions,\n              recallRestrictionRelationshipIds: hasConflicts ? [] : recallRestrictionRelationshipIds\n            }\n          };\n        }();\n\n        if (typeof _ret === \"object\") return _ret.v;\n      }\n\n      return null;\n    }\n  }]);\n\n  return VehicleExtraOptionsManager;\n}();\n\n/***/ }),\n\n/***/ \"Ezyo\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return getVehicleMonthlyPrice; });\n/* unused harmony export getAnnualTax */\n/* harmony import */ var enums_LeasingDealTypes__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"l7ai\");\n\nvar getVehicleMonthlyPrice = function getVehicleMonthlyPrice(leasingDealType, price, term, rentalMonths) {\n  var result = null;\n\n  if (price && price > 0) {\n    price = leasingDealType === enums_LeasingDealTypes__WEBPACK_IMPORTED_MODULE_0__[/* LeasingDealTypes */ \"a\"].Personal ? price * 1.2 : price;\n    result = price / (term * 12 - 1 + rentalMonths);\n  }\n\n  return result || 0;\n};\nvar getAnnualTax = function getAnnualTax(p11d, taxRate, co2TaxMultiplier) {\n  if (p11d >= 0 && taxRate >= 0 && co2TaxMultiplier >= 0) {\n    return p11d * (taxRate / 100) * (co2TaxMultiplier / 100);\n  }\n\n  return null;\n};\n\n/***/ }),\n\n/***/ \"FK8X\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return VehiclesStorageProvider; });\n/* harmony import */ var E_current_project_PPH_tfs_Website_website_node_modules_next_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"H+61\");\n/* harmony import */ var E_current_project_PPH_tfs_Website_website_node_modules_next_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"UlJF\");\n/* harmony import */ var enums_VehicleStorageTypes__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"G6YE\");\n/* harmony import */ var helpers_stringHelper__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(\"Kj82\");\n/* harmony import */ var helpers_helpers__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(\"mmV+\");\n\n\n\n\n\nvar VehiclesStorageProvider = /*#__PURE__*/function () {\n  function VehiclesStorageProvider() {\n    Object(E_current_project_PPH_tfs_Website_website_node_modules_next_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])(this, VehiclesStorageProvider);\n  }\n\n  Object(E_current_project_PPH_tfs_Website_website_node_modules_next_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__[/* default */ \"a\"])(VehiclesStorageProvider, null, [{\n    key: \"getTriggerMaxSize\",\n    value: function getTriggerMaxSize(storageType) {\n      switch (storageType) {\n        case enums_VehicleStorageTypes__WEBPACK_IMPORTED_MODULE_2__[/* VehicleStorageTypes */ \"a\"].History:\n          return 4;\n\n        default:\n          return null;\n      }\n    }\n  }, {\n    key: \"getStorageMaxSize\",\n    value: function getStorageMaxSize(storageType) {\n      switch (storageType) {\n        case enums_VehicleStorageTypes__WEBPACK_IMPORTED_MODULE_2__[/* VehicleStorageTypes */ \"a\"].Garage:\n          return 4;\n\n        case enums_VehicleStorageTypes__WEBPACK_IMPORTED_MODULE_2__[/* VehicleStorageTypes */ \"a\"].History:\n          return 20;\n\n        default:\n          return null;\n      }\n    }\n  }, {\n    key: \"getStorageName\",\n    value: function getStorageName(storageType) {\n      switch (storageType) {\n        case enums_VehicleStorageTypes__WEBPACK_IMPORTED_MODULE_2__[/* VehicleStorageTypes */ \"a\"].Garage:\n          return \"garage\";\n\n        case enums_VehicleStorageTypes__WEBPACK_IMPORTED_MODULE_2__[/* VehicleStorageTypes */ \"a\"].History:\n          return \"history\";\n\n        default:\n          return null;\n      }\n    }\n  }, {\n    key: \"getItems\",\n    value: function getItems(storageType) {\n      var items = null;\n      var storageName = this.getStorageName(storageType);\n\n      if (!Object(helpers_stringHelper__WEBPACK_IMPORTED_MODULE_3__[/* isNullOrWhiteSpace */ \"c\"])(storageName)) {\n        items = JSON.parse(localStorage.getItem(storageName));\n      }\n\n      if (!items) {\n        items = [];\n      }\n\n      var requiredSize = this.getStorageMaxSize(storageType);\n\n      if (items.length < requiredSize) {\n        var itemsToAdd = requiredSize - items.length;\n\n        for (var i = 0; i < itemsToAdd; i++) {\n          items.push(null);\n        }\n      }\n\n      return items;\n    }\n  }, {\n    key: \"getItem\",\n    value: function getItem(storageType, itemId) {\n      var items = this.getItems(storageType);\n      var item = items.find(function (item) {\n        return item && item.id === itemId;\n      });\n      return item;\n    }\n  }, {\n    key: \"addItem\",\n    value: function addItem(storageType, item, index) {\n      var result = false;\n      var items = this.getItems(storageType);\n      var storageMaxSize = this.getStorageMaxSize(storageType);\n      var indexHasValue = !Object(helpers_helpers__WEBPACK_IMPORTED_MODULE_4__[/* isNullOrEmpty */ \"u\"])(index);\n\n      if (!indexHasValue && items.length < storageMaxSize || indexHasValue && index >= 0 && index < storageMaxSize) {\n        if (indexHasValue) {\n          items[index] = item;\n        } else {\n          items.push(item);\n        }\n\n        result = this.persistItems(storageType, items);\n      }\n\n      return result;\n    }\n  }, {\n    key: \"updateItem\",\n    value: function updateItem(storageType, item) {\n      var result = false;\n      var items = this.getItems(storageType);\n      var existingItem = items.find(function (existingItem) {\n        return existingItem && existingItem.id === item.id && existingItem.index === item.index;\n      });\n\n      if (existingItem) {\n        items[items.indexOf(existingItem)] = item;\n        result = this.persistItems(storageType, items);\n      }\n\n      return result;\n    }\n  }, {\n    key: \"removeItem\",\n    value: function removeItem(storageType, itemId) {\n      var result = false;\n      var items = this.getItems(storageType);\n      var item = items.find(function (item) {\n        return item && item.id === itemId;\n      });\n\n      if (item) {\n        items[items.indexOf(item)] = null;\n        result = this.persistItems(storageType, items);\n      }\n\n      return result;\n    }\n  }, {\n    key: \"clear\",\n    value: function clear(storageType) {\n      var storageName = this.getStorageName(storageType);\n\n      if (!Object(helpers_stringHelper__WEBPACK_IMPORTED_MODULE_3__[/* isNullOrWhiteSpace */ \"c\"])(storageName)) {\n        localStorage.removeItem(storageName);\n        return true;\n      }\n\n      return false;\n    }\n  }, {\n    key: \"persistItems\",\n    value: function persistItems(storageType, vehicleItems) {\n      var storageName = this.getStorageName(storageType);\n\n      if (!Object(helpers_stringHelper__WEBPACK_IMPORTED_MODULE_3__[/* isNullOrWhiteSpace */ \"c\"])(storageName)) {\n        localStorage.setItem(storageName, JSON.stringify(vehicleItems));\n        return true;\n      }\n\n      return false;\n    }\n  }]);\n\n  return VehiclesStorageProvider;\n}();\n\n/***/ }),\n\n/***/ \"G6YE\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return VehicleStorageTypes; });\nvar VehicleStorageTypes;\n\n(function (VehicleStorageTypes) {\n  VehicleStorageTypes[VehicleStorageTypes[\"None\"] = 0] = \"None\";\n  VehicleStorageTypes[VehicleStorageTypes[\"Garage\"] = 1] = \"Garage\";\n  VehicleStorageTypes[VehicleStorageTypes[\"History\"] = 2] = \"History\";\n})(VehicleStorageTypes || (VehicleStorageTypes = {}));\n\n/***/ }),\n\n/***/ \"TovF\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, \"a\", function() { return /* reexport */ popover; });\n\n// EXTERNAL MODULE: ./node_modules/react/jsx-runtime.js\nvar jsx_runtime = __webpack_require__(\"nKUr\");\n\n// EXTERNAL MODULE: ./node_modules/react/index.js\nvar react = __webpack_require__(\"q1tI\");\n\n// EXTERNAL MODULE: ./node_modules/react-bootstrap/esm/OverlayTrigger.js + 61 modules\nvar OverlayTrigger = __webpack_require__(\"dDCJ\");\n\n// EXTERNAL MODULE: ./node_modules/react-bootstrap/esm/Popover.js + 2 modules\nvar Popover = __webpack_require__(\"9vsu\");\n\n// CONCATENATED MODULE: ./components/layout/popover/popover.tsx\n\n\n\n\n\nvar popover_PopOver = function PopOver(_ref) {\n  var id = _ref.id,\n      trigger = _ref.trigger,\n      title = _ref.title,\n      body = _ref.body;\n  return /*#__PURE__*/Object(jsx_runtime[\"jsx\"])(OverlayTrigger[\"a\" /* default */], {\n    trigger: \"click\",\n    placement: \"top\",\n    overlay: /*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(Popover[\"a\" /* default */], {\n      id: \"popover-positioned-\".concat(id),\n      children: [title ? /*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Popover[\"a\" /* default */].Title, {\n        children: title\n      }) : \"\", /*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Popover[\"a\" /* default */].Content, {\n        children: body\n      })]\n    }),\n    children: trigger\n  }, id);\n};\n\n/* harmony default export */ var popover = (popover_PopOver);\n// CONCATENATED MODULE: ./components/layout/popover/index.js\n\n\n/***/ }),\n\n/***/ \"Wj+e\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, \"a\", function() { return /* reexport */ vehicle_extra_options_confirm_modal; });\n\n// EXTERNAL MODULE: ./node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty.js\nvar defineProperty = __webpack_require__(\"cpVT\");\n\n// EXTERNAL MODULE: ./node_modules/react/jsx-runtime.js\nvar jsx_runtime = __webpack_require__(\"nKUr\");\n\n// EXTERNAL MODULE: ./node_modules/next/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js + 1 modules\nvar objectWithoutProperties = __webpack_require__(\"dhJC\");\n\n// EXTERNAL MODULE: ./node_modules/react/index.js\nvar react = __webpack_require__(\"q1tI\");\n\n// EXTERNAL MODULE: ./node_modules/react-bootstrap/esm/Modal.js + 22 modules\nvar Modal = __webpack_require__(\"zM5D\");\n\n// EXTERNAL MODULE: ./helpers/helpers.tsx\nvar helpers = __webpack_require__(\"mmV+\");\n\n// EXTERNAL MODULE: ./helpers/currencyHelper.tsx\nvar currencyHelper = __webpack_require__(\"oszm\");\n\n// EXTERNAL MODULE: ./components/vehicle/_libs/helpers/VehicleExtraOptionsHelper.tsx\nvar VehicleExtraOptionsHelper = __webpack_require__(\"/kJK\");\n\n// EXTERNAL MODULE: ./components/vehicle/_libs/VehicleExtraOptionsManager.tsx\nvar VehicleExtraOptionsManager = __webpack_require__(\"CTce\");\n\n// CONCATENATED MODULE: ./components/vehicle/vehicle-extra-options-relationships-manager/vehicle-extra-options-relationships-manager.tsx\n\n\n\n\n\n\n\n\n\nvar vehicle_extra_options_relationships_manager_VehicleExtraOptionsRelationshipsManager = function VehicleExtraOptionsRelationshipsManager(_ref) {\n  var options = _ref.options,\n      relationships = _ref.relationships,\n      leasingDealType = _ref.leasingDealType,\n      state = _ref.state,\n      settings = _ref.settings;\n  var vatText = Object(helpers[\"h\" /* GetVATText */])(leasingDealType);\n\n  var _useState = Object(react[\"useState\"])([]),\n      confirmRelationships = _useState[0],\n      setConfirmRelationships = _useState[1];\n\n  var handleOptionClick = function handleOptionClick(option) {\n    var optionToProcess = VehicleExtraOptionsHelper[\"a\" /* VehicleExtraOptionsHelper */].getOptionAction(option, state.selectedOptionIds);\n\n    if (optionToProcess) {\n      var optionsToProcess = [optionToProcess];\n      var manager = new VehicleExtraOptionsManager[\"a\" /* VehicleExtraOptionsManager */]();\n      manager.init(options, relationships);\n      var managerState = manager.processOptions(optionsToProcess, state.confirmRelationshipIds, state.selectedOptionIds, state.optionsStates);\n\n      if (managerState) {\n        if (settings.onStateChanged) {\n          settings.onStateChanged({\n            confirmRelationshipIds: managerState.confirmRelationshipIds,\n            selectedOptionIds: managerState.selectedOptionIds,\n            optionsStates: managerState.optionsStates\n          });\n        }\n      }\n    }\n  };\n\n  Object(react[\"useEffect\"])(function () {\n    var confirmList = [];\n\n    if (state.confirmRelationshipIds && state.confirmRelationshipIds.length > 0) {\n      state.confirmRelationshipIds.forEach(function (relationshipId) {\n        var confirmRelationship = VehicleExtraOptionsHelper[\"a\" /* VehicleExtraOptionsHelper */].getConfirmRelationship(relationships, options, relationshipId, state.selectedOptionIds, state.optionsStates);\n\n        if (confirmRelationship) {\n          confirmList.push(confirmRelationship);\n        }\n      });\n    }\n\n    setConfirmRelationships(confirmList);\n  }, [state]);\n\n  if (confirmRelationships.length > 0) {\n    var totalPrice = VehicleExtraOptionsHelper[\"a\" /* VehicleExtraOptionsHelper */].getOptionsPrice(VehicleExtraOptionsHelper[\"a\" /* VehicleExtraOptionsHelper */].getSelectedOptions(options, state.selectedOptionIds), state.optionsStates);\n    return /*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(jsx_runtime[\"Fragment\"], {\n      children: [/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\", {\n        className: \"options-box\",\n        children: confirmRelationships.map(function (relationship) {\n          return /*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\", {\n            className: \"rule-item\",\n            children: [/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"p\", {\n              className: \"my-3\",\n              children: /*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"strong\", {\n                className: \"text-center\",\n                children: VehicleExtraOptionsHelper[\"a\" /* VehicleExtraOptionsHelper */].getRelationshipDescription(relationship.type)\n              })\n            }), /*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\", {\n              children: relationship.options.map(function (option) {\n                return /*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\", {\n                  className: \"row\",\n                  children: [/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\", {\n                    className: \"col-16 col-md-20 d-flex flex-row flex-wrap align-items-center my-2\",\n                    children: [option.isPrimary ? /*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"img\", {\n                      className: \"lazyload mr-2\",\n                      height: \"13\",\n                      alt: \"Primary icon\",\n                      \"data-src\": \"\".concat(\"https://imagecdn.leasingoptions.co.uk\", \"/website/icon-primary.png\")\n                    }) : \"\", \" \", option.name]\n                  }), /*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\", {\n                    className: \"col-8 col-md-4 d-flex justify-content-end align-items-center\",\n                    children: [Object(currencyHelper[\"a\" /* formatMoney */])(option.price), \" \", /*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"span\", {\n                      className: \"vehicle-option__indicator \".concat(option.isSelected ? \"is-active\" : \"\", \" \").concat(option.isDisabled ? \"is-disabled\" : \"\"),\n                      onClick: function onClick() {\n                        return handleOptionClick(option);\n                      }\n                    })]\n                  })]\n                }, \"option-\".concat(option.id));\n              })\n            })]\n          }, \"rule-\".concat(relationship.id));\n        })\n      }), /*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\", {\n        className: \"options-pricing\",\n        children: /*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\", {\n          className: \"row\",\n          children: [/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\", {\n            className: \"col-16 col-md-19 d-flex flex-row flex-wrap my-2\",\n            children: \"Total Extras Cost Per Month\"\n          }), /*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\", {\n            className: \"col-8 col-md-5 d-flex justify-content-end align-items-center\",\n            children: [Object(currencyHelper[\"a\" /* formatMoney */])(totalPrice), \" \", vatText]\n          })]\n        })\n      })]\n    });\n  }\n\n  return null;\n};\n\n/* harmony default export */ var vehicle_extra_options_relationships_manager = (vehicle_extra_options_relationships_manager_VehicleExtraOptionsRelationshipsManager);\n// CONCATENATED MODULE: ./components/vehicle/vehicle-extra-options-relationships-manager/index.jsx\n\n// CONCATENATED MODULE: ./components/vehicle/vehicle-extra-options-confirm-modal/vehicle-extra-options-confirm-modal.tsx\n\n\n\n\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { Object(defineProperty[\"a\" /* default */])(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n\n\n\n\nvar vehicle_extra_options_confirm_modal_VehicleExtarOptionsConfirmModal = function VehicleExtarOptionsConfirmModal(_ref) {\n  var title = _ref.title,\n      data = _ref.data,\n      options = _ref.options,\n      initialState = _ref.initialState,\n      settings = _ref.settings,\n      onRequestClose = _ref.onRequestClose,\n      otherProps = Object(objectWithoutProperties[\"a\" /* default */])(_ref, [\"title\", \"data\", \"options\", \"initialState\", \"settings\", \"onRequestClose\"]);\n\n  var _useState = Object(react[\"useState\"])(initialState),\n      currentState = _useState[0],\n      setCurrentState = _useState[1];\n\n  var hadleCancelClick = function hadleCancelClick() {\n    if (settings.onCancel) {\n      settings.onCancel();\n    }\n\n    onRequestClose();\n  };\n\n  var handleApplyClick = function handleApplyClick() {\n    if (settings.onApply) {\n      settings.onApply(currentState);\n    }\n\n    onRequestClose();\n  };\n\n  var onManagerStateChanged = function onManagerStateChanged(managerState) {\n    setCurrentState(managerState);\n  };\n\n  return /*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(Modal[\"a\" /* default */], _objectSpread(_objectSpread({\n    onHide: hadleCancelClick,\n    centered: true,\n    scrollable: true\n  }, otherProps), {}, {\n    children: [/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Modal[\"a\" /* default */].Header, {\n      className: \"options-title d-flex flex-nowrap justify-content-center align-items-center\",\n      closeButton: true,\n      children: /*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Modal[\"a\" /* default */].Title, {\n        className: \"mb-0\",\n        children: title\n      })\n    }), /*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Modal[\"a\" /* default */].Body, {\n      children: /*#__PURE__*/Object(jsx_runtime[\"jsx\"])(vehicle_extra_options_relationships_manager, {\n        options: data.extraOptions,\n        relationships: data.extraOptionsRelationships,\n        leasingDealType: options.leasingDealType,\n        state: currentState,\n        settings: {\n          onStateChanged: onManagerStateChanged\n        }\n      })\n    }), /*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(Modal[\"a\" /* default */].Footer, {\n      children: [/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"button\", {\n        className: \"btn btn-danger btn-lg d-flex justify-content-center align-items-center flex-grow-1\",\n        onClick: hadleCancelClick,\n        children: \"Cancel\"\n      }), /*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"button\", {\n        className: \"btn btn-primary btn-lg d-flex justify-content-center align-items-center flex-grow-1\",\n        onClick: handleApplyClick,\n        children: \"Apply\"\n      })]\n    })]\n  }));\n};\n\n/* harmony default export */ var vehicle_extra_options_confirm_modal = (vehicle_extra_options_confirm_modal_VehicleExtarOptionsConfirmModal);\n// CONCATENATED MODULE: ./components/vehicle/vehicle-extra-options-confirm-modal/index.jsx\n\n\n/***/ }),\n\n/***/ \"ZrQC\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return CustomOptionsHelper; });\n/* unused harmony export CustomOptionsStorageHelper */\n/* harmony import */ var E_current_project_PPH_tfs_Website_website_node_modules_next_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"H+61\");\n/* harmony import */ var E_current_project_PPH_tfs_Website_website_node_modules_next_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"UlJF\");\n/* harmony import */ var _stringHelper__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"Kj82\");\n/* harmony import */ var _urlsHelper__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(\"xVrE\");\n/* harmony import */ var environment_siteSettings__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(\"PG61\");\n/* harmony import */ var business_logic_vehicleService__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(\"wbKs\");\n\n\n\n\n\n\nvar CustomOptionsHelper = /*#__PURE__*/function () {\n  function CustomOptionsHelper() {\n    Object(E_current_project_PPH_tfs_Website_website_node_modules_next_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])(this, CustomOptionsHelper);\n  }\n\n  Object(E_current_project_PPH_tfs_Website_website_node_modules_next_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__[/* default */ \"a\"])(CustomOptionsHelper, null, [{\n    key: \"getVehicleCustomOptions\",\n    value: function getVehicleCustomOptions(data, callback) {\n      var values = {};\n      var isDefault = false;\n      var parts = data.url.split('?');\n      var queryStringParams = parts[1] ? Object(_urlsHelper__WEBPACK_IMPORTED_MODULE_3__[/* getQueryParams */ \"c\"])(parts[1].split('&')) : null;\n\n      if (queryStringParams) {\n        var parsedInt = NaN;\n        parsedInt = parseInt(queryStringParams[\"term\"]);\n\n        if (!isNaN(parsedInt)) {\n          values[\"term\"] = parsedInt;\n        }\n\n        parsedInt = parseInt(queryStringParams[\"initialrentals\"]);\n\n        if (!isNaN(parsedInt)) {\n          values[\"initialRentalMonths\"] = parsedInt;\n        }\n\n        parsedInt = parseInt(queryStringParams[\"mileage\"]);\n\n        if (!isNaN(parsedInt)) {\n          values[\"mileage\"] = parsedInt;\n        }\n\n        isDefault = !Object(_stringHelper__WEBPACK_IMPORTED_MODULE_2__[/* isNullOrWhiteSpace */ \"c\"])(queryStringParams[\"isdefault\"]) && queryStringParams[\"isdefault\"] === \"1\";\n      }\n\n      if (data.pricingType && data.pricingType === 2) {\n        //isAtcPricing\n        values[\"maintenance\"] = true;\n      } else if (!data.maintenanceAllowed) {\n        values[\"maintenance\"] = false;\n      }\n\n      var customOptions = CustomOptionsStorageHelper.getOrAddVehicleCustomOptions(data.vehicleRef, data.leasingDealType, isDefault, values);\n\n      if (customOptions.useCheapestTerm) {\n        var pricingData = {\n          pricingType: data.pricingType || undefined,\n          postcode: data.postcode || undefined\n        };\n        Object(business_logic_vehicleService__WEBPACK_IMPORTED_MODULE_5__[/* GetVehicleCheapestPriceTerm */ \"G\"])(customOptions.vehicleRef, customOptions.leasingDealType, customOptions.maintenance, customOptions.mileage, customOptions.initialRentalMonths, pricingData).then(function (result) {\n          var cheapestTerm = null;\n\n          if (result.isSucceed && result.data) {\n            cheapestTerm = result.data;\n          }\n\n          customOptions.useCheapestTerm = false;\n\n          if (cheapestTerm && cheapestTerm > 0) {\n            customOptions.term = cheapestTerm;\n          }\n\n          CustomOptionsStorageHelper.addOrUpdateVehicleCustomOptions(customOptions);\n          callback(customOptions);\n        });\n      } else {\n        callback(customOptions);\n      }\n    }\n  }, {\n    key: \"storeVehicleCustomOptions\",\n    value: function storeVehicleCustomOptions(customOptions) {\n      if (customOptions) {\n        customOptions.useCheapestTerm = false;\n        CustomOptionsStorageHelper.addOrUpdateVehicleCustomOptions(customOptions);\n      }\n    }\n  }]);\n\n  return CustomOptionsHelper;\n}();\nvar CustomOptionsStorageHelper = /*#__PURE__*/function () {\n  function CustomOptionsStorageHelper() {\n    Object(E_current_project_PPH_tfs_Website_website_node_modules_next_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])(this, CustomOptionsStorageHelper);\n  }\n\n  Object(E_current_project_PPH_tfs_Website_website_node_modules_next_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__[/* default */ \"a\"])(CustomOptionsStorageHelper, null, [{\n    key: \"getOrAddVehicleCustomOptions\",\n    value: function getOrAddVehicleCustomOptions(vehicleRef, leasingDealType, setToDefault, values) {\n      var customOptions = this.getVehicleCustomOptions(vehicleRef, leasingDealType);\n\n      if (!customOptions || setToDefault) {\n        customOptions = {\n          vehicleRef: vehicleRef,\n          leasingDealType: leasingDealType,\n          term: environment_siteSettings__WEBPACK_IMPORTED_MODULE_4__[/* SiteSettings */ \"a\"].DefaultTerm,\n          mileage: environment_siteSettings__WEBPACK_IMPORTED_MODULE_4__[/* SiteSettings */ \"a\"].GetDealTypeDefaultMileage(leasingDealType),\n          maintenance: environment_siteSettings__WEBPACK_IMPORTED_MODULE_4__[/* SiteSettings */ \"a\"].DefaultMaintenance,\n          initialRentalMonths: environment_siteSettings__WEBPACK_IMPORTED_MODULE_4__[/* SiteSettings */ \"a\"].DefaultInitialRentals,\n          options: [],\n          salesCode: 0,\n          ageCategory: null,\n          useCheapestTerm: true\n        };\n      }\n\n      Object.assign(customOptions, values || {});\n      this.addOrUpdateVehicleCustomOptions(customOptions);\n      return customOptions;\n    }\n  }, {\n    key: \"addOrUpdateVehicleCustomOptions\",\n    value: function addOrUpdateVehicleCustomOptions(customOptions) {\n      if (customOptions !== null) {\n        var key = this.getOptionsItemKey(customOptions.vehicleRef, customOptions.leasingDealType);\n        localStorage.setItem(key, JSON.stringify(customOptions));\n      }\n    }\n  }, {\n    key: \"getVehicleCustomOptions\",\n    value: function getVehicleCustomOptions(vehicleRef, leasingDealType) {\n      var customOptions = null;\n\n      if (vehicleRef && leasingDealType) {\n        var key = this.getOptionsItemKey(vehicleRef, leasingDealType);\n        var serializedItem = localStorage.getItem(key);\n        customOptions = JSON.parse(serializedItem);\n      }\n\n      return customOptions;\n    }\n  }, {\n    key: \"getOptionsItemKey\",\n    value: function getOptionsItemKey(vehicleRef, leasingDealType) {\n      return (\"options_\" + vehicleRef + \"_\" + leasingDealType).toLowerCase();\n    }\n  }]);\n\n  return CustomOptionsStorageHelper;\n}();\n\n/***/ }),\n\n/***/ \"jmJx\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return GarageStorageHelper; });\n/* harmony import */ var E_current_project_PPH_tfs_Website_website_node_modules_next_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"H+61\");\n/* harmony import */ var E_current_project_PPH_tfs_Website_website_node_modules_next_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"UlJF\");\n/* harmony import */ var E_current_project_PPH_tfs_Website_website_node_modules_next_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"cpVT\");\n/* harmony import */ var underscore__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(\"xG9w\");\n/* harmony import */ var enums_VehicleStorageTypes__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(\"G6YE\");\n/* harmony import */ var helpers_vehiclesStorageProvider__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(\"FK8X\");\n/* harmony import */ var helpers_helpers__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(\"mmV+\");\n\n\n\n\n\n\n\nvar GarageStorageHelper = /*#__PURE__*/function () {\n  function GarageStorageHelper() {\n    Object(E_current_project_PPH_tfs_Website_website_node_modules_next_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])(this, GarageStorageHelper);\n  }\n\n  Object(E_current_project_PPH_tfs_Website_website_node_modules_next_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__[/* default */ \"a\"])(GarageStorageHelper, null, [{\n    key: \"addItem\",\n    value: function addItem(index, item) {\n      if (item && index >= 0 && index < this.storageMaxSize) {\n        var storageItem = {\n          id: Object(helpers_helpers__WEBPACK_IMPORTED_MODULE_6__[/* getGUID */ \"p\"])(),\n          index: index,\n          vehicle: item\n        };\n\n        if (helpers_vehiclesStorageProvider__WEBPACK_IMPORTED_MODULE_5__[/* VehiclesStorageProvider */ \"a\"].addItem(this.storageType, storageItem, index)) {\n          return storageItem;\n        }\n      }\n\n      return null;\n    }\n  }, {\n    key: \"updateItem\",\n    value: function updateItem(itemId, item, alwaysUpdate) {\n      if (item) {\n        var storageItem = helpers_vehiclesStorageProvider__WEBPACK_IMPORTED_MODULE_5__[/* VehiclesStorageProvider */ \"a\"].getItem(this.storageType, itemId);\n\n        if (storageItem && (alwaysUpdate || !underscore__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].isEqual(storageItem.vehicle, item))) {\n          storageItem.vehicle = item;\n\n          if (helpers_vehiclesStorageProvider__WEBPACK_IMPORTED_MODULE_5__[/* VehiclesStorageProvider */ \"a\"].updateItem(this.storageType, storageItem)) {\n            return storageItem;\n          }\n        }\n      }\n\n      return null;\n    }\n  }, {\n    key: \"addOrUpdateItem\",\n    value: function addOrUpdateItem(item) {\n      if (item) {\n        var storageItems = this.getItems(false);\n        var storageItem = storageItems.find(function (storageItem) {\n          return storageItem && storageItem.vehicle && storageItem.vehicle.vehicleRef === item.vehicleRef;\n        });\n\n        if (storageItem) {\n          return this.updateItem(storageItem.id, item, true);\n        } else {\n          var index = storageItems.indexOf(null);\n\n          if (!Object(helpers_helpers__WEBPACK_IMPORTED_MODULE_6__[/* isNullOrEmpty */ \"u\"])(index) && index >= 0 && index < this.storageMaxSize) {\n            return this.addItem(index, item);\n          }\n        }\n      }\n\n      return null;\n    }\n  }, {\n    key: \"cloneItem\",\n    value: function cloneItem(itemId) {\n      var storageItems = this.getItems(false);\n      var itemToClone = storageItems.find(function (item) {\n        return item && item.id === itemId;\n      });\n\n      if (itemToClone) {\n        var index = storageItems.indexOf(null);\n\n        if (!Object(helpers_helpers__WEBPACK_IMPORTED_MODULE_6__[/* isNullOrEmpty */ \"u\"])(index) && index >= 0 && index < this.storageMaxSize) {\n          var clonnedItem = {\n            id: Object(helpers_helpers__WEBPACK_IMPORTED_MODULE_6__[/* getGUID */ \"p\"])(),\n            index: index,\n            vehicle: itemToClone.vehicle //copy not made as data comes from json\n\n          };\n\n          if (helpers_vehiclesStorageProvider__WEBPACK_IMPORTED_MODULE_5__[/* VehiclesStorageProvider */ \"a\"].addItem(this.storageType, clonnedItem, index)) {\n            return clonnedItem;\n          }\n        }\n      }\n\n      return null;\n    }\n  }, {\n    key: \"removeItem\",\n    value: function removeItem(itemId) {\n      return helpers_vehiclesStorageProvider__WEBPACK_IMPORTED_MODULE_5__[/* VehiclesStorageProvider */ \"a\"].removeItem(this.storageType, itemId);\n    }\n  }, {\n    key: \"getItems\",\n    value: function getItems(ignoreEmptyItems) {\n      var result = helpers_vehiclesStorageProvider__WEBPACK_IMPORTED_MODULE_5__[/* VehiclesStorageProvider */ \"a\"].getItems(this.storageType);\n\n      if (result && result.length > 0 && ignoreEmptyItems) {\n        result = result.filter(function (item) {\n          return item;\n        });\n      }\n\n      return result;\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      helpers_vehiclesStorageProvider__WEBPACK_IMPORTED_MODULE_5__[/* VehiclesStorageProvider */ \"a\"].clear(this.storageType);\n    }\n  }, {\n    key: \"countItems\",\n    value: function countItems() {\n      return this.getItems(true).length;\n    }\n  }, {\n    key: \"isFull\",\n    value: function isFull() {\n      return !(this.countItems() < this.storageMaxSize);\n    }\n  }]);\n\n  return GarageStorageHelper;\n}();\n\nObject(E_current_project_PPH_tfs_Website_website_node_modules_next_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_2__[/* default */ \"a\"])(GarageStorageHelper, \"storageType\", enums_VehicleStorageTypes__WEBPACK_IMPORTED_MODULE_4__[/* VehicleStorageTypes */ \"a\"].Garage);\n\nObject(E_current_project_PPH_tfs_Website_website_node_modules_next_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_2__[/* default */ \"a\"])(GarageStorageHelper, \"storageMaxSize\", helpers_vehiclesStorageProvider__WEBPACK_IMPORTED_MODULE_5__[/* VehiclesStorageProvider */ \"a\"].getStorageMaxSize(enums_VehicleStorageTypes__WEBPACK_IMPORTED_MODULE_4__[/* VehicleStorageTypes */ \"a\"].Garage) || 0);\n\n/***/ })\n\n}]);","inputSourceMap":{"version":3,"sources":["E:\\current_project\\PPH\\tfs\\Website\\website\\node_modules\\next\\dist\\build\\webpack\\loaders\\next-babel-loader.js??ref--4!E:\\current_project\\PPH\\tfs\\Website\\website\\components\\vehicle\\_libs\\helpers\\VehicleExtraOptionsHelper.tsx","E:\\current_project\\PPH\\tfs\\Website\\website\\node_modules\\next\\dist\\build\\webpack\\loaders\\next-babel-loader.js??ref--4!E:\\current_project\\PPH\\tfs\\Website\\website\\components\\vehicle\\_libs\\VehicleExtraOptionsManager.tsx","E:\\current_project\\PPH\\tfs\\Website\\website\\node_modules\\next\\dist\\build\\webpack\\loaders\\next-babel-loader.js??ref--4!E:\\current_project\\PPH\\tfs\\Website\\website\\helpers\\vehiclePricingHelper.tsx","E:\\current_project\\PPH\\tfs\\Website\\website\\node_modules\\next\\dist\\build\\webpack\\loaders\\next-babel-loader.js??ref--4!E:\\current_project\\PPH\\tfs\\Website\\website\\helpers\\vehiclesStorageProvider.tsx","E:\\current_project\\PPH\\tfs\\Website\\website\\node_modules\\next\\dist\\build\\webpack\\loaders\\next-babel-loader.js??ref--4!E:\\current_project\\PPH\\tfs\\Website\\website\\enums\\VehicleStorageTypes.tsx","E:\\current_project\\PPH\\tfs\\Website\\website\\node_modules\\next\\dist\\build\\webpack\\loaders\\next-babel-loader.js??ref--4!E:\\current_project\\PPH\\tfs\\Website\\website\\components\\layout\\popover\\popover.tsx","E:\\current_project\\PPH\\tfs\\Website\\website\\node_modules\\next\\dist\\build\\webpack\\loaders\\next-babel-loader.js??ref--4!E:\\current_project\\PPH\\tfs\\Website\\website\\components\\vehicle\\vehicle-extra-options-relationships-manager\\vehicle-extra-options-relationships-manager.tsx","E:\\current_project\\PPH\\tfs\\Website\\website\\node_modules\\next\\dist\\build\\webpack\\loaders\\next-babel-loader.js??ref--4!E:\\current_project\\PPH\\tfs\\Website\\website\\components\\vehicle\\vehicle-extra-options-confirm-modal\\vehicle-extra-options-confirm-modal.tsx","E:\\current_project\\PPH\\tfs\\Website\\website\\node_modules\\next\\dist\\build\\webpack\\loaders\\next-babel-loader.js??ref--4!E:\\current_project\\PPH\\tfs\\Website\\website\\helpers\\customOptionsHelper.tsx","E:\\current_project\\PPH\\tfs\\Website\\website\\node_modules\\next\\dist\\build\\webpack\\loaders\\next-babel-loader.js??ref--4!E:\\current_project\\PPH\\tfs\\Website\\website\\components\\garage\\_libs\\helpers\\garageStorageHelper.tsx"],"names":[],"mappings":";;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAkJ;AACN;AACM;AACvH;AACpB;AACP;AACA,IAAI,yKAAe;AACnB;;AAEA,EAAE,sKAAY;AACd;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,gHAAgH,0DAAC;AACjH,eAAe,0DAAC;AAChB,OAAO;AACP;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,uDAAuD,0DAAC;;AAExD;AACA;AACA,cAAc,0DAAC;AACf,kCAAkC,0DAAC;AACnC;AACA,iBAAiB;;AAEjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,oDAAoD,0DAAC;AACrD,eAAe;AACf,aAAa;AACb;AACA;AACA,kCAAkC,0DAAC;AACnC;AACA,iBAAiB;;AAEjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,kDAAkD,0DAAC;AACnD;;AAEA;AACA,yCAAyC,0DAAC;AAC1C;AACA,eAAe;AACf;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA,aAAa,0DAAC;AACd;AACA;AACA,+BAA+B,0DAAC;AAChC,iCAAiC,0DAAC;AAClC,oBAAoB,0DAAC;AACrB;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA,0BAA0B,0DAAC;AAC3B,yBAAyB,0DAAC;AAC1B,SAAS;AACT;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA,gCAAgC,0DAAC;AACjC,yBAAyB,0DAAC,mDAAmD,0DAAC,8DAA8D,0DAAC;AAC7I,SAAS;AACT;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA,wCAAwC,0DAAC;AACzC,wCAAwC,0DAAC;AACzC;AACA;;AAEA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA;AACA;AACA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,2BAA2B,0DAAC,OAAO,0DAAC;AACpC;AACA,SAAS;AACT,6BAA6B,0DAAC,OAAO,0DAAC;AACtC;AACA,SAAS;AACT;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA,8BAA8B,0DAAC;AAC/B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,0BAA0B,0DAAC;AAC3B;AACA;AACA;AACA;AACA,SAAS;AACT,8BAA8B,0DAAC;AAC/B;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA,aAAa,0DAAC;AACd;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA,aAAa,0DAAC;AACd;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA,aAAa,0DAAC;AACd;AACA,OAAO;AACP;AACA,GAAG;;AAEH;AACA,CAAC;;AAED,yKAAe,8F;;;;;;;;AClWf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAkJ;AACN;AACM;AACvH;AACqD;AACzE;AACP;AACA,IAAI,yKAAe;;AAEnB,IAAI,yKAAe;;AAEn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ACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA,CAAC,G;;;;;;;;ACzdD;AAAA;AAAA;AAA0D;AACnD;AACP;;AAEA;AACA,gCAAgC,+EAAgB;AAChD;AACA;;AAEA;AACA;AACO;AACP;AACA;AACA;;AAEA;AACA,E;;;;;;;;ACjBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAkJ;AACN;AAC5E;AACN;AACV;AACzC;AACP;AACA,IAAI,yKAAe;AACnB;;AAEA,EAAE,sKAAY;AACd;AACA;AACA;AACA,aAAa,qFAAmB;AAChC;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,aAAa,qFAAmB;AAChC;;AAEA,aAAa,qFAAmB;AAChC;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,aAAa,qFAAmB;AAChC;;AAEA,aAAa,qFAAmB;AAChC;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA,WAAW,uFAAkB;AAC7B;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA,uBAAuB,gBAAgB;AACvC;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,2BAA2B,6EAAa;;AAExC;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA,WAAW,uFAAkB;AAC7B;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA,WAAW,uFAAkB;AAC7B;AACA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA,CAAC,G;;;;;;;;ACnKD;AAAO;;AAEP;AACA;AACA;AACA;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Ae;AACnB;;AAEA,EAAE,sKAAY;AACd;AACA;AACA;AACA;AACA;AACA,yCAAyC,0EAAc;;AAEvD;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA,qBAAqB,gFAAkB;AACvC;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,QAAQ,yGAA2B;AACnC;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,SAAS;AACT,OAAO;AACP;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;AACM;AACP;AACA,IAAI,yKAAe;AACnB;;AAEA,EAAE,sKAAY;AACd;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,gBAAgB,6EAAY;AAC5B,mBAAmB,6EAAY;AAC/B,uBAAuB,6EAAY;AACnC,+BAA+B,6EAAY;AAC3C;AACA;AACA;AACA;AACA;AACA;;AAEA,+CAA+C;AAC/C;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC,G;;;;;;;;AClJD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAkJ;AACN;AACM;AACvH;AACqC;AACU;AACjB;AAClD;AACP;AACA,IAAI,yKAAe;AACnB;;AAEA,EAAE,sKAAY;AACd;AACA;AACA;AACA;AACA,cAAc,uEAAO;AACrB;AACA;AACA;;AAEA,YAAY,+FAAuB;AACnC;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,0BAA0B,+FAAuB;;AAEjD,6CAA6C,0DAAC;AAC9C;;AAEA,cAAc,+FAAuB;AACrC;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA,SAAS;AACT;;AAEA,eAAe,6EAAa;AAC5B;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;;AAEA,aAAa,6EAAa;AAC1B;AACA,gBAAgB,uEAAO;AACvB;AACA;;AAEA;;AAEA,cAAc,+FAAuB;AACrC;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA,aAAa,+FAAuB;AACpC;AACA,GAAG;AACH;AACA;AACA,mBAAmB,+FAAuB;;AAE1C;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA,MAAM,+FAAuB;AAC7B;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED,yKAAe,qCAAqC,qFAAmB;;AAEvE,yKAAe,wCAAwC,+FAAuB,mBAAmB,qFAAmB,e","file":"x","sourcesContent":["import _classCallCheck from \"E:/current_project/PPH/tfs/Website/website/node_modules/next/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"E:/current_project/PPH/tfs/Website/website/node_modules/next/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _defineProperty from \"E:/current_project/PPH/tfs/Website/website/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _ from 'underscore';\nexport var VehicleExtraOptionsHelper = /*#__PURE__*/function () {\n  function VehicleExtraOptionsHelper() {\n    _classCallCheck(this, VehicleExtraOptionsHelper);\n  }\n\n  _createClass(VehicleExtraOptionsHelper, null, [{\n    key: \"getRelationshipDescription\",\n    value: function getRelationshipDescription(relationshipType) {\n      var result = null;\n\n      if (relationshipType) {\n        switch (relationshipType.toUpperCase()) {\n          case \"OO\":\n            result = \"From the options below, a maximum of one may be selected. For example, you can only have one type of paintwork.\";\n            break;\n\n          case \"RO\":\n            result = \"The option you have chosen must be accompanied by at least one of the additional options in the group below.\";\n            break;\n\n          case \"RA\":\n            result = \"The option you have chosen must be accompanied by all of the additional options in the group below.\";\n            break;\n\n          case \"NW\":\n            result = \"The option you have chosen cannot be accompanied by any of the options in the group below. For example if wood inlay is chosen it cannot be accompanied by any cloth trim.\";\n            break;\n\n          case \"IN\":\n            result = \"Please note the options below are included (at no extra cost) with the option you have chosen which comes as a pack.\";\n            break;\n\n          case \"IO\":\n            result = \"The option you have chosen must be accompanied by one option from the group below. The additional option will be no extra cost.\";\n            break;\n        }\n      }\n\n      return result ? result : relationshipType;\n    }\n  }, {\n    key: \"getSelectedOptions\",\n    value: function getSelectedOptions(options, selectedOptionIds) {\n      var selectedOptions = [];\n      if (options && options.length > 0 && selectedOptionIds && selectedOptionIds.length > 0) selectedOptions = _.filter(options, function (option) {\n        return _.contains(selectedOptionIds, option.id);\n      });\n      return selectedOptions;\n    }\n  }, {\n    key: \"getOptionsPrice\",\n    value: function getOptionsPrice(options, optionsStates) {\n      var result = 0;\n\n      if (options) {\n        var self = this;\n        options.forEach(function (option) {\n          result += self.getOptionPrice(option, optionsStates);\n        });\n      }\n\n      return result;\n    }\n  }, {\n    key: \"getOptionPrice\",\n    value: function getOptionPrice(option, optionsStates) {\n      var result = 0;\n\n      if (option) {\n        var optionState = this._getOptionState(optionsStates, option.id);\n\n        result = this._getOptionPrice(option, optionState);\n      }\n\n      return result;\n    }\n  }, {\n    key: \"getOptionsStates\",\n    value: function getOptionsStates(optionIds, relationships) {\n      var optionsStates = [];\n\n      if (optionIds && relationships) {\n        var filteredRelationships = this.getRelationships(relationships, optionIds);\n        filteredRelationships.forEach(function (relationship) {\n          var primaryOptionIds = relationship.primaryOptionIds;\n          var regularOptionIds = relationship.regularOptionIds;\n          var isActive = relationship.type === \"OO\" || _.intersection(primaryOptionIds, optionIds).length === primaryOptionIds.length;\n\n          if (isActive) {\n            if (relationship.type == \"OO\") {\n              _.difference(regularOptionIds, optionIds).forEach(function (optionId) {\n                var optionState = _.find(optionsStates, function (option) {\n                  return option.id === optionId;\n                });\n\n                if (!optionState) {\n                  optionState = {\n                    id: optionId,\n                    selectionRequiredBy: [],\n                    deselectionRequiredBy: []\n                  };\n                  optionsStates.push(optionState);\n                }\n\n                optionState.deselectionRequiredBy = _.union(optionState.deselectionRequiredBy, [-1]);\n              });\n            } else if (relationship.type == \"RA\" || relationship.type == \"IN\") {\n              var isMirror = relationship.mirrorRelationshipIds && relationship.mirrorRelationshipIds.length > 0;\n              regularOptionIds.forEach(function (optionId) {\n                var optionState = _.find(optionsStates, function (option) {\n                  return option.id === optionId;\n                });\n\n                if (!optionState) {\n                  optionState = {\n                    id: optionId,\n                    selectionRequiredBy: [],\n                    deselectionRequiredBy: [],\n                    mirrorIn: []\n                  };\n                  optionsStates.push(optionState);\n                }\n\n                optionState.selectionRequiredBy = _.union(optionState.selectionRequiredBy, [relationship.id]);\n                optionState.useZeroPrice = optionState.useZeroPrice || relationship.type === \"IN\";\n\n                if (isMirror) {\n                  optionState.mirrorIn = _.union(optionState.mirrorIn, [relationship.id], relationship.mirrorRelationshipIds);\n                }\n              });\n            }\n          }\n        });\n      }\n\n      return optionsStates;\n    }\n  }, {\n    key: \"cloneOptionsStates\",\n    value: function cloneOptionsStates(optionsStates) {\n      return _.map(optionsStates, function (optionState) {\n        var result = {\n          id: optionState.id,\n          selectionRequiredBy: _.clone(optionState.selectionRequiredBy),\n          deselectionRequiredBy: _.clone(optionState.deselectionRequiredBy),\n          mirrorIn: _.clone(optionState.mirrorIn),\n          useZeroPrice: optionState.useZeroPrice\n        };\n        return result;\n      });\n    }\n  }, {\n    key: \"getOptionsWithoutRelationships\",\n    value: function getOptionsWithoutRelationships(options, optionIds) {\n      var filteredOptions = [];\n\n      if (optionIds && optionIds.length > 0) {\n        filteredOptions = _.filter(options || [], function (item) {\n          return item && _.contains(optionIds, item.id) && (!item.linkedRelationshipIds || item.linkedRelationshipIds.length === 0);\n        });\n      }\n\n      return filteredOptions;\n    }\n  }, {\n    key: \"getRelationships\",\n    value: function getRelationships(relationships, optionIds) {\n      var filteredRelationships = [];\n      var allowedRelationshipTypes = this.allowedRelationshipTypes;\n\n      if (optionIds && optionIds.length > 0) {\n        filteredRelationships = _.filter(relationships || [], function (item) {\n          return item && _.contains(allowedRelationshipTypes, item.type) && (_.intersection(optionIds, item.primaryOptionIds).length > 0 || _.intersection(optionIds, item.regularOptionIds).length > 0);\n        });\n      }\n\n      return filteredRelationships;\n    }\n  }, {\n    key: \"getConfirmRelationship\",\n    value: function getConfirmRelationship(relationships, vehicleOptions, relationshipId, selectedOptionIds, optionsStates) {\n      var confirmRelationship = null;\n\n      if (relationships && relationships.length > 0) {\n        var relationship = this._getRelationship(relationships, relationshipId);\n\n        if (relationship) {\n          confirmRelationship = {\n            id: relationship.id,\n            type: relationship.type,\n            options: []\n          };\n\n          var relationshipPrimaryOptions = this._getRelationshipOptions(relationship, vehicleOptions, true, selectedOptionIds, optionsStates);\n\n          var relationshipRegularOptions = this._getRelationshipOptions(relationship, vehicleOptions, false, selectedOptionIds, optionsStates);\n\n          confirmRelationship.options = _.union(confirmRelationship.options, relationshipPrimaryOptions);\n          confirmRelationship.options = _.union(confirmRelationship.options, relationshipRegularOptions);\n        }\n      }\n\n      return confirmRelationship;\n    } //is not used at the moment\n    //public static disableConfirmRelationshipOptions(confirmRelationship: ExtraOptionConfirmRelationship, selectedOptionIds: number[]) {\n    //    if (confirmRelationship.type !== \"OO\") {\n    //        let relationshipPrimaryOptions: ExtraOptionRelationshipOption[] = _.filter(confirmRelationship.options,\n    //            function (relationshipOption: ExtraOptionRelationshipOption) {\n    //                return relationshipOption.isPrimary;\n    //            });\n    //        let relationshipRegularOptions: ExtraOptionRelationshipOption[] = _.filter(confirmRelationship.options,\n    //            function (relationshipOption: ExtraOptionRelationshipOption) {\n    //                return !relationshipOption.isPrimary;\n    //            });\n    //        let relationshipPrimaryOptionIds: number[] = _.pluck(relationshipPrimaryOptions, 'id');\n    //        let relationshipRegularOptionIds: number[] = _.pluck(relationshipRegularOptions, 'id');\n    //        let activeRule = _.intersection(relationshipPrimaryOptionIds, selectedOptionIds).length === relationshipPrimaryOptionIds.length;\n    //        if (confirmRelationship.type == \"RA\" || confirmRelationship.type == \"IN\" || confirmRelationship.type == \"NW\") {\n    //            relationshipRegularOptions.forEach(function (relationshipOption) {\n    //                relationshipOption.isDisabled = activeRule;\n    //            });\n    //        }\n    //        else if (confirmRelationship.type == \"RO\" || confirmRelationship.type == \"IO\") {\n    //            //IO is a separate case\n    //            if (activeRule) {\n    //                let selectedIds: number[] = _.intersection(selectedOptionIds, relationshipRegularOptionIds);\n    //                if (selectedIds.length == 1) {\n    //                    relationshipRegularOptions.forEach(function (relationshipOption) {\n    //                        relationshipOption.isDisabled = relationshipOption.id === selectedIds[0];\n    //                    });\n    //                }\n    //            }\n    //        }\n    //    }\n    //}\n\n  }, {\n    key: \"splitOptionIdsByAction\",\n    value: function splitOptionIdsByAction(optionsToProcess) {\n      var result = {\n        selectIds: [],\n        deselectIds: []\n      };\n\n      if (optionsToProcess && optionsToProcess.length > 0) {\n        result.selectIds = _.pluck(_.filter(optionsToProcess, function (option) {\n          return option.selectionRequiredBy.length > 0;\n        }), \"id\");\n        result.deselectIds = _.pluck(_.filter(optionsToProcess, function (option) {\n          return option.deselectionRequiredBy.length > 0;\n        }), \"id\");\n      }\n\n      return result;\n    }\n  }, {\n    key: \"getOptionAction\",\n    value: function getOptionAction(option, selectedOptionIds) {\n      var result = null;\n\n      if (option && !option.isDisabled) {\n        var optionId = option.id;\n        var isSelectAction = !_.contains(selectedOptionIds || [], optionId);\n        result = {\n          id: optionId,\n          selectionRequiredBy: isSelectAction ? [0] : [],\n          deselectionRequiredBy: !isSelectAction ? [0] : []\n        };\n      }\n\n      return result;\n    }\n  }, {\n    key: \"optionExists\",\n    value: function optionExists(optionId, vehicleOptions) {\n      var option = this._getOption(vehicleOptions, optionId);\n\n      if (option) {\n        return true;\n      }\n\n      return false;\n    }\n  }, {\n    key: \"_getRelationshipOptions\",\n    value: function _getRelationshipOptions(relationship, vehicleOptions, primary, selectedOptionIds, optionsStates) {\n      var relationshipOptions = [];\n\n      if (relationship !== null && vehicleOptions != null && vehicleOptions.length > 0) {\n        var self = this;\n        var ids = primary ? relationship.primaryOptionIds : relationship.regularOptionIds;\n        (ids || []).forEach(function (id) {\n          var option = self._getOption(vehicleOptions, id);\n\n          if (option) {\n            var optionState = self._getOptionState(optionsStates, option.id);\n\n            var relationshipOption = {\n              id: option.id,\n              name: option.name,\n              isPrimary: primary,\n              price: self._getOptionPrice(option, optionState),\n              isSelected: _.contains(selectedOptionIds || [], option.id),\n              isDisabled: false\n            };\n            relationshipOptions.push(relationshipOption);\n          }\n        });\n        relationshipOptions = _.sortBy(relationshipOptions, 'name');\n      }\n\n      return relationshipOptions;\n    }\n  }, {\n    key: \"_getOptionPrice\",\n    value: function _getOptionPrice(option, optionState) {\n      var result = 0;\n\n      if (option) {\n        result = optionState && optionState.useZeroPrice ? 0 : option.price;\n      }\n\n      return result;\n    }\n  }, {\n    key: \"_getOptionState\",\n    value: function _getOptionState(optionsStates, id) {\n      return _.find(optionsStates, function (item) {\n        return item && item.id === id;\n      });\n    }\n  }, {\n    key: \"_getOption\",\n    value: function _getOption(vehicleOptions, id) {\n      return _.find(vehicleOptions, function (item) {\n        return item && item.id === id;\n      });\n    }\n  }, {\n    key: \"_getRelationship\",\n    value: function _getRelationship(relationships, id) {\n      return _.find(relationships, function (item) {\n        return item && item.id === id;\n      });\n    }\n  }]);\n\n  return VehicleExtraOptionsHelper;\n}();\n\n_defineProperty(VehicleExtraOptionsHelper, \"allowedRelationshipTypes\", [\"OO\", \"RO\", \"RA\", \"NW\", \"IN\", \"IO\"]);","import _classCallCheck from \"E:/current_project/PPH/tfs/Website/website/node_modules/next/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"E:/current_project/PPH/tfs/Website/website/node_modules/next/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _defineProperty from \"E:/current_project/PPH/tfs/Website/website/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _ from 'underscore';\nimport { VehicleExtraOptionsHelper } from './helpers/VehicleExtraOptionsHelper';\nexport var VehicleExtraOptionsManager = /*#__PURE__*/function () {\n  function VehicleExtraOptionsManager() {\n    _classCallCheck(this, VehicleExtraOptionsManager);\n\n    _defineProperty(this, \"_vehicleOptions\", []);\n\n    _defineProperty(this, \"_vehicleOptionRelationships\", []);\n\n    _defineProperty(this, \"_selectedOptionIds\", []);\n\n    _defineProperty(this, \"_confirmRelationshipIds\", []);\n\n    _defineProperty(this, \"_optionsStates\", []);\n  }\n\n  _createClass(VehicleExtraOptionsManager, [{\n    key: \"_clearMangerState\",\n    value: function _clearMangerState() {\n      this._confirmRelationshipIds = [];\n      this._selectedOptionIds = [];\n      this._optionsStates = [];\n    }\n  }, {\n    key: \"init\",\n    value: function init(options, relationships) {\n      this._vehicleOptions = options || [];\n      this._vehicleOptionRelationships = relationships || [];\n\n      this._clearMangerState();\n    }\n  }, {\n    key: \"processOptions\",\n    value: function processOptions(optionsToProcess) {\n      var confirmRelationshipIds = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n      var selectedOptionIds = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n      var optionsStates = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n\n      this._clearMangerState();\n\n      this._selectedOptionIds = _.clone(selectedOptionIds || []);\n      this._confirmRelationshipIds = _.clone(confirmRelationshipIds || []);\n      this._optionsStates = VehicleExtraOptionsHelper.cloneOptionsStates(optionsStates || []);\n      var silentlySelectedOptionIds = null;\n\n      if (optionsToProcess && optionsToProcess.length > 0) {\n        var _selectedOptionIds = _.clone(this._selectedOptionIds);\n\n        var optionIdsByAction = VehicleExtraOptionsHelper.splitOptionIdsByAction(optionsToProcess);\n\n        if (_.intersection(optionIdsByAction.selectIds, optionIdsByAction.deselectIds).length > 0) {\n          alert(\"Action is not allowed.\");\n          return null;\n        }\n\n        var forSilentSelect = _.pluck(VehicleExtraOptionsHelper.getOptionsWithoutRelationships(this._vehicleOptions, optionIdsByAction.selectIds), 'id');\n\n        var forSilentDeselect = _.pluck(VehicleExtraOptionsHelper.getOptionsWithoutRelationships(this._vehicleOptions, optionIdsByAction.deselectIds), 'id');\n\n        var optionIdsForSilentApply = _.union(forSilentSelect, forSilentDeselect);\n\n        if (optionIdsForSilentApply.length > 0) {\n          _selectedOptionIds = _.union(_selectedOptionIds, forSilentSelect);\n          _selectedOptionIds = _.difference(_selectedOptionIds, forSilentDeselect);\n          this._selectedOptionIds = _.clone(_selectedOptionIds);\n          silentlySelectedOptionIds = _.clone(_selectedOptionIds);\n        }\n\n        var optionsToConfirm = _.filter(optionsToProcess, function (optionToProcess) {\n          return !_.contains(optionIdsForSilentApply, optionToProcess.id);\n        });\n\n        if (optionsToConfirm != null && optionsToConfirm.length > 0) {\n          var confirmDetails = this._getConfirmDetails(optionsToConfirm, _selectedOptionIds, this._confirmRelationshipIds, this._optionsStates);\n\n          if (confirmDetails.hasConflicts) {\n            alert(\"Action is not allowed.\");\n            return null;\n          }\n\n          var optionsForSilentApply = _.filter(optionsToConfirm, function (option) {\n            var notAny = !_.some(confirmDetails.confirmRelationships, function (confirmRelationship) {\n              var contains = _.contains(confirmRelationship.optionIds, option.id);\n\n              return contains;\n            });\n            return notAny;\n          });\n\n          if (optionsForSilentApply.length > 0) {\n            silentlySelectedOptionIds = _.clone(this._selectedOptionIds);\n            optionIdsByAction = VehicleExtraOptionsHelper.splitOptionIdsByAction(optionsForSilentApply);\n            silentlySelectedOptionIds = _.union(silentlySelectedOptionIds, optionIdsByAction.selectIds);\n            silentlySelectedOptionIds = _.difference(silentlySelectedOptionIds, optionIdsByAction.deselectIds);\n          }\n\n          this._selectedOptionIds = confirmDetails.selectedOptionIds;\n          this._confirmRelationshipIds = _.pluck(confirmDetails.confirmRelationships, \"id\");\n          this._optionsStates = confirmDetails.optionsStates;\n        }\n      }\n\n      var result = {\n        selectedOptionIds: _.clone(this._selectedOptionIds),\n        confirmRelationshipIds: _.clone(this._confirmRelationshipIds),\n        optionsStates: _.clone(this._optionsStates),\n        silentlySelectedOptionIds: silentlySelectedOptionIds\n      };\n      return result;\n    }\n  }, {\n    key: \"_getConfirmDetails\",\n    value: function _getConfirmDetails(optionsToConfirm, initialSelectedOptionIds, initialConfirmReationshipIds, initialOptionsStates) {\n      var _this = this;\n\n      var result = {\n        hasConflicts: false,\n        selectedOptionIds: [],\n        confirmRelationships: [],\n        optionsStates: []\n      };\n\n      if (optionsToConfirm && optionsToConfirm.length > 0) {\n        (function () {\n          var currentSelectedOptionIds = _.clone(initialSelectedOptionIds || []);\n\n          var currentPendingRelationshipIds = _.clone(initialConfirmReationshipIds || []);\n\n          var currentOptionsStates = VehicleExtraOptionsHelper.cloneOptionsStates(initialOptionsStates || []);\n\n          var iterationOptions = _.clone(optionsToConfirm);\n\n          var iterationResult = _this._getConfirmDetailsIteration(iterationOptions, currentSelectedOptionIds, currentOptionsStates);\n\n          while (iterationResult) {\n            if (iterationResult.hasConflicts) {\n              result.hasConflicts = true;\n              break;\n            }\n\n            iterationOptions.forEach(function (iterationOptionState) {\n              var optionState = _.find(currentOptionsStates, function (optionState) {\n                return optionState.id === iterationOptionState.id;\n              });\n\n              if (!optionState) {\n                optionState = {\n                  id: iterationOptionState.id,\n                  selectionRequiredBy: [],\n                  deselectionRequiredBy: [],\n                  mirrorIn: []\n                };\n                currentOptionsStates.push(optionState);\n              }\n\n              optionState.selectionRequiredBy = _.union(optionState.selectionRequiredBy, _.difference(iterationOptionState.selectionRequiredBy, [-1]));\n              optionState.deselectionRequiredBy = _.union(optionState.deselectionRequiredBy, _.difference(iterationOptionState.deselectionRequiredBy, [-1]));\n              optionState.mirrorIn = _.union(optionState.mirrorIn, iterationOptionState.mirrorIn);\n            });\n\n            if (iterationResult.recallRestrictionRelationshipIds) {\n              currentOptionsStates.forEach(function (optionState) {\n                optionState.selectionRequiredBy = _.difference(optionState.selectionRequiredBy, iterationResult.recallRestrictionRelationshipIds);\n                optionState.deselectionRequiredBy = _.difference(optionState.deselectionRequiredBy, iterationResult.recallRestrictionRelationshipIds);\n              });\n            }\n\n            var selectIds = _.pluck(_.filter(iterationOptions, function (option) {\n              return option.selectionRequiredBy.length > 0;\n            }), \"id\");\n\n            var deselectIds = _.pluck(_.filter(iterationOptions, function (option) {\n              return option.deselectionRequiredBy.length > 0;\n            }), \"id\");\n\n            currentSelectedOptionIds = _.difference(_.union(currentSelectedOptionIds, selectIds), deselectIds);\n            currentPendingRelationshipIds = _.union(currentPendingRelationshipIds, iterationResult.confirmRelationshipIds);\n            iterationOptions = iterationResult.nextIterationOptions;\n            iterationResult = _this._getConfirmDetailsIteration(iterationOptions, currentSelectedOptionIds, currentOptionsStates);\n          }\n\n          if (!result.hasConflicts) {\n            var self = _this;\n            var optionsStates = currentOptionsStates;\n            var selectedOptionIds = currentSelectedOptionIds;\n            var confirmRelationships = [];\n            currentPendingRelationshipIds.forEach(function (relationshipId) {\n              var relationship = _.find(self._vehicleOptionRelationships, function (item) {\n                return item && item.id === relationshipId;\n              });\n\n              if (relationship) {\n                var optionIds = [];\n                optionIds = _.union(optionIds, relationship.primaryOptionIds);\n                optionIds = _.union(optionIds, relationship.regularOptionIds);\n                optionIds = _.filter(optionIds, function (id) {\n                  return VehicleExtraOptionsHelper.optionExists(id, self._vehicleOptions);\n                });\n\n                if (optionIds.length > 0) {\n                  confirmRelationships.push({\n                    id: relationshipId,\n                    optionIds: optionIds\n                  });\n                }\n              }\n            }); //process empty RO, IO here\n            //wrong, should be applied processed items which not covered by confirm rules\n            //if ((!confirmRelationships || confirmRelationships.length === 0) && silentApplyAllowed && selectedOptionIds.length > 0) {\n            //    if (this.onApply) {\n            //        this.onApply(_.clone(selectedOptionIds));\n            //    }\n            //}\n            //cleanup confirm relationships\n            //--------------------------\n\n            var emptyRelationships = _.filter(confirmRelationships, function (item) {\n              return _.intersection(item.optionIds, selectedOptionIds).length == 0;\n            });\n\n            if (confirmRelationships.length > emptyRelationships.length) {\n              confirmRelationships = _.filter(confirmRelationships, function (item) {\n                return _.intersection(item.optionIds, selectedOptionIds).length > 0;\n              });\n            } //--------------------------\n            //confirmRelationships.forEach(function (confirmRelationship) {\n            //    VehicleExtraOptionsHelper.disableConfirmRelationshipOptions(confirmRelationship, selectedOptionIds);\n            //});\n\n\n            var zeroPriceOptionIds = [];\n\n            var activeINRelationships = _.filter(_this._vehicleOptionRelationships, function (relationship) {\n              return relationship && _.contains(VehicleExtraOptionsHelper.allowedRelationshipTypes, relationship.type) && relationship.type === \"IN\" && _.intersection(selectedOptionIds, relationship.primaryOptionIds).length === relationship.primaryOptionIds.length;\n            });\n\n            if (activeINRelationships && activeINRelationships.length > 0) {\n              activeINRelationships.forEach(function (relationship) {\n                zeroPriceOptionIds = _.union(zeroPriceOptionIds, relationship.regularOptionIds);\n              });\n            }\n\n            optionsStates.forEach(function (optionState) {\n              optionState.useZeroPrice = _.contains(zeroPriceOptionIds, optionState.id);\n              optionState.selectionRequiredBy = _.without(optionState.selectionRequiredBy, 0);\n              optionState.deselectionRequiredBy = _.without(optionState.deselectionRequiredBy, 0);\n            });\n            result.optionsStates = optionsStates;\n            result.selectedOptionIds = selectedOptionIds;\n            result.confirmRelationships = confirmRelationships;\n          }\n        })();\n      }\n\n      return result;\n    }\n  }, {\n    key: \"_getConfirmDetailsIteration\",\n    value: function _getConfirmDetailsIteration(iterationOptions, selectedOptionIds, optionsStates) {\n      var _this2 = this;\n\n      if (iterationOptions && iterationOptions.length > 0) {\n        var _ret = function () {\n          var hasConflicts = false;\n          var confirmRelationshipIds = [];\n          var nextIterationOptions = [];\n          var recallRestrictionRelationshipIds = [];\n          var requiredOptionIdsByAction = VehicleExtraOptionsHelper.splitOptionIdsByAction(iterationOptions);\n          hasConflicts = _.intersection(requiredOptionIdsByAction.selectIds, requiredOptionIdsByAction.deselectIds).length > 0;\n\n          if (!hasConflicts) {\n            var uniqueSelectIds = _.difference(requiredOptionIdsByAction.selectIds, selectedOptionIds);\n\n            var uniqueDeselectIds = _.intersection(requiredOptionIdsByAction.deselectIds, selectedOptionIds);\n\n            var iterationSelectedOptionIds = _.difference(_.union(selectedOptionIds, uniqueSelectIds), uniqueDeselectIds);\n\n            var relationshipsToConfirm = VehicleExtraOptionsHelper.getRelationships(_this2._vehicleOptionRelationships, _.union(uniqueSelectIds, uniqueDeselectIds));\n\n            if (relationshipsToConfirm && relationshipsToConfirm.length > 0) {\n              var _loop = function _loop(relationshipIdx) {\n                var relationshipToConfirm = relationshipsToConfirm[relationshipIdx];\n                var primaryOptionIds = relationshipToConfirm.primaryOptionIds;\n                var regularOptionIds = relationshipToConfirm.regularOptionIds;\n\n                var optionIds = _.union(primaryOptionIds, regularOptionIds);\n\n                var selectIntersection = _.intersection(optionIds, uniqueSelectIds);\n\n                var deselectIntersection = _.intersection(optionIds, uniqueDeselectIds);\n\n                if (selectIntersection.length > 0 && deselectIntersection.length > 0) {} else if (selectIntersection.length > 0) {\n                  var isActive = relationshipToConfirm.type === \"OO\" || _.intersection(primaryOptionIds, iterationSelectedOptionIds).length === primaryOptionIds.length;\n\n                  if (!isActive) {\n                    return \"continue\";\n                  }\n\n                  var _loop2 = function _loop2(i) {\n                    var optionId = selectIntersection[0];\n\n                    var optionState = _.find(optionsStates, function (optionState) {\n                      return optionState.id === optionId;\n                    });\n\n                    if (optionState) {\n                      if (_.difference(optionState.deselectionRequiredBy, [relationshipToConfirm.id, -1]).length > 0) {\n                        hasConflicts = true;\n                        return \"break\";\n                      }\n                    }\n                  };\n\n                  for (var i = 0; i < selectIntersection.length; i++) {\n                    var _ret3 = _loop2(i);\n\n                    if (_ret3 === \"break\") break;\n                  }\n\n                  if (hasConflicts) {\n                    return \"break\";\n                  }\n\n                  if (relationshipToConfirm.type == \"OO\") {\n                    if (selectIntersection.length > 1) {\n                      hasConflicts = true;\n                      return \"break\";\n                    } else {\n                      var selectOptionState = _.find(optionsStates, function (optionState) {\n                        return optionState.id === selectIntersection[0];\n                      }); //if (selectOptionState) {\n                      //    selectOptionState.deselectionRequiredBy = _.without(selectOptionState.deselectionRequiredBy, relationshipToConfirm.id);\n                      //}\n\n\n                      _.difference(regularOptionIds, selectIntersection).forEach(function (optionId) {\n                        var nextIterationOption = _.find(nextIterationOptions, function (option) {\n                          return option.id === optionId;\n                        });\n\n                        if (!nextIterationOption) {\n                          nextIterationOption = {\n                            id: optionId,\n                            selectionRequiredBy: [],\n                            deselectionRequiredBy: []\n                          };\n                          nextIterationOptions.push(nextIterationOption);\n                        }\n\n                        nextIterationOption.deselectionRequiredBy = _.union(nextIterationOption.deselectionRequiredBy, [-1]);\n                      });\n                    }\n                  } else if (relationshipToConfirm.type == \"RA\" || relationshipToConfirm.type == \"IN\") {\n                    var isMirror = relationshipToConfirm.mirrorRelationshipIds && relationshipToConfirm.mirrorRelationshipIds.length > 0;\n                    regularOptionIds.forEach(function (optionId) {\n                      var nextIterationOption = _.find(nextIterationOptions, function (option) {\n                        return option.id === optionId;\n                      });\n\n                      if (!nextIterationOption) {\n                        nextIterationOption = {\n                          id: optionId,\n                          selectionRequiredBy: [],\n                          deselectionRequiredBy: [],\n                          mirrorIn: []\n                        };\n                        nextIterationOptions.push(nextIterationOption);\n                      }\n\n                      nextIterationOption.selectionRequiredBy = _.union(nextIterationOption.selectionRequiredBy, [relationshipToConfirm.id]);\n\n                      if (isMirror) {\n                        nextIterationOption.mirrorIn = _.union(nextIterationOption.mirrorIn, [relationshipToConfirm.id], relationshipToConfirm.mirrorRelationshipIds);\n                      }\n                    });\n                  }\n\n                  confirmRelationshipIds = _.union(confirmRelationshipIds, [relationshipToConfirm.id]);\n                } else if (deselectIntersection.length > 0) {\n                  var _loop3 = function _loop3(_i) {\n                    var optionId = deselectIntersection[_i];\n\n                    var optionState = _.find(optionsStates, function (optionState) {\n                      return optionState.id === optionId;\n                    });\n\n                    if (optionState && _.difference(optionState.selectionRequiredBy, optionState.mirrorIn).length > 0) {\n                      hasConflicts = true;\n                      return \"break\";\n                    }\n                  };\n\n                  for (var _i = 0; _i < deselectIntersection.length; _i++) {\n                    var _ret4 = _loop3(_i);\n\n                    if (_ret4 === \"break\") break;\n                  }\n\n                  if (hasConflicts) {\n                    return \"break\";\n                  }\n\n                  if (relationshipToConfirm.type == \"OO\") {\n                    if (_.intersection(iterationSelectedOptionIds, optionIds).length == 0) {\n                      recallRestrictionRelationshipIds.push(relationshipToConfirm.id);\n                    }\n\n                    confirmRelationshipIds = _.union(confirmRelationshipIds, [relationshipToConfirm.id]);\n                  } else if (relationshipToConfirm.type == \"RA\" || relationshipToConfirm.type == \"IN\") {\n                    var _isMirror = relationshipToConfirm.mirrorRelationshipIds && relationshipToConfirm.mirrorRelationshipIds.length > 0;\n\n                    if (_isMirror) {\n                      _.difference(optionIds, deselectIntersection).forEach(function (optionId) {\n                        var nextIterationOption = _.find(nextIterationOptions, function (option) {\n                          return option.id === optionId;\n                        });\n\n                        if (!nextIterationOption) {\n                          nextIterationOption = {\n                            id: optionId,\n                            selectionRequiredBy: [],\n                            deselectionRequiredBy: [],\n                            mirrorIn: []\n                          };\n                          nextIterationOptions.push(nextIterationOption);\n                        }\n\n                        nextIterationOption.deselectionRequiredBy = _.union(nextIterationOption.deselectionRequiredBy, [0]);\n                      });\n                    }\n\n                    if (_.intersection(primaryOptionIds, iterationSelectedOptionIds).length !== primaryOptionIds.length) {\n                      recallRestrictionRelationshipIds.push(relationshipToConfirm.id);\n                    }\n\n                    if (_.intersection(primaryOptionIds, selectedOptionIds).length === primaryOptionIds.length) {\n                      confirmRelationshipIds = _.union(confirmRelationshipIds, [relationshipToConfirm.id]);\n                    }\n                  }\n                }\n              };\n\n              for (var relationshipIdx = 0; relationshipIdx < relationshipsToConfirm.length; relationshipIdx++) {\n                var _ret2 = _loop(relationshipIdx);\n\n                if (_ret2 === \"continue\") continue;\n                if (_ret2 === \"break\") break;\n              }\n            }\n          }\n\n          return {\n            v: {\n              hasConflicts: hasConflicts,\n              confirmRelationshipIds: hasConflicts ? [] : confirmRelationshipIds,\n              nextIterationOptions: hasConflicts ? [] : nextIterationOptions,\n              recallRestrictionRelationshipIds: hasConflicts ? [] : recallRestrictionRelationshipIds\n            }\n          };\n        }();\n\n        if (typeof _ret === \"object\") return _ret.v;\n      }\n\n      return null;\n    }\n  }]);\n\n  return VehicleExtraOptionsManager;\n}();","import { LeasingDealTypes } from \"enums/LeasingDealTypes\";\nexport var getVehicleMonthlyPrice = function getVehicleMonthlyPrice(leasingDealType, price, term, rentalMonths) {\n  var result = null;\n\n  if (price && price > 0) {\n    price = leasingDealType === LeasingDealTypes.Personal ? price * 1.2 : price;\n    result = price / (term * 12 - 1 + rentalMonths);\n  }\n\n  return result || 0;\n};\nexport var getAnnualTax = function getAnnualTax(p11d, taxRate, co2TaxMultiplier) {\n  if (p11d >= 0 && taxRate >= 0 && co2TaxMultiplier >= 0) {\n    return p11d * (taxRate / 100) * (co2TaxMultiplier / 100);\n  }\n\n  return null;\n};","import _classCallCheck from \"E:/current_project/PPH/tfs/Website/website/node_modules/next/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"E:/current_project/PPH/tfs/Website/website/node_modules/next/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport { VehicleStorageTypes } from \"enums/VehicleStorageTypes\";\nimport { isNullOrWhiteSpace } from \"helpers/stringHelper\";\nimport { isNullOrEmpty } from \"helpers/helpers\";\nexport var VehiclesStorageProvider = /*#__PURE__*/function () {\n  function VehiclesStorageProvider() {\n    _classCallCheck(this, VehiclesStorageProvider);\n  }\n\n  _createClass(VehiclesStorageProvider, null, [{\n    key: \"getTriggerMaxSize\",\n    value: function getTriggerMaxSize(storageType) {\n      switch (storageType) {\n        case VehicleStorageTypes.History:\n          return 4;\n\n        default:\n          return null;\n      }\n    }\n  }, {\n    key: \"getStorageMaxSize\",\n    value: function getStorageMaxSize(storageType) {\n      switch (storageType) {\n        case VehicleStorageTypes.Garage:\n          return 4;\n\n        case VehicleStorageTypes.History:\n          return 20;\n\n        default:\n          return null;\n      }\n    }\n  }, {\n    key: \"getStorageName\",\n    value: function getStorageName(storageType) {\n      switch (storageType) {\n        case VehicleStorageTypes.Garage:\n          return \"garage\";\n\n        case VehicleStorageTypes.History:\n          return \"history\";\n\n        default:\n          return null;\n      }\n    }\n  }, {\n    key: \"getItems\",\n    value: function getItems(storageType) {\n      var items = null;\n      var storageName = this.getStorageName(storageType);\n\n      if (!isNullOrWhiteSpace(storageName)) {\n        items = JSON.parse(localStorage.getItem(storageName));\n      }\n\n      if (!items) {\n        items = [];\n      }\n\n      var requiredSize = this.getStorageMaxSize(storageType);\n\n      if (items.length < requiredSize) {\n        var itemsToAdd = requiredSize - items.length;\n\n        for (var i = 0; i < itemsToAdd; i++) {\n          items.push(null);\n        }\n      }\n\n      return items;\n    }\n  }, {\n    key: \"getItem\",\n    value: function getItem(storageType, itemId) {\n      var items = this.getItems(storageType);\n      var item = items.find(function (item) {\n        return item && item.id === itemId;\n      });\n      return item;\n    }\n  }, {\n    key: \"addItem\",\n    value: function addItem(storageType, item, index) {\n      var result = false;\n      var items = this.getItems(storageType);\n      var storageMaxSize = this.getStorageMaxSize(storageType);\n      var indexHasValue = !isNullOrEmpty(index);\n\n      if (!indexHasValue && items.length < storageMaxSize || indexHasValue && index >= 0 && index < storageMaxSize) {\n        if (indexHasValue) {\n          items[index] = item;\n        } else {\n          items.push(item);\n        }\n\n        result = this.persistItems(storageType, items);\n      }\n\n      return result;\n    }\n  }, {\n    key: \"updateItem\",\n    value: function updateItem(storageType, item) {\n      var result = false;\n      var items = this.getItems(storageType);\n      var existingItem = items.find(function (existingItem) {\n        return existingItem && existingItem.id === item.id && existingItem.index === item.index;\n      });\n\n      if (existingItem) {\n        items[items.indexOf(existingItem)] = item;\n        result = this.persistItems(storageType, items);\n      }\n\n      return result;\n    }\n  }, {\n    key: \"removeItem\",\n    value: function removeItem(storageType, itemId) {\n      var result = false;\n      var items = this.getItems(storageType);\n      var item = items.find(function (item) {\n        return item && item.id === itemId;\n      });\n\n      if (item) {\n        items[items.indexOf(item)] = null;\n        result = this.persistItems(storageType, items);\n      }\n\n      return result;\n    }\n  }, {\n    key: \"clear\",\n    value: function clear(storageType) {\n      var storageName = this.getStorageName(storageType);\n\n      if (!isNullOrWhiteSpace(storageName)) {\n        localStorage.removeItem(storageName);\n        return true;\n      }\n\n      return false;\n    }\n  }, {\n    key: \"persistItems\",\n    value: function persistItems(storageType, vehicleItems) {\n      var storageName = this.getStorageName(storageType);\n\n      if (!isNullOrWhiteSpace(storageName)) {\n        localStorage.setItem(storageName, JSON.stringify(vehicleItems));\n        return true;\n      }\n\n      return false;\n    }\n  }]);\n\n  return VehiclesStorageProvider;\n}();","export var VehicleStorageTypes;\n\n(function (VehicleStorageTypes) {\n  VehicleStorageTypes[VehicleStorageTypes[\"None\"] = 0] = \"None\";\n  VehicleStorageTypes[VehicleStorageTypes[\"Garage\"] = 1] = \"Garage\";\n  VehicleStorageTypes[VehicleStorageTypes[\"History\"] = 2] = \"History\";\n})(VehicleStorageTypes || (VehicleStorageTypes = {}));","import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React from 'react';\nimport { OverlayTrigger, Popover } from 'react-bootstrap';\n\nvar PopOver = function PopOver(_ref) {\n  var id = _ref.id,\n      trigger = _ref.trigger,\n      title = _ref.title,\n      body = _ref.body;\n  return /*#__PURE__*/_jsx(OverlayTrigger, {\n    trigger: \"click\",\n    placement: \"top\",\n    overlay: /*#__PURE__*/_jsxs(Popover, {\n      id: \"popover-positioned-\".concat(id),\n      children: [title ? /*#__PURE__*/_jsx(Popover.Title, {\n        children: title\n      }) : \"\", /*#__PURE__*/_jsx(Popover.Content, {\n        children: body\n      })]\n    }),\n    children: trigger\n  }, id);\n};\n\nexport default PopOver;","import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React, { useState, useEffect } from 'react';\nimport { GetVATText } from 'helpers/helpers';\nimport { formatMoney } from 'helpers/currencyHelper';\nimport { VehicleExtraOptionsHelper } from '../_libs/helpers/VehicleExtraOptionsHelper';\nimport { VehicleExtraOptionsManager } from '../_libs/VehicleExtraOptionsManager';\n\nvar VehicleExtraOptionsRelationshipsManager = function VehicleExtraOptionsRelationshipsManager(_ref) {\n  var options = _ref.options,\n      relationships = _ref.relationships,\n      leasingDealType = _ref.leasingDealType,\n      state = _ref.state,\n      settings = _ref.settings;\n  var vatText = GetVATText(leasingDealType);\n\n  var _useState = useState([]),\n      confirmRelationships = _useState[0],\n      setConfirmRelationships = _useState[1];\n\n  var handleOptionClick = function handleOptionClick(option) {\n    var optionToProcess = VehicleExtraOptionsHelper.getOptionAction(option, state.selectedOptionIds);\n\n    if (optionToProcess) {\n      var optionsToProcess = [optionToProcess];\n      var manager = new VehicleExtraOptionsManager();\n      manager.init(options, relationships);\n      var managerState = manager.processOptions(optionsToProcess, state.confirmRelationshipIds, state.selectedOptionIds, state.optionsStates);\n\n      if (managerState) {\n        if (settings.onStateChanged) {\n          settings.onStateChanged({\n            confirmRelationshipIds: managerState.confirmRelationshipIds,\n            selectedOptionIds: managerState.selectedOptionIds,\n            optionsStates: managerState.optionsStates\n          });\n        }\n      }\n    }\n  };\n\n  useEffect(function () {\n    var confirmList = [];\n\n    if (state.confirmRelationshipIds && state.confirmRelationshipIds.length > 0) {\n      state.confirmRelationshipIds.forEach(function (relationshipId) {\n        var confirmRelationship = VehicleExtraOptionsHelper.getConfirmRelationship(relationships, options, relationshipId, state.selectedOptionIds, state.optionsStates);\n\n        if (confirmRelationship) {\n          confirmList.push(confirmRelationship);\n        }\n      });\n    }\n\n    setConfirmRelationships(confirmList);\n  }, [state]);\n\n  if (confirmRelationships.length > 0) {\n    var totalPrice = VehicleExtraOptionsHelper.getOptionsPrice(VehicleExtraOptionsHelper.getSelectedOptions(options, state.selectedOptionIds), state.optionsStates);\n    return /*#__PURE__*/_jsxs(_Fragment, {\n      children: [/*#__PURE__*/_jsx(\"div\", {\n        className: \"options-box\",\n        children: confirmRelationships.map(function (relationship) {\n          return /*#__PURE__*/_jsxs(\"div\", {\n            className: \"rule-item\",\n            children: [/*#__PURE__*/_jsx(\"p\", {\n              className: \"my-3\",\n              children: /*#__PURE__*/_jsx(\"strong\", {\n                className: \"text-center\",\n                children: VehicleExtraOptionsHelper.getRelationshipDescription(relationship.type)\n              })\n            }), /*#__PURE__*/_jsx(\"div\", {\n              children: relationship.options.map(function (option) {\n                return /*#__PURE__*/_jsxs(\"div\", {\n                  className: \"row\",\n                  children: [/*#__PURE__*/_jsxs(\"div\", {\n                    className: \"col-16 col-md-20 d-flex flex-row flex-wrap align-items-center my-2\",\n                    children: [option.isPrimary ? /*#__PURE__*/_jsx(\"img\", {\n                      className: \"lazyload mr-2\",\n                      height: \"13\",\n                      alt: \"Primary icon\",\n                      \"data-src\": \"\".concat(process.env.NEXT_PUBLIC_CDN, \"/website/icon-primary.png\")\n                    }) : \"\", \" \", option.name]\n                  }), /*#__PURE__*/_jsxs(\"div\", {\n                    className: \"col-8 col-md-4 d-flex justify-content-end align-items-center\",\n                    children: [formatMoney(option.price), \" \", /*#__PURE__*/_jsx(\"span\", {\n                      className: \"vehicle-option__indicator \".concat(option.isSelected ? \"is-active\" : \"\", \" \").concat(option.isDisabled ? \"is-disabled\" : \"\"),\n                      onClick: function onClick() {\n                        return handleOptionClick(option);\n                      }\n                    })]\n                  })]\n                }, \"option-\".concat(option.id));\n              })\n            })]\n          }, \"rule-\".concat(relationship.id));\n        })\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: \"options-pricing\",\n        children: /*#__PURE__*/_jsxs(\"div\", {\n          className: \"row\",\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: \"col-16 col-md-19 d-flex flex-row flex-wrap my-2\",\n            children: \"Total Extras Cost Per Month\"\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: \"col-8 col-md-5 d-flex justify-content-end align-items-center\",\n            children: [formatMoney(totalPrice), \" \", vatText]\n          })]\n        })\n      })]\n    });\n  }\n\n  return null;\n};\n\nexport default VehicleExtraOptionsRelationshipsManager;","import _defineProperty from \"E:/current_project/PPH/tfs/Website/website/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _objectWithoutProperties from \"E:/current_project/PPH/tfs/Website/website/node_modules/next/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState } from 'react';\nimport Modal from 'react-bootstrap/Modal';\nimport VehicleExtraOptionsRelationshipsManager from '../vehicle-extra-options-relationships-manager';\n\nvar VehicleExtarOptionsConfirmModal = function VehicleExtarOptionsConfirmModal(_ref) {\n  var title = _ref.title,\n      data = _ref.data,\n      options = _ref.options,\n      initialState = _ref.initialState,\n      settings = _ref.settings,\n      onRequestClose = _ref.onRequestClose,\n      otherProps = _objectWithoutProperties(_ref, [\"title\", \"data\", \"options\", \"initialState\", \"settings\", \"onRequestClose\"]);\n\n  var _useState = useState(initialState),\n      currentState = _useState[0],\n      setCurrentState = _useState[1];\n\n  var hadleCancelClick = function hadleCancelClick() {\n    if (settings.onCancel) {\n      settings.onCancel();\n    }\n\n    onRequestClose();\n  };\n\n  var handleApplyClick = function handleApplyClick() {\n    if (settings.onApply) {\n      settings.onApply(currentState);\n    }\n\n    onRequestClose();\n  };\n\n  var onManagerStateChanged = function onManagerStateChanged(managerState) {\n    setCurrentState(managerState);\n  };\n\n  return /*#__PURE__*/_jsxs(Modal, _objectSpread(_objectSpread({\n    onHide: hadleCancelClick,\n    centered: true,\n    scrollable: true\n  }, otherProps), {}, {\n    children: [/*#__PURE__*/_jsx(Modal.Header, {\n      className: \"options-title d-flex flex-nowrap justify-content-center align-items-center\",\n      closeButton: true,\n      children: /*#__PURE__*/_jsx(Modal.Title, {\n        className: \"mb-0\",\n        children: title\n      })\n    }), /*#__PURE__*/_jsx(Modal.Body, {\n      children: /*#__PURE__*/_jsx(VehicleExtraOptionsRelationshipsManager, {\n        options: data.extraOptions,\n        relationships: data.extraOptionsRelationships,\n        leasingDealType: options.leasingDealType,\n        state: currentState,\n        settings: {\n          onStateChanged: onManagerStateChanged\n        }\n      })\n    }), /*#__PURE__*/_jsxs(Modal.Footer, {\n      children: [/*#__PURE__*/_jsx(\"button\", {\n        className: \"btn btn-danger btn-lg d-flex justify-content-center align-items-center flex-grow-1\",\n        onClick: hadleCancelClick,\n        children: \"Cancel\"\n      }), /*#__PURE__*/_jsx(\"button\", {\n        className: \"btn btn-primary btn-lg d-flex justify-content-center align-items-center flex-grow-1\",\n        onClick: handleApplyClick,\n        children: \"Apply\"\n      })]\n    })]\n  }));\n};\n\nexport default VehicleExtarOptionsConfirmModal;","import _classCallCheck from \"E:/current_project/PPH/tfs/Website/website/node_modules/next/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"E:/current_project/PPH/tfs/Website/website/node_modules/next/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport { isNullOrWhiteSpace } from './stringHelper';\nimport { getQueryParams } from './urlsHelper';\nimport { SiteSettings } from 'environment/siteSettings';\nimport { GetVehicleCheapestPriceTerm } from 'business-logic/vehicleService';\nexport var CustomOptionsHelper = /*#__PURE__*/function () {\n  function CustomOptionsHelper() {\n    _classCallCheck(this, CustomOptionsHelper);\n  }\n\n  _createClass(CustomOptionsHelper, null, [{\n    key: \"getVehicleCustomOptions\",\n    value: function getVehicleCustomOptions(data, callback) {\n      var values = {};\n      var isDefault = false;\n      var parts = data.url.split('?');\n      var queryStringParams = parts[1] ? getQueryParams(parts[1].split('&')) : null;\n\n      if (queryStringParams) {\n        var parsedInt = NaN;\n        parsedInt = parseInt(queryStringParams[\"term\"]);\n\n        if (!isNaN(parsedInt)) {\n          values[\"term\"] = parsedInt;\n        }\n\n        parsedInt = parseInt(queryStringParams[\"initialrentals\"]);\n\n        if (!isNaN(parsedInt)) {\n          values[\"initialRentalMonths\"] = parsedInt;\n        }\n\n        parsedInt = parseInt(queryStringParams[\"mileage\"]);\n\n        if (!isNaN(parsedInt)) {\n          values[\"mileage\"] = parsedInt;\n        }\n\n        isDefault = !isNullOrWhiteSpace(queryStringParams[\"isdefault\"]) && queryStringParams[\"isdefault\"] === \"1\";\n      }\n\n      if (data.pricingType && data.pricingType === 2) {\n        //isAtcPricing\n        values[\"maintenance\"] = true;\n      } else if (!data.maintenanceAllowed) {\n        values[\"maintenance\"] = false;\n      }\n\n      var customOptions = CustomOptionsStorageHelper.getOrAddVehicleCustomOptions(data.vehicleRef, data.leasingDealType, isDefault, values);\n\n      if (customOptions.useCheapestTerm) {\n        var pricingData = {\n          pricingType: data.pricingType || undefined,\n          postcode: data.postcode || undefined\n        };\n        GetVehicleCheapestPriceTerm(customOptions.vehicleRef, customOptions.leasingDealType, customOptions.maintenance, customOptions.mileage, customOptions.initialRentalMonths, pricingData).then(function (result) {\n          var cheapestTerm = null;\n\n          if (result.isSucceed && result.data) {\n            cheapestTerm = result.data;\n          }\n\n          customOptions.useCheapestTerm = false;\n\n          if (cheapestTerm && cheapestTerm > 0) {\n            customOptions.term = cheapestTerm;\n          }\n\n          CustomOptionsStorageHelper.addOrUpdateVehicleCustomOptions(customOptions);\n          callback(customOptions);\n        });\n      } else {\n        callback(customOptions);\n      }\n    }\n  }, {\n    key: \"storeVehicleCustomOptions\",\n    value: function storeVehicleCustomOptions(customOptions) {\n      if (customOptions) {\n        customOptions.useCheapestTerm = false;\n        CustomOptionsStorageHelper.addOrUpdateVehicleCustomOptions(customOptions);\n      }\n    }\n  }]);\n\n  return CustomOptionsHelper;\n}();\nexport var CustomOptionsStorageHelper = /*#__PURE__*/function () {\n  function CustomOptionsStorageHelper() {\n    _classCallCheck(this, CustomOptionsStorageHelper);\n  }\n\n  _createClass(CustomOptionsStorageHelper, null, [{\n    key: \"getOrAddVehicleCustomOptions\",\n    value: function getOrAddVehicleCustomOptions(vehicleRef, leasingDealType, setToDefault, values) {\n      var customOptions = this.getVehicleCustomOptions(vehicleRef, leasingDealType);\n\n      if (!customOptions || setToDefault) {\n        customOptions = {\n          vehicleRef: vehicleRef,\n          leasingDealType: leasingDealType,\n          term: SiteSettings.DefaultTerm,\n          mileage: SiteSettings.GetDealTypeDefaultMileage(leasingDealType),\n          maintenance: SiteSettings.DefaultMaintenance,\n          initialRentalMonths: SiteSettings.DefaultInitialRentals,\n          options: [],\n          salesCode: 0,\n          ageCategory: null,\n          useCheapestTerm: true\n        };\n      }\n\n      Object.assign(customOptions, values || {});\n      this.addOrUpdateVehicleCustomOptions(customOptions);\n      return customOptions;\n    }\n  }, {\n    key: \"addOrUpdateVehicleCustomOptions\",\n    value: function addOrUpdateVehicleCustomOptions(customOptions) {\n      if (customOptions !== null) {\n        var key = this.getOptionsItemKey(customOptions.vehicleRef, customOptions.leasingDealType);\n        localStorage.setItem(key, JSON.stringify(customOptions));\n      }\n    }\n  }, {\n    key: \"getVehicleCustomOptions\",\n    value: function getVehicleCustomOptions(vehicleRef, leasingDealType) {\n      var customOptions = null;\n\n      if (vehicleRef && leasingDealType) {\n        var key = this.getOptionsItemKey(vehicleRef, leasingDealType);\n        var serializedItem = localStorage.getItem(key);\n        customOptions = JSON.parse(serializedItem);\n      }\n\n      return customOptions;\n    }\n  }, {\n    key: \"getOptionsItemKey\",\n    value: function getOptionsItemKey(vehicleRef, leasingDealType) {\n      return (\"options_\" + vehicleRef + \"_\" + leasingDealType).toLowerCase();\n    }\n  }]);\n\n  return CustomOptionsStorageHelper;\n}();","import _classCallCheck from \"E:/current_project/PPH/tfs/Website/website/node_modules/next/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"E:/current_project/PPH/tfs/Website/website/node_modules/next/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _defineProperty from \"E:/current_project/PPH/tfs/Website/website/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _ from 'underscore';\nimport { VehicleStorageTypes } from \"enums/VehicleStorageTypes\";\nimport { VehiclesStorageProvider } from \"helpers/vehiclesStorageProvider\";\nimport { isNullOrEmpty, getGUID } from \"helpers/helpers\";\nexport var GarageStorageHelper = /*#__PURE__*/function () {\n  function GarageStorageHelper() {\n    _classCallCheck(this, GarageStorageHelper);\n  }\n\n  _createClass(GarageStorageHelper, null, [{\n    key: \"addItem\",\n    value: function addItem(index, item) {\n      if (item && index >= 0 && index < this.storageMaxSize) {\n        var storageItem = {\n          id: getGUID(),\n          index: index,\n          vehicle: item\n        };\n\n        if (VehiclesStorageProvider.addItem(this.storageType, storageItem, index)) {\n          return storageItem;\n        }\n      }\n\n      return null;\n    }\n  }, {\n    key: \"updateItem\",\n    value: function updateItem(itemId, item, alwaysUpdate) {\n      if (item) {\n        var storageItem = VehiclesStorageProvider.getItem(this.storageType, itemId);\n\n        if (storageItem && (alwaysUpdate || !_.isEqual(storageItem.vehicle, item))) {\n          storageItem.vehicle = item;\n\n          if (VehiclesStorageProvider.updateItem(this.storageType, storageItem)) {\n            return storageItem;\n          }\n        }\n      }\n\n      return null;\n    }\n  }, {\n    key: \"addOrUpdateItem\",\n    value: function addOrUpdateItem(item) {\n      if (item) {\n        var storageItems = this.getItems(false);\n        var storageItem = storageItems.find(function (storageItem) {\n          return storageItem && storageItem.vehicle && storageItem.vehicle.vehicleRef === item.vehicleRef;\n        });\n\n        if (storageItem) {\n          return this.updateItem(storageItem.id, item, true);\n        } else {\n          var index = storageItems.indexOf(null);\n\n          if (!isNullOrEmpty(index) && index >= 0 && index < this.storageMaxSize) {\n            return this.addItem(index, item);\n          }\n        }\n      }\n\n      return null;\n    }\n  }, {\n    key: \"cloneItem\",\n    value: function cloneItem(itemId) {\n      var storageItems = this.getItems(false);\n      var itemToClone = storageItems.find(function (item) {\n        return item && item.id === itemId;\n      });\n\n      if (itemToClone) {\n        var index = storageItems.indexOf(null);\n\n        if (!isNullOrEmpty(index) && index >= 0 && index < this.storageMaxSize) {\n          var clonnedItem = {\n            id: getGUID(),\n            index: index,\n            vehicle: itemToClone.vehicle //copy not made as data comes from json\n\n          };\n\n          if (VehiclesStorageProvider.addItem(this.storageType, clonnedItem, index)) {\n            return clonnedItem;\n          }\n        }\n      }\n\n      return null;\n    }\n  }, {\n    key: \"removeItem\",\n    value: function removeItem(itemId) {\n      return VehiclesStorageProvider.removeItem(this.storageType, itemId);\n    }\n  }, {\n    key: \"getItems\",\n    value: function getItems(ignoreEmptyItems) {\n      var result = VehiclesStorageProvider.getItems(this.storageType);\n\n      if (result && result.length > 0 && ignoreEmptyItems) {\n        result = result.filter(function (item) {\n          return item;\n        });\n      }\n\n      return result;\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      VehiclesStorageProvider.clear(this.storageType);\n    }\n  }, {\n    key: \"countItems\",\n    value: function countItems() {\n      return this.getItems(true).length;\n    }\n  }, {\n    key: \"isFull\",\n    value: function isFull() {\n      return !(this.countItems() < this.storageMaxSize);\n    }\n  }]);\n\n  return GarageStorageHelper;\n}();\n\n_defineProperty(GarageStorageHelper, \"storageType\", VehicleStorageTypes.Garage);\n\n_defineProperty(GarageStorageHelper, \"storageMaxSize\", VehiclesStorageProvider.getStorageMaxSize(VehicleStorageTypes.Garage) || 0);"]}}